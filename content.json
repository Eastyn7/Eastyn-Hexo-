{"meta":{"title":"Eastynçš„åšå®¢","subtitle":"","description":"","author":"Eastyn","url":"http://eastyn7.github.io","root":"/"},"pages":[{"title":"å…³äº","date":"2024-09-28T17:32:05.000Z","updated":"2024-09-28T17:34:04.765Z","comments":false,"path":"about/index.html","permalink":"http://eastyn7.github.io/about/index.html","excerpt":"","text":""}],"posts":[{"title":"é»‘é©¬å¤§äº‹ä»¶åç«¯","slug":"ev_api_server","date":"2024-10-08T15:39:53.500Z","updated":"2024-10-14T10:40:01.848Z","comments":true,"path":"2024/10/08/ev_api_server/","permalink":"http://eastyn7.github.io/2024/10/08/ev_api_server/","excerpt":"","text":"Headline å¤§äº‹ä»¶åå° API é¡¹ç›®ï¼ŒAPI æ¥å£æ–‡æ¡£è¯·å‚è€ƒ https://www.showdoc.cc/escook?page_id&#x3D;3707158761215217 1. åˆå§‹åŒ–1.1 åˆ›å»ºé¡¹ç›® æ–°å»º api_server æ–‡ä»¶å¤¹ä½œä¸ºé¡¹ç›®æ ¹ç›®å½•ï¼Œå¹¶åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸­è¿è¡Œå¦‚ä¸‹çš„å‘½ä»¤ï¼Œåˆå§‹åŒ–åŒ…ç®¡ç†é…ç½®æ–‡ä»¶ï¼š 1npm init -y è¿è¡Œå¦‚ä¸‹çš„å‘½ä»¤ï¼Œå®‰è£…ç‰¹å®šç‰ˆæœ¬çš„ expressï¼š 1npm i express@4.17.1 åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸­æ–°å»º app.js ä½œä¸ºæ•´ä¸ªé¡¹ç›®çš„å…¥å£æ–‡ä»¶ï¼Œå¹¶åˆå§‹åŒ–å¦‚ä¸‹çš„ä»£ç ï¼š 1234567891011// å¯¼å…¥ express æ¨¡å—const express = require(&#x27;express&#x27;)// åˆ›å»º express çš„æœåŠ¡å™¨å®ä¾‹const app = express()// write your code here...// è°ƒç”¨ app.listen æ–¹æ³•ï¼ŒæŒ‡å®šç«¯å£å·å¹¶å¯åŠ¨webæœåŠ¡å™¨app.listen(3007, function () &#123; console.log(&#x27;api server running at http://127.0.0.1:3007&#x27;)&#125;) 1.2 é…ç½® cors è·¨åŸŸ è¿è¡Œå¦‚ä¸‹çš„å‘½ä»¤ï¼Œå®‰è£… cors ä¸­é—´ä»¶ï¼š 1npm i cors@2.8.5 åœ¨ app.js ä¸­å¯¼å…¥å¹¶é…ç½® cors ä¸­é—´ä»¶ï¼š 1234// å¯¼å…¥ cors ä¸­é—´ä»¶const cors = require(&#x27;cors&#x27;)// å°† cors æ³¨å†Œä¸ºå…¨å±€ä¸­é—´ä»¶app.use(cors()) 1.3 é…ç½®è§£æè¡¨å•æ•°æ®çš„ä¸­é—´ä»¶ é€šè¿‡å¦‚ä¸‹çš„ä»£ç ï¼Œé…ç½®è§£æ application/x-www-form-urlencoded æ ¼å¼çš„è¡¨å•æ•°æ®çš„ä¸­é—´ä»¶ï¼š 1app.use(express.urlencoded(&#123; extended: false &#125;)) 1.4 åˆå§‹åŒ–è·¯ç”±ç›¸å…³çš„æ–‡ä»¶å¤¹ åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸­ï¼Œæ–°å»º router æ–‡ä»¶å¤¹ï¼Œç”¨æ¥å­˜æ”¾æ‰€æœ‰çš„è·¯ç”±æ¨¡å— è·¯ç”±æ¨¡å—ä¸­ï¼Œåªå­˜æ”¾å®¢æˆ·ç«¯çš„è¯·æ±‚ä¸å¤„ç†å‡½æ•°ä¹‹é—´çš„æ˜ å°„å…³ç³» åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸­ï¼Œæ–°å»º router_handler æ–‡ä»¶å¤¹ï¼Œç”¨æ¥å­˜æ”¾æ‰€æœ‰çš„ è·¯ç”±å¤„ç†å‡½æ•°æ¨¡å— è·¯ç”±å¤„ç†å‡½æ•°æ¨¡å—ä¸­ï¼Œä¸“é—¨è´Ÿè´£å­˜æ”¾æ¯ä¸ªè·¯ç”±å¯¹åº”çš„å¤„ç†å‡½æ•° 1.5 åˆå§‹åŒ–ç”¨æˆ·è·¯ç”±æ¨¡å— åœ¨ router æ–‡ä»¶å¤¹ä¸­ï¼Œæ–°å»º user.js æ–‡ä»¶ï¼Œä½œä¸ºç”¨æˆ·çš„è·¯ç”±æ¨¡å—ï¼Œå¹¶åˆå§‹åŒ–ä»£ç å¦‚ä¸‹ï¼š 12345678910111213141516const express = require(&#x27;express&#x27;)// åˆ›å»ºè·¯ç”±å¯¹è±¡const router = express.Router()// æ³¨å†Œæ–°ç”¨æˆ·router.post(&#x27;/reguser&#x27;, (req, res) =&gt; &#123; res.send(&#x27;reguser OK&#x27;)&#125;)// ç™»å½•router.post(&#x27;/login&#x27;, (req, res) =&gt; &#123; res.send(&#x27;login OK&#x27;)&#125;)// å°†è·¯ç”±å¯¹è±¡å…±äº«å‡ºå»module.exports = router åœ¨ app.js ä¸­ï¼Œå¯¼å…¥å¹¶ä½¿ç”¨ ç”¨æˆ·è·¯ç”±æ¨¡å— ï¼š 123// å¯¼å…¥å¹¶æ³¨å†Œç”¨æˆ·è·¯ç”±æ¨¡å—const userRouter = require(&#x27;./router/user&#x27;)app.use(&#x27;/api&#x27;, userRouter) 1.6 æŠ½ç¦»ç”¨æˆ·è·¯ç”±æ¨¡å—ä¸­çš„å¤„ç†å‡½æ•° ç›®çš„ï¼šä¸ºäº†ä¿è¯ è·¯ç”±æ¨¡å— çš„çº¯ç²¹æ€§ï¼Œæ‰€æœ‰çš„ è·¯ç”±å¤„ç†å‡½æ•°ï¼Œå¿…é¡»æŠ½ç¦»åˆ°å¯¹åº”çš„ è·¯ç”±å¤„ç†å‡½æ•°æ¨¡å— ä¸­ åœ¨ /router_handler/user.js ä¸­ï¼Œä½¿ç”¨ exports å¯¹è±¡ï¼Œåˆ†åˆ«å‘å¤–å…±äº«å¦‚ä¸‹ä¸¤ä¸ª è·¯ç”±å¤„ç†å‡½æ•° ï¼š 12345678910111213/** * åœ¨è¿™é‡Œå®šä¹‰å’Œç”¨æˆ·ç›¸å…³çš„è·¯ç”±å¤„ç†å‡½æ•°ï¼Œä¾› /router/user.js æ¨¡å—è¿›è¡Œè°ƒç”¨ */// æ³¨å†Œç”¨æˆ·çš„å¤„ç†å‡½æ•°exports.regUser = (req, res) =&gt; &#123; res.send(&#x27;reguser OK&#x27;)&#125;// ç™»å½•çš„å¤„ç†å‡½æ•°exports.login = (req, res) =&gt; &#123; res.send(&#x27;login OK&#x27;)&#125; å°† /router/user.js ä¸­çš„ä»£ç ä¿®æ”¹ä¸ºå¦‚ä¸‹ç»“æ„ï¼š 123456789101112const express = require(&#x27;express&#x27;)const router = express.Router()// å¯¼å…¥ç”¨æˆ·è·¯ç”±å¤„ç†å‡½æ•°æ¨¡å—const userHandler = require(&#x27;../router_handler/user&#x27;)// æ³¨å†Œæ–°ç”¨æˆ·router.post(&#x27;/reguser&#x27;, userHandler.regUser)// ç™»å½•router.post(&#x27;/login&#x27;, userHandler.login)module.exports = router 2. ç™»å½•æ³¨å†Œ2.1 æ–°å»º ev_users è¡¨ åœ¨ my_db_01 æ•°æ®åº“ä¸­ï¼Œæ–°å»º ev_users è¡¨å¦‚ä¸‹ï¼š 2.2 å®‰è£…å¹¶é…ç½® mysql æ¨¡å— åœ¨ API æ¥å£é¡¹ç›®ä¸­ï¼Œéœ€è¦å®‰è£…å¹¶é…ç½® mysql è¿™ä¸ªç¬¬ä¸‰æ–¹æ¨¡å—ï¼Œæ¥è¿æ¥å’Œæ“ä½œ MySQL æ•°æ®åº“ è¿è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œå®‰è£… mysql æ¨¡å—ï¼š 1npm i mysql@2.18.1 åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸­æ–°å»º /db/index.js æ–‡ä»¶ï¼Œåœ¨æ­¤è‡ªå®šä¹‰æ¨¡å—ä¸­åˆ›å»ºæ•°æ®åº“çš„è¿æ¥å¯¹è±¡ï¼š 12345678910111213// å¯¼å…¥ mysql æ¨¡å—const mysql = require(&#x27;mysql&#x27;)// åˆ›å»ºæ•°æ®åº“è¿æ¥å¯¹è±¡const db = mysql.createPool(&#123; host: &#x27;127.0.0.1&#x27;, user: &#x27;root&#x27;, password: &#x27;admin123&#x27;, database: &#x27;my_db_01&#x27;,&#125;)// å‘å¤–å…±äº« db æ•°æ®åº“è¿æ¥å¯¹è±¡module.exports = db 2.3 æ³¨å†Œ2.3.0 å®ç°æ­¥éª¤ æ£€æµ‹è¡¨å•æ•°æ®æ˜¯å¦åˆæ³• æ£€æµ‹ç”¨æˆ·åæ˜¯å¦è¢«å ç”¨ å¯¹å¯†ç è¿›è¡ŒåŠ å¯†å¤„ç† æ’å…¥æ–°ç”¨æˆ· 2.3.1 æ£€æµ‹è¡¨å•æ•°æ®æ˜¯å¦åˆæ³• åˆ¤æ–­ç”¨æˆ·åå’Œå¯†ç æ˜¯å¦ä¸ºç©º 123456// æ¥æ”¶è¡¨å•æ•°æ®const userinfo = req.body// åˆ¤æ–­æ•°æ®æ˜¯å¦åˆæ³•if (!userinfo.username || !userinfo.password) &#123; return res.send(&#123; status: 1, message: &#x27;ç”¨æˆ·åæˆ–å¯†ç ä¸èƒ½ä¸ºç©ºï¼&#x27; &#125;)&#125; 2.3.2 æ£€æµ‹ç”¨æˆ·åæ˜¯å¦è¢«å ç”¨ å¯¼å…¥æ•°æ®åº“æ“ä½œæ¨¡å—ï¼š 1const db = require(&#x27;../db/index&#x27;) å®šä¹‰ SQL è¯­å¥ï¼š 1const sql = `select * from ev_users where username=?` æ‰§è¡Œ SQL è¯­å¥å¹¶æ ¹æ®ç»“æœåˆ¤æ–­ç”¨æˆ·åæ˜¯å¦è¢«å ç”¨ï¼š 1234567891011db.query(sql, [userinfo.username], function (err, results) &#123; // æ‰§è¡Œ SQL è¯­å¥å¤±è´¥ if (err) &#123; return res.send(&#123; status: 1, message: err.message &#125;) &#125; // ç”¨æˆ·åè¢«å ç”¨ if (results.length &gt; 0) &#123; return res.send(&#123; status: 1, message: &#x27;ç”¨æˆ·åè¢«å ç”¨ï¼Œè¯·æ›´æ¢å…¶ä»–ç”¨æˆ·åï¼&#x27; &#125;) &#125; // TODO: ç”¨æˆ·åå¯ç”¨ï¼Œç»§ç»­åç»­æµç¨‹...&#125;) 2.3.3 å¯¹å¯†ç è¿›è¡ŒåŠ å¯†å¤„ç† ä¸ºäº†ä¿è¯å¯†ç çš„å®‰å…¨æ€§ï¼Œä¸å»ºè®®åœ¨æ•°æ®åº“ä»¥ æ˜æ–‡ çš„å½¢å¼ä¿å­˜ç”¨æˆ·å¯†ç ï¼Œæ¨èå¯¹å¯†ç è¿›è¡Œ åŠ å¯†å­˜å‚¨ åœ¨å½“å‰é¡¹ç›®ä¸­ï¼Œä½¿ç”¨ bcryptjs å¯¹ç”¨æˆ·å¯†ç è¿›è¡ŒåŠ å¯†ï¼Œä¼˜ç‚¹ï¼š åŠ å¯†ä¹‹åçš„å¯†ç ï¼Œæ— æ³•è¢«é€†å‘ç ´è§£ åŒä¸€æ˜æ–‡å¯†ç å¤šæ¬¡åŠ å¯†ï¼Œå¾—åˆ°çš„åŠ å¯†ç»“æœå„ä¸ç›¸åŒï¼Œä¿è¯äº†å®‰å…¨æ€§ è¿è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œå®‰è£…æŒ‡å®šç‰ˆæœ¬çš„ bcryptjs ï¼š 1npm i bcryptjs@2.4.3 åœ¨ /router_handler/user.js ä¸­ï¼Œå¯¼å…¥ bcryptjs ï¼š 1const bcrypt = require(&#x27;bcryptjs&#x27;) åœ¨æ³¨å†Œç”¨æˆ·çš„å¤„ç†å‡½æ•°ä¸­ï¼Œç¡®è®¤ç”¨æˆ·åå¯ç”¨ä¹‹åï¼Œè°ƒç”¨ bcrypt.hashSync(æ˜æ–‡å¯†ç , éšæœºç›çš„é•¿åº¦) æ–¹æ³•ï¼Œå¯¹ç”¨æˆ·çš„å¯†ç è¿›è¡ŒåŠ å¯†å¤„ç†ï¼š 12// å¯¹ç”¨æˆ·çš„å¯†ç ,è¿›è¡Œ bcrype åŠ å¯†ï¼Œè¿”å›å€¼æ˜¯åŠ å¯†ä¹‹åçš„å¯†ç å­—ç¬¦ä¸²userinfo.password = bcrypt.hashSync(userinfo.password, 10) 2.3.4 æ’å…¥æ–°ç”¨æˆ· å®šä¹‰æ’å…¥ç”¨æˆ·çš„ SQL è¯­å¥ï¼š 1const sql = &#x27;insert into ev_users set ?&#x27; è°ƒç”¨ db.query() æ‰§è¡Œ SQL è¯­å¥ï¼Œæ’å…¥æ–°ç”¨æˆ·ï¼š 12345678910db.query(sql, &#123; username: userinfo.username, password: userinfo.password &#125;, function (err, results) &#123; // æ‰§è¡Œ SQL è¯­å¥å¤±è´¥ if (err) return res.send(&#123; status: 1, message: err.message &#125;) // SQL è¯­å¥æ‰§è¡ŒæˆåŠŸï¼Œä½†å½±å“è¡Œæ•°ä¸ä¸º 1 if (results.affectedRows !== 1) &#123; return res.send(&#123; status: 1, message: &#x27;æ³¨å†Œç”¨æˆ·å¤±è´¥ï¼Œè¯·ç¨åå†è¯•ï¼&#x27; &#125;) &#125; // æ³¨å†ŒæˆåŠŸ res.send(&#123; status: 0, message: &#x27;æ³¨å†ŒæˆåŠŸï¼&#x27; &#125;)&#125;) 2.4 ä¼˜åŒ– res.send() ä»£ç  åœ¨å¤„ç†å‡½æ•°ä¸­ï¼Œéœ€è¦å¤šæ¬¡è°ƒç”¨ res.send() å‘å®¢æˆ·ç«¯å“åº” å¤„ç†å¤±è´¥ çš„ç»“æœï¼Œä¸ºäº†ç®€åŒ–ä»£ç ï¼Œå¯ä»¥æ‰‹åŠ¨å°è£…ä¸€ä¸ª res.cc() å‡½æ•° åœ¨ app.js ä¸­ï¼Œæ‰€æœ‰è·¯ç”±ä¹‹å‰ï¼Œå£°æ˜ä¸€ä¸ªå…¨å±€ä¸­é—´ä»¶ï¼Œä¸º res å¯¹è±¡æŒ‚è½½ä¸€ä¸ª res.cc() å‡½æ•° ï¼š 12345678910111213// å“åº”æ•°æ®çš„ä¸­é—´ä»¶app.use(function (req, res, next) &#123; // status = 0 ä¸ºæˆåŠŸï¼› status = 1 ä¸ºå¤±è´¥ï¼› é»˜è®¤å°† status çš„å€¼è®¾ç½®ä¸º 1ï¼Œæ–¹ä¾¿å¤„ç†å¤±è´¥çš„æƒ…å†µ res.cc = function (err, status = 1) &#123; res.send(&#123; // çŠ¶æ€ status, // çŠ¶æ€æè¿°ï¼Œåˆ¤æ–­ err æ˜¯ é”™è¯¯å¯¹è±¡ è¿˜æ˜¯ å­—ç¬¦ä¸² message: err instanceof Error ? err.message : err, &#125;) &#125; next()&#125;) 2.5 ä¼˜åŒ–è¡¨å•æ•°æ®éªŒè¯ è¡¨å•éªŒè¯çš„åŸåˆ™ï¼šå‰ç«¯éªŒè¯ä¸ºè¾…ï¼Œåç«¯éªŒè¯ä¸ºä¸»ï¼Œåç«¯æ°¸è¿œä¸è¦ç›¸ä¿¡å‰ç«¯æäº¤è¿‡æ¥çš„ä»»ä½•å†…å®¹ åœ¨å®é™…å¼€å‘ä¸­ï¼Œå‰åç«¯éƒ½éœ€è¦å¯¹è¡¨å•çš„æ•°æ®è¿›è¡Œåˆæ³•æ€§çš„éªŒè¯ï¼Œè€Œä¸”ï¼Œåç«¯åšä¸ºæ•°æ®åˆæ³•æ€§éªŒè¯çš„æœ€åä¸€ä¸ªå…³å£ï¼Œåœ¨æ‹¦æˆªéæ³•æ•°æ®æ–¹é¢ï¼Œèµ·åˆ°äº†è‡³å…³é‡è¦çš„ä½œç”¨ã€‚ å•çº¯çš„ä½¿ç”¨ if...else... çš„å½¢å¼å¯¹æ•°æ®åˆæ³•æ€§è¿›è¡ŒéªŒè¯ï¼Œæ•ˆç‡ä½ä¸‹ã€å‡ºé”™ç‡é«˜ã€ç»´æŠ¤æ€§å·®ã€‚å› æ­¤ï¼Œæ¨èä½¿ç”¨ç¬¬ä¸‰æ–¹æ•°æ®éªŒè¯æ¨¡å—ï¼Œæ¥é™ä½å‡ºé”™ç‡ã€æé«˜éªŒè¯çš„æ•ˆç‡ä¸å¯ç»´æŠ¤æ€§ï¼Œè®©åç«¯ç¨‹åºå‘˜æŠŠæ›´å¤šçš„ç²¾åŠ›æ”¾åœ¨æ ¸å¿ƒä¸šåŠ¡é€»è¾‘çš„å¤„ç†ä¸Šã€‚ å®‰è£… @hapi/joi åŒ…ï¼Œä¸ºè¡¨å•ä¸­æºå¸¦çš„æ¯ä¸ªæ•°æ®é¡¹ï¼Œå®šä¹‰éªŒè¯è§„åˆ™ï¼š 1npm install @hapi/joi@17.1.0 å®‰è£… @escook/express-joi ä¸­é—´ä»¶ï¼Œæ¥å®ç°è‡ªåŠ¨å¯¹è¡¨å•æ•°æ®è¿›è¡ŒéªŒè¯çš„åŠŸèƒ½ï¼š 1npm i @escook/express-joi æ–°å»º /schema/user.js ç”¨æˆ·ä¿¡æ¯éªŒè¯è§„åˆ™æ¨¡å—ï¼Œå¹¶åˆå§‹åŒ–ä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627const joi = require(&#x27;@hapi/joi&#x27;)/** * string() å€¼å¿…é¡»æ˜¯å­—ç¬¦ä¸² * alphanum() å€¼åªèƒ½æ˜¯åŒ…å« a-zA-Z0-9 çš„å­—ç¬¦ä¸² * min(length) æœ€å°é•¿åº¦ * max(length) æœ€å¤§é•¿åº¦ * required() å€¼æ˜¯å¿…å¡«é¡¹ï¼Œä¸èƒ½ä¸º undefined * pattern(æ­£åˆ™è¡¨è¾¾å¼) å€¼å¿…é¡»ç¬¦åˆæ­£åˆ™è¡¨è¾¾å¼çš„è§„åˆ™ */// ç”¨æˆ·åçš„éªŒè¯è§„åˆ™const username = joi.string().alphanum().min(1).max(10).required()// å¯†ç çš„éªŒè¯è§„åˆ™const password = joi .string() .pattern(/^[\\S]&#123;6,12&#125;$/) .required()// æ³¨å†Œå’Œç™»å½•è¡¨å•çš„éªŒè¯è§„åˆ™å¯¹è±¡exports.reg_login_schema = &#123; // è¡¨ç¤ºéœ€è¦å¯¹ req.body ä¸­çš„æ•°æ®è¿›è¡ŒéªŒè¯ body: &#123; username, password, &#125;,&#125; ä¿®æ”¹ /router/user.js ä¸­çš„ä»£ç å¦‚ä¸‹ï¼š 1234567891011121314151617181920const express = require(&#x27;express&#x27;)const router = express.Router()// å¯¼å…¥ç”¨æˆ·è·¯ç”±å¤„ç†å‡½æ•°æ¨¡å—const userHandler = require(&#x27;../router_handler/user&#x27;)// 1. å¯¼å…¥éªŒè¯è¡¨å•æ•°æ®çš„ä¸­é—´ä»¶const expressJoi = require(&#x27;@escook/express-joi&#x27;)// 2. å¯¼å…¥éœ€è¦çš„éªŒè¯è§„åˆ™å¯¹è±¡const &#123; reg_login_schema &#125; = require(&#x27;../schema/user&#x27;)// æ³¨å†Œæ–°ç”¨æˆ·// 3. åœ¨æ³¨å†Œæ–°ç”¨æˆ·çš„è·¯ç”±ä¸­ï¼Œå£°æ˜å±€éƒ¨ä¸­é—´ä»¶ï¼Œå¯¹å½“å‰è¯·æ±‚ä¸­æºå¸¦çš„æ•°æ®è¿›è¡ŒéªŒè¯// 3.1 æ•°æ®éªŒè¯é€šè¿‡åï¼Œä¼šæŠŠè¿™æ¬¡è¯·æ±‚æµè½¬ç»™åé¢çš„è·¯ç”±å¤„ç†å‡½æ•°// 3.2 æ•°æ®éªŒè¯å¤±è´¥åï¼Œç»ˆæ­¢åç»­ä»£ç çš„æ‰§è¡Œï¼Œå¹¶æŠ›å‡ºä¸€ä¸ªå…¨å±€çš„ Error é”™è¯¯ï¼Œè¿›å…¥å…¨å±€é”™è¯¯çº§åˆ«ä¸­é—´ä»¶ä¸­è¿›è¡Œå¤„ç†router.post(&#x27;/reguser&#x27;, expressJoi(reg_login_schema), userHandler.regUser)// ç™»å½•router.post(&#x27;/login&#x27;, userHandler.login)module.exports = router åœ¨ app.js çš„å…¨å±€é”™è¯¯çº§åˆ«ä¸­é—´ä»¶ä¸­ï¼Œæ•è·éªŒè¯å¤±è´¥çš„é”™è¯¯ï¼Œå¹¶æŠŠéªŒè¯å¤±è´¥çš„ç»“æœå“åº”ç»™å®¢æˆ·ç«¯ï¼š 123456789const joi = require(&#x27;@hapi/joi&#x27;)// é”™è¯¯ä¸­é—´ä»¶app.use(function (err, req, res, next) &#123; // æ•°æ®éªŒè¯å¤±è´¥ if (err instanceof joi.ValidationError) return res.cc(err) // æœªçŸ¥é”™è¯¯ res.cc(err)&#125;) 2.6 ç™»å½•2.6.0 å®ç°æ­¥éª¤ æ£€æµ‹è¡¨å•æ•°æ®æ˜¯å¦åˆæ³• æ ¹æ®ç”¨æˆ·åæŸ¥è¯¢ç”¨æˆ·çš„æ•°æ® åˆ¤æ–­ç”¨æˆ·è¾“å…¥çš„å¯†ç æ˜¯å¦æ­£ç¡® ç”Ÿæˆ JWT çš„ Token å­—ç¬¦ä¸² 2.6.1 æ£€æµ‹ç™»å½•è¡¨å•çš„æ•°æ®æ˜¯å¦åˆæ³• å°† /router/user.js ä¸­ ç™»å½• çš„è·¯ç”±ä»£ç ä¿®æ”¹å¦‚ä¸‹ï¼š 12// ç™»å½•çš„è·¯ç”±router.post(&#x27;/login&#x27;, expressJoi(reg_login_schema), userHandler.login) 2.6.2 æ ¹æ®ç”¨æˆ·åæŸ¥è¯¢ç”¨æˆ·çš„æ•°æ® æ¥æ”¶è¡¨å•æ•°æ®ï¼š 1const userinfo = req.body å®šä¹‰ SQL è¯­å¥ï¼š 1const sql = `select * from ev_users where username=?` æ‰§è¡Œ SQL è¯­å¥ï¼ŒæŸ¥è¯¢ç”¨æˆ·çš„æ•°æ®ï¼š 1234567db.query(sql, userinfo.username, function (err, results) &#123; // æ‰§è¡Œ SQL è¯­å¥å¤±è´¥ if (err) return res.cc(err) // æ‰§è¡Œ SQL è¯­å¥æˆåŠŸï¼Œä½†æ˜¯æŸ¥è¯¢åˆ°æ•°æ®æ¡æ•°ä¸ç­‰äº 1 if (results.length !== 1) return res.cc(&#x27;ç™»å½•å¤±è´¥ï¼&#x27;) // TODOï¼šåˆ¤æ–­ç”¨æˆ·è¾“å…¥çš„ç™»å½•å¯†ç æ˜¯å¦å’Œæ•°æ®åº“ä¸­çš„å¯†ç ä¸€è‡´&#125;) 2.6.3 åˆ¤æ–­ç”¨æˆ·è¾“å…¥çš„å¯†ç æ˜¯å¦æ­£ç¡® æ ¸å¿ƒå®ç°æ€è·¯ï¼šè°ƒç”¨ bcrypt.compareSync(ç”¨æˆ·æäº¤çš„å¯†ç , æ•°æ®åº“ä¸­çš„å¯†ç ) æ–¹æ³•æ¯”è¾ƒå¯†ç æ˜¯å¦ä¸€è‡´ è¿”å›å€¼æ˜¯å¸ƒå°”å€¼ï¼ˆtrue ä¸€è‡´ã€false ä¸ä¸€è‡´ï¼‰ å…·ä½“çš„å®ç°ä»£ç å¦‚ä¸‹ï¼š 123456789// æ‹¿ç€ç”¨æˆ·è¾“å…¥çš„å¯†ç ,å’Œæ•°æ®åº“ä¸­å­˜å‚¨çš„å¯†ç è¿›è¡Œå¯¹æ¯”const compareResult = bcrypt.compareSync(userinfo.password, results[0].password)// å¦‚æœå¯¹æ¯”çš„ç»“æœç­‰äº false, åˆ™è¯æ˜ç”¨æˆ·è¾“å…¥çš„å¯†ç é”™è¯¯if (!compareResult) &#123; return res.cc(&#x27;ç™»å½•å¤±è´¥ï¼&#x27;)&#125;// TODOï¼šç™»å½•æˆåŠŸï¼Œç”Ÿæˆ Token å­—ç¬¦ä¸² 2.6.4 ç”Ÿæˆ JWT çš„ Token å­—ç¬¦ä¸² æ ¸å¿ƒæ³¨æ„ç‚¹ï¼šåœ¨ç”Ÿæˆ Token å­—ç¬¦ä¸²çš„æ—¶å€™ï¼Œä¸€å®šè¦å‰”é™¤ å¯†ç  å’Œ å¤´åƒ çš„å€¼ é€šè¿‡ ES6 çš„é«˜çº§è¯­æ³•ï¼Œå¿«é€Ÿå‰”é™¤ å¯†ç  å’Œ å¤´åƒ çš„å€¼ï¼š 12// å‰”é™¤å®Œæ¯•ä¹‹åï¼Œuser ä¸­åªä¿ç•™äº†ç”¨æˆ·çš„ id, username, nickname, email è¿™å››ä¸ªå±æ€§çš„å€¼const user = &#123; ...results[0], password: &#x27;&#x27;, user_pic: &#x27;&#x27; &#125; è¿è¡Œå¦‚ä¸‹çš„å‘½ä»¤ï¼Œå®‰è£…ç”Ÿæˆ Token å­—ç¬¦ä¸²çš„åŒ…ï¼š 1npm i jsonwebtoken@8.5.1 åœ¨ /router_handler/user.js æ¨¡å—çš„å¤´éƒ¨åŒºåŸŸï¼Œå¯¼å…¥ jsonwebtoken åŒ…ï¼š 12// ç”¨è¿™ä¸ªåŒ…æ¥ç”Ÿæˆ Token å­—ç¬¦ä¸²const jwt = require(&#x27;jsonwebtoken&#x27;) åˆ›å»º config.js æ–‡ä»¶ï¼Œå¹¶å‘å¤–å…±äº« åŠ å¯† å’Œ è¿˜åŸ Token çš„ jwtSecretKey å­—ç¬¦ä¸²ï¼š 123module.exports = &#123; jwtSecretKey: &#x27;itheima No1. ^_^&#x27;,&#125; å°†ç”¨æˆ·ä¿¡æ¯å¯¹è±¡åŠ å¯†æˆ Token å­—ç¬¦ä¸²ï¼š 1234567// å¯¼å…¥é…ç½®æ–‡ä»¶const config = require(&#x27;../config&#x27;)// ç”Ÿæˆ Token å­—ç¬¦ä¸²const tokenStr = jwt.sign(user, config.jwtSecretKey, &#123; expiresIn: &#x27;10h&#x27;, // token æœ‰æ•ˆæœŸä¸º 10 ä¸ªå°æ—¶&#125;) å°†ç”Ÿæˆçš„ Token å­—ç¬¦ä¸²å“åº”ç»™å®¢æˆ·ç«¯ï¼š 123456res.send(&#123; status: 0, message: &#x27;ç™»å½•æˆåŠŸï¼&#x27;, // ä¸ºäº†æ–¹ä¾¿å®¢æˆ·ç«¯ä½¿ç”¨ Tokenï¼Œåœ¨æœåŠ¡å™¨ç«¯ç›´æ¥æ‹¼æ¥ä¸Š Bearer çš„å‰ç¼€ token: &#x27;Bearer &#x27; + tokenStr,&#125;) 2.7 é…ç½®è§£æ Token çš„ä¸­é—´ä»¶ è¿è¡Œå¦‚ä¸‹çš„å‘½ä»¤ï¼Œå®‰è£…è§£æ Token çš„ä¸­é—´ä»¶ï¼š 1npm i express-jwt@5.3.3 åœ¨ app.js ä¸­æ³¨å†Œè·¯ç”±ä¹‹å‰ï¼Œé…ç½®è§£æ Token çš„ä¸­é—´ä»¶ï¼š 12345678// å¯¼å…¥é…ç½®æ–‡ä»¶const config = require(&#x27;./config&#x27;)// è§£æ token çš„ä¸­é—´ä»¶const expressJWT = require(&#x27;express-jwt&#x27;)// ä½¿ç”¨ .unless(&#123; path: [/^\\/api\\//] &#125;) æŒ‡å®šå“ªäº›æ¥å£ä¸éœ€è¦è¿›è¡Œ Token çš„èº«ä»½è®¤è¯app.use(expressJWT(&#123; secret: config.jwtSecretKey &#125;).unless(&#123; path: [/^\\/api\\//] &#125;)) åœ¨ app.js ä¸­çš„ é”™è¯¯çº§åˆ«ä¸­é—´ä»¶ é‡Œé¢ï¼Œæ•è·å¹¶å¤„ç† Token è®¤è¯å¤±è´¥åçš„é”™è¯¯ï¼š 123456789// é”™è¯¯ä¸­é—´ä»¶app.use(function (err, req, res, next) &#123; // çœç•¥å…¶å®ƒä»£ç ... // æ•è·èº«ä»½è®¤è¯å¤±è´¥çš„é”™è¯¯ if (err.name === &#x27;UnauthorizedError&#x27;) return res.cc(&#x27;èº«ä»½è®¤è¯å¤±è´¥ï¼&#x27;) // æœªçŸ¥é”™è¯¯...&#125;) 3. ä¸ªäººä¸­å¿ƒ3.1 è·å–ç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯3.1.0 å®ç°æ­¥éª¤ åˆå§‹åŒ– è·¯ç”± æ¨¡å— åˆå§‹åŒ– è·¯ç”±å¤„ç†å‡½æ•° æ¨¡å— è·å–ç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯ 3.1.1 åˆå§‹åŒ–è·¯ç”±æ¨¡å— åˆ›å»º /router/userinfo.js è·¯ç”±æ¨¡å—ï¼Œå¹¶åˆå§‹åŒ–å¦‚ä¸‹çš„ä»£ç ç»“æ„ï¼š 123456789101112// å¯¼å…¥ expressconst express = require(&#x27;express&#x27;)// åˆ›å»ºè·¯ç”±å¯¹è±¡const router = express.Router()// è·å–ç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯router.get(&#x27;/userinfo&#x27;, (req, res) =&gt; &#123; res.send(&#x27;ok&#x27;)&#125;)// å‘å¤–å…±äº«è·¯ç”±å¯¹è±¡module.exports = router åœ¨ app.js ä¸­å¯¼å…¥å¹¶ä½¿ç”¨ä¸ªäººä¸­å¿ƒçš„è·¯ç”±æ¨¡å—ï¼š 1234// å¯¼å…¥å¹¶ä½¿ç”¨ç”¨æˆ·ä¿¡æ¯è·¯ç”±æ¨¡å—const userinfoRouter = require(&#x27;./router/userinfo&#x27;)// æ³¨æ„ï¼šä»¥ /my å¼€å¤´çš„æ¥å£ï¼Œéƒ½æ˜¯æœ‰æƒé™çš„æ¥å£ï¼Œéœ€è¦è¿›è¡Œ Token èº«ä»½è®¤è¯app.use(&#x27;/my&#x27;, userinfoRouter) 3.1.2 åˆå§‹åŒ–è·¯ç”±å¤„ç†å‡½æ•°æ¨¡å— åˆ›å»º /router_handler/userinfo.js è·¯ç”±å¤„ç†å‡½æ•°æ¨¡å—ï¼Œå¹¶åˆå§‹åŒ–å¦‚ä¸‹çš„ä»£ç ç»“æ„ï¼š 1234// è·å–ç”¨æˆ·åŸºæœ¬ä¿¡æ¯çš„å¤„ç†å‡½æ•°exports.getUserInfo = (req, res) =&gt; &#123; res.send(&#x27;ok&#x27;)&#125; ä¿®æ”¹ /router/userinfo.js ä¸­çš„ä»£ç å¦‚ä¸‹ï¼š 12345678910const express = require(&#x27;express&#x27;)const router = express.Router()// å¯¼å…¥ç”¨æˆ·ä¿¡æ¯çš„å¤„ç†å‡½æ•°æ¨¡å—const userinfo_handler = require(&#x27;../router_handler/userinfo&#x27;)// è·å–ç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯router.get(&#x27;/userinfo&#x27;, userinfo_handler.getUserInfo)module.exports = router 3.1.3 è·å–ç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯ åœ¨ /router_handler/userinfo.js å¤´éƒ¨å¯¼å…¥æ•°æ®åº“æ“ä½œæ¨¡å—ï¼š 12// å¯¼å…¥æ•°æ®åº“æ“ä½œæ¨¡å—const db = require(&#x27;../db/index&#x27;) å®šä¹‰ SQL è¯­å¥ï¼š 123// æ ¹æ®ç”¨æˆ·çš„ idï¼ŒæŸ¥è¯¢ç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯// æ³¨æ„ï¼šä¸ºäº†é˜²æ­¢ç”¨æˆ·çš„å¯†ç æ³„éœ²ï¼Œéœ€è¦æ’é™¤ password å­—æ®µconst sql = `select id, username, nickname, email, user_pic from ev_users where id=?` è°ƒç”¨ db.query() æ‰§è¡Œ SQL è¯­å¥ï¼š 123456789101112131415// æ³¨æ„ï¼šreq å¯¹è±¡ä¸Šçš„ user å±æ€§ï¼Œæ˜¯ Token è§£ææˆåŠŸï¼Œexpress-jwt ä¸­é—´ä»¶å¸®æˆ‘ä»¬æŒ‚è½½ä¸Šå»çš„db.query(sql, req.user.id, (err, results) =&gt; &#123; // 1. æ‰§è¡Œ SQL è¯­å¥å¤±è´¥ if (err) return res.cc(err) // 2. æ‰§è¡Œ SQL è¯­å¥æˆåŠŸï¼Œä½†æ˜¯æŸ¥è¯¢åˆ°çš„æ•°æ®æ¡æ•°ä¸ç­‰äº 1 if (results.length !== 1) return res.cc(&#x27;è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥ï¼&#x27;) // 3. å°†ç”¨æˆ·ä¿¡æ¯å“åº”ç»™å®¢æˆ·ç«¯ res.send(&#123; status: 0, message: &#x27;è·å–ç”¨æˆ·åŸºæœ¬ä¿¡æ¯æˆåŠŸï¼&#x27;, data: results[0], &#125;)&#125;) 3.2 æ›´æ–°ç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯3.2.0 å®ç°æ­¥éª¤ å®šä¹‰è·¯ç”±å’Œå¤„ç†å‡½æ•° éªŒè¯è¡¨å•æ•°æ® å®ç°æ›´æ–°ç”¨æˆ·åŸºæœ¬ä¿¡æ¯çš„åŠŸèƒ½ 3.2.1 å®šä¹‰è·¯ç”±å’Œå¤„ç†å‡½æ•° åœ¨ /router/userinfo.js æ¨¡å—ä¸­ï¼Œæ–°å¢ æ›´æ–°ç”¨æˆ·åŸºæœ¬ä¿¡æ¯ çš„è·¯ç”±ï¼š 12// æ›´æ–°ç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯router.post(&#x27;/userinfo&#x27;, userinfo_handler.updateUserInfo) åœ¨ /router_handler/userinfo.js æ¨¡å—ä¸­ï¼Œå®šä¹‰å¹¶å‘å¤–å…±äº« æ›´æ–°ç”¨æˆ·åŸºæœ¬ä¿¡æ¯ çš„è·¯ç”±å¤„ç†å‡½æ•°ï¼š 1234// æ›´æ–°ç”¨æˆ·åŸºæœ¬ä¿¡æ¯çš„å¤„ç†å‡½æ•°exports.updateUserInfo = (req, res) =&gt; &#123; res.send(&#x27;ok&#x27;)&#125; 3.2.2 éªŒè¯è¡¨å•æ•°æ® åœ¨ /schema/user.js éªŒè¯è§„åˆ™æ¨¡å—ä¸­ï¼Œå®šä¹‰ idï¼Œnicknameï¼Œemail çš„éªŒè¯è§„åˆ™å¦‚ä¸‹ï¼š 1234// å®šä¹‰ id, nickname, emial çš„éªŒè¯è§„åˆ™const id = joi.number().integer().min(1).required()const nickname = joi.string().required()const email = joi.string().email().required() å¹¶ä½¿ç”¨ exports å‘å¤–å…±äº«å¦‚ä¸‹çš„ éªŒè¯è§„åˆ™å¯¹è±¡ï¼š 12345678// éªŒè¯è§„åˆ™å¯¹è±¡ - æ›´æ–°ç”¨æˆ·åŸºæœ¬ä¿¡æ¯exports.update_userinfo_schema = &#123; body: &#123; id, nickname, email, &#125;,&#125; åœ¨ /router/userinfo.js æ¨¡å—ä¸­ï¼Œå¯¼å…¥éªŒè¯æ•°æ®åˆæ³•æ€§çš„ä¸­é—´ä»¶ï¼š 12// å¯¼å…¥éªŒè¯æ•°æ®åˆæ³•æ€§çš„ä¸­é—´ä»¶const expressJoi = require(&#x27;@escook/express-joi&#x27;) åœ¨ /router/userinfo.js æ¨¡å—ä¸­ï¼Œå¯¼å…¥éœ€è¦çš„éªŒè¯è§„åˆ™å¯¹è±¡ï¼š 12// å¯¼å…¥éœ€è¦çš„éªŒè¯è§„åˆ™å¯¹è±¡const &#123; update_userinfo_schema &#125; = require(&#x27;../schema/user&#x27;) åœ¨ /router/userinfo.js æ¨¡å—ä¸­ï¼Œä¿®æ”¹ æ›´æ–°ç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯ çš„è·¯ç”±å¦‚ä¸‹ï¼š 12// æ›´æ–°ç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯router.post(&#x27;/userinfo&#x27;, expressJoi(update_userinfo_schema), userinfo_handler.updateUserInfo) 3.2.3 å®ç°æ›´æ–°ç”¨æˆ·åŸºæœ¬ä¿¡æ¯çš„åŠŸèƒ½ å®šä¹‰å¾…æ‰§è¡Œçš„ SQL è¯­å¥ï¼š 1const sql = `update ev_users set ? where id=?` è°ƒç”¨ db.query() æ‰§è¡Œ SQL è¯­å¥å¹¶ä¼ å‚ï¼š 12345678910db.query(sql, [req.body, req.body.id], (err, results) =&gt; &#123; // æ‰§è¡Œ SQL è¯­å¥å¤±è´¥ if (err) return res.cc(err) // æ‰§è¡Œ SQL è¯­å¥æˆåŠŸï¼Œä½†å½±å“è¡Œæ•°ä¸ä¸º 1 if (results.affectedRows !== 1) return res.cc(&#x27;ä¿®æ”¹ç”¨æˆ·åŸºæœ¬ä¿¡æ¯å¤±è´¥ï¼&#x27;) // ä¿®æ”¹ç”¨æˆ·ä¿¡æ¯æˆåŠŸ return res.cc(&#x27;ä¿®æ”¹ç”¨æˆ·åŸºæœ¬ä¿¡æ¯æˆåŠŸï¼&#x27;, 0)&#125;) 3.3 é‡ç½®å¯†ç 3.3.0 å®ç°æ­¥éª¤ å®šä¹‰è·¯ç”±å’Œå¤„ç†å‡½æ•° éªŒè¯è¡¨å•æ•°æ® å®ç°é‡ç½®å¯†ç çš„åŠŸèƒ½ 3.3.1 å®šä¹‰è·¯ç”±å’Œå¤„ç†å‡½æ•° åœ¨ /router/userinfo.js æ¨¡å—ä¸­ï¼Œæ–°å¢ é‡ç½®å¯†ç  çš„è·¯ç”±ï¼š 12// é‡ç½®å¯†ç çš„è·¯ç”±router.post(&#x27;/updatepwd&#x27;, userinfo_handler.updatePassword) åœ¨ /router_handler/userinfo.js æ¨¡å—ä¸­ï¼Œå®šä¹‰å¹¶å‘å¤–å…±äº« é‡ç½®å¯†ç  çš„è·¯ç”±å¤„ç†å‡½æ•°ï¼š 1234// é‡ç½®å¯†ç çš„å¤„ç†å‡½æ•°exports.updatePassword = (req, res) =&gt; &#123; res.send(&#x27;ok&#x27;)&#125; 3.3.2 éªŒè¯è¡¨å•æ•°æ® æ ¸å¿ƒéªŒè¯æ€è·¯ï¼šæ—§å¯†ç ä¸æ–°å¯†ç ï¼Œå¿…é¡»ç¬¦åˆå¯†ç çš„éªŒè¯è§„åˆ™ï¼Œå¹¶ä¸”æ–°å¯†ç ä¸èƒ½ä¸æ—§å¯†ç ä¸€è‡´ï¼ åœ¨ /schema/user.js æ¨¡å—ä¸­ï¼Œä½¿ç”¨ exports å‘å¤–å…±äº«å¦‚ä¸‹çš„ éªŒè¯è§„åˆ™å¯¹è±¡ï¼š 12345678910111213// éªŒè¯è§„åˆ™å¯¹è±¡ - é‡ç½®å¯†ç exports.update_password_schema = &#123; body: &#123; // ä½¿ç”¨ password è¿™ä¸ªè§„åˆ™ï¼ŒéªŒè¯ req.body.oldPwd çš„å€¼ oldPwd: password, // ä½¿ç”¨ joi.not(joi.ref(&#x27;oldPwd&#x27;)).concat(password) è§„åˆ™ï¼ŒéªŒè¯ req.body.newPwd çš„å€¼ // è§£è¯»ï¼š // 1. joi.ref(&#x27;oldPwd&#x27;) è¡¨ç¤º newPwd çš„å€¼å¿…é¡»å’Œ oldPwd çš„å€¼ä¿æŒä¸€è‡´ // 2. joi.not(joi.ref(&#x27;oldPwd&#x27;)) è¡¨ç¤º newPwd çš„å€¼ä¸èƒ½ç­‰äº oldPwd çš„å€¼ // 3. .concat() ç”¨äºåˆå¹¶ joi.not(joi.ref(&#x27;oldPwd&#x27;)) å’Œ password è¿™ä¸¤æ¡éªŒè¯è§„åˆ™ newPwd: joi.not(joi.ref(&#x27;oldPwd&#x27;)).concat(password), &#125;,&#125; åœ¨ /router/userinfo.js æ¨¡å—ä¸­ï¼Œå¯¼å…¥éœ€è¦çš„éªŒè¯è§„åˆ™å¯¹è±¡ï¼š 12// å¯¼å…¥éœ€è¦çš„éªŒè¯è§„åˆ™å¯¹è±¡const &#123; update_userinfo_schema, update_password_schema &#125; = require(&#x27;../schema/user&#x27;) å¹¶åœ¨ é‡ç½®å¯†ç çš„è·¯ç”± ä¸­ï¼Œä½¿ç”¨ update_password_schema è§„åˆ™éªŒè¯è¡¨å•çš„æ•°æ®ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š 1router.post(&#x27;/updatepwd&#x27;, expressJoi(update_password_schema), userinfo_handler.updatePassword) 3.3.3 å®ç°é‡ç½®å¯†ç çš„åŠŸèƒ½ æ ¹æ® id æŸ¥è¯¢ç”¨æˆ·æ˜¯å¦å­˜åœ¨ï¼š 12345678910111213// å®šä¹‰æ ¹æ® id æŸ¥è¯¢ç”¨æˆ·æ•°æ®çš„ SQL è¯­å¥const sql = `select * from ev_users where id=?`// æ‰§è¡Œ SQL è¯­å¥æŸ¥è¯¢ç”¨æˆ·æ˜¯å¦å­˜åœ¨db.query(sql, req.user.id, (err, results) =&gt; &#123; // æ‰§è¡Œ SQL è¯­å¥å¤±è´¥ if (err) return res.cc(err) // æ£€æŸ¥æŒ‡å®š id çš„ç”¨æˆ·æ˜¯å¦å­˜åœ¨ if (results.length !== 1) return res.cc(&#x27;ç”¨æˆ·ä¸å­˜åœ¨ï¼&#x27;) // TODOï¼šåˆ¤æ–­æäº¤çš„æ—§å¯†ç æ˜¯å¦æ­£ç¡®&#125;) åˆ¤æ–­æäº¤çš„ æ—§å¯†ç  æ˜¯å¦æ­£ç¡®ï¼š 12345678// åœ¨å¤´éƒ¨åŒºåŸŸå¯¼å…¥ bcryptjs åï¼Œ// å³å¯ä½¿ç”¨ bcrypt.compareSync(æäº¤çš„å¯†ç ï¼Œæ•°æ®åº“ä¸­çš„å¯†ç ) æ–¹æ³•éªŒè¯å¯†ç æ˜¯å¦æ­£ç¡®// compareSync() å‡½æ•°çš„è¿”å›å€¼ä¸ºå¸ƒå°”å€¼ï¼Œtrue è¡¨ç¤ºå¯†ç æ­£ç¡®ï¼Œfalse è¡¨ç¤ºå¯†ç é”™è¯¯const bcrypt = require(&#x27;bcryptjs&#x27;)// åˆ¤æ–­æäº¤çš„æ—§å¯†ç æ˜¯å¦æ­£ç¡®const compareResult = bcrypt.compareSync(req.body.oldPwd, results[0].password)if (!compareResult) return res.cc(&#x27;åŸå¯†ç é”™è¯¯ï¼&#x27;) å¯¹æ–°å¯†ç è¿›è¡Œ bcrypt åŠ å¯†ä¹‹åï¼Œæ›´æ–°åˆ°æ•°æ®åº“ä¸­ï¼š 1234567891011121314151617// å®šä¹‰æ›´æ–°ç”¨æˆ·å¯†ç çš„ SQL è¯­å¥const sql = `update ev_users set password=? where id=?`// å¯¹æ–°å¯†ç è¿›è¡Œ bcrypt åŠ å¯†å¤„ç†const newPwd = bcrypt.hashSync(req.body.newPwd, 10)// æ‰§è¡Œ SQL è¯­å¥ï¼Œæ ¹æ® id æ›´æ–°ç”¨æˆ·çš„å¯†ç db.query(sql, [newPwd, req.user.id], (err, results) =&gt; &#123; // SQL è¯­å¥æ‰§è¡Œå¤±è´¥ if (err) return res.cc(err) // SQL è¯­å¥æ‰§è¡ŒæˆåŠŸï¼Œä½†æ˜¯å½±å“è¡Œæ•°ä¸ç­‰äº 1 if (results.affectedRows !== 1) return res.cc(&#x27;æ›´æ–°å¯†ç å¤±è´¥ï¼&#x27;) // æ›´æ–°å¯†ç æˆåŠŸ res.cc(&#x27;æ›´æ–°å¯†ç æˆåŠŸï¼&#x27;, 0)&#125;) 3.4 æ›´æ–°ç”¨æˆ·å¤´åƒ3.4.0 å®ç°æ­¥éª¤ å®šä¹‰è·¯ç”±å’Œå¤„ç†å‡½æ•° éªŒè¯è¡¨å•æ•°æ® å®ç°æ›´æ–°ç”¨æˆ·å¤´åƒçš„åŠŸèƒ½ 3.4.1 å®šä¹‰è·¯ç”±å’Œå¤„ç†å‡½æ•° åœ¨ /router/userinfo.js æ¨¡å—ä¸­ï¼Œæ–°å¢ æ›´æ–°ç”¨æˆ·å¤´åƒ çš„è·¯ç”±ï¼š 12// æ›´æ–°ç”¨æˆ·å¤´åƒçš„è·¯ç”±router.post(&#x27;/update/avatar&#x27;, userinfo_handler.updateAvatar) åœ¨ /router_handler/userinfo.js æ¨¡å—ä¸­ï¼Œå®šä¹‰å¹¶å‘å¤–å…±äº« æ›´æ–°ç”¨æˆ·å¤´åƒ çš„è·¯ç”±å¤„ç†å‡½æ•°ï¼š 1234// æ›´æ–°ç”¨æˆ·å¤´åƒçš„å¤„ç†å‡½æ•°exports.updateAvatar = (req, res) =&gt; &#123; res.send(&#x27;ok&#x27;)&#125; 3.4.2 éªŒè¯è¡¨å•æ•°æ® åœ¨ /schema/user.js éªŒè¯è§„åˆ™æ¨¡å—ä¸­ï¼Œå®šä¹‰ avatar çš„éªŒè¯è§„åˆ™å¦‚ä¸‹ï¼š 123// dataUri() æŒ‡çš„æ˜¯å¦‚ä¸‹æ ¼å¼çš„å­—ç¬¦ä¸²æ•°æ®ï¼š// data:image/png;base64,VE9PTUFOWVNFQ1JFVFM=const avatar = joi.string().dataUri().required() å¹¶ä½¿ç”¨ exports å‘å¤–å…±äº«å¦‚ä¸‹çš„ éªŒè¯è§„åˆ™å¯¹è±¡ï¼š 123456// éªŒè¯è§„åˆ™å¯¹è±¡ - æ›´æ–°å¤´åƒexports.update_avatar_schema = &#123; body: &#123; avatar, &#125;,&#125; åœ¨ /router/userinfo.js æ¨¡å—ä¸­ï¼Œå¯¼å…¥éœ€è¦çš„éªŒè¯è§„åˆ™å¯¹è±¡ï¼š 1const &#123; update_avatar_schema &#125; = require(&#x27;../schema/user&#x27;) åœ¨ /router/userinfo.js æ¨¡å—ä¸­ï¼Œä¿®æ”¹ æ›´æ–°ç”¨æˆ·å¤´åƒ çš„è·¯ç”±å¦‚ä¸‹ï¼š 1router.post(&#x27;/update/avatar&#x27;, expressJoi(update_avatar_schema), userinfo_handler.updateAvatar) 3.4.3 å®ç°æ›´æ–°ç”¨æˆ·å¤´åƒçš„åŠŸèƒ½ å®šä¹‰æ›´æ–°ç”¨æˆ·å¤´åƒçš„ SQL è¯­å¥ï¼š 1const sql = &#x27;update ev_users set user_pic=? where id=?&#x27; è°ƒç”¨ db.query() æ‰§è¡Œ SQL è¯­å¥ï¼Œæ›´æ–°å¯¹åº”ç”¨æˆ·çš„å¤´åƒï¼š 12345678910db.query(sql, [req.body.avatar, req.user.id], (err, results) =&gt; &#123; // æ‰§è¡Œ SQL è¯­å¥å¤±è´¥ if (err) return res.cc(err) // æ‰§è¡Œ SQL è¯­å¥æˆåŠŸï¼Œä½†æ˜¯å½±å“è¡Œæ•°ä¸ç­‰äº 1 if (results.affectedRows !== 1) return res.cc(&#x27;æ›´æ–°å¤´åƒå¤±è´¥ï¼&#x27;) // æ›´æ–°ç”¨æˆ·å¤´åƒæˆåŠŸ return res.cc(&#x27;æ›´æ–°å¤´åƒæˆåŠŸï¼&#x27;, 0)&#125;) 4. æ–‡ç« åˆ†ç±»ç®¡ç†4.1 æ–°å»º ev_article_cate è¡¨4.1.1 åˆ›å»ºè¡¨ç»“æ„ 4.1.2 æ–°å¢ä¸¤æ¡åˆå§‹æ•°æ® 4.2 è·å–æ–‡ç« åˆ†ç±»åˆ—è¡¨4.2.0 å®ç°æ­¥éª¤ åˆå§‹åŒ–è·¯ç”±æ¨¡å— åˆå§‹åŒ–è·¯ç”±å¤„ç†å‡½æ•°æ¨¡å— è·å–æ–‡ç« åˆ†ç±»åˆ—è¡¨æ•°æ® 4.2.1 åˆå§‹åŒ–è·¯ç”±æ¨¡å— åˆ›å»º /router/artcate.js è·¯ç”±æ¨¡å—ï¼Œå¹¶åˆå§‹åŒ–å¦‚ä¸‹çš„ä»£ç ç»“æ„ï¼š 123456789101112// å¯¼å…¥ expressconst express = require(&#x27;express&#x27;)// åˆ›å»ºè·¯ç”±å¯¹è±¡const router = express.Router()// è·å–æ–‡ç« åˆ†ç±»çš„åˆ—è¡¨æ•°æ®router.get(&#x27;/cates&#x27;, (req, res) =&gt; &#123; res.send(&#x27;ok&#x27;)&#125;)// å‘å¤–å…±äº«è·¯ç”±å¯¹è±¡module.exports = router åœ¨ app.js ä¸­å¯¼å…¥å¹¶ä½¿ç”¨æ–‡ç« åˆ†ç±»çš„è·¯ç”±æ¨¡å—ï¼š 1234// å¯¼å…¥å¹¶ä½¿ç”¨æ–‡ç« åˆ†ç±»è·¯ç”±æ¨¡å—const artCateRouter = require(&#x27;./router/artcate&#x27;)// ä¸ºæ–‡ç« åˆ†ç±»çš„è·¯ç”±æŒ‚è½½ç»Ÿä¸€çš„è®¿é—®å‰ç¼€ /my/articleapp.use(&#x27;/my/article&#x27;, artCateRouter) 4.2.2 åˆå§‹åŒ–è·¯ç”±å¤„ç†å‡½æ•°æ¨¡å— åˆ›å»º /router_handler/artcate.js è·¯ç”±å¤„ç†å‡½æ•°æ¨¡å—ï¼Œå¹¶åˆå§‹åŒ–å¦‚ä¸‹çš„ä»£ç ç»“æ„ï¼š 1234// è·å–æ–‡ç« åˆ†ç±»åˆ—è¡¨æ•°æ®çš„å¤„ç†å‡½æ•°exports.getArticleCates = (req, res) =&gt; &#123; res.send(&#x27;ok&#x27;)&#125; ä¿®æ”¹ /router/artcate.js ä¸­çš„ä»£ç å¦‚ä¸‹ï¼š 12345678910const express = require(&#x27;express&#x27;)const router = express.Router()// å¯¼å…¥æ–‡ç« åˆ†ç±»çš„è·¯ç”±å¤„ç†å‡½æ•°æ¨¡å—const artcate_handler = require(&#x27;../router_handler/artcate&#x27;)// è·å–æ–‡ç« åˆ†ç±»çš„åˆ—è¡¨æ•°æ®router.get(&#x27;/cates&#x27;, artcate_handler.getArticleCates)module.exports = router 4.2.3 è·å–æ–‡ç« åˆ†ç±»åˆ—è¡¨æ•°æ® åœ¨ /router_handler/artcate.js å¤´éƒ¨å¯¼å…¥æ•°æ®åº“æ“ä½œæ¨¡å—ï¼š 12// å¯¼å…¥æ•°æ®åº“æ“ä½œæ¨¡å—const db = require(&#x27;../db/index&#x27;) å®šä¹‰ SQL è¯­å¥ï¼š 123// æ ¹æ®åˆ†ç±»çš„çŠ¶æ€ï¼Œè·å–æ‰€æœ‰æœªè¢«åˆ é™¤çš„åˆ†ç±»åˆ—è¡¨æ•°æ®// is_delete ä¸º 0 è¡¨ç¤ºæ²¡æœ‰è¢« æ ‡è®°ä¸ºåˆ é™¤ çš„æ•°æ®const sql = &#x27;select * from ev_article_cate where is_delete=0 order by id asc&#x27; è°ƒç”¨ db.query() æ‰§è¡Œ SQL è¯­å¥ï¼š 1234567891011db.query(sql, (err, results) =&gt; &#123; // 1. æ‰§è¡Œ SQL è¯­å¥å¤±è´¥ if (err) return res.cc(err) // 2. æ‰§è¡Œ SQL è¯­å¥æˆåŠŸ res.send(&#123; status: 0, message: &#x27;è·å–æ–‡ç« åˆ†ç±»åˆ—è¡¨æˆåŠŸï¼&#x27;, data: results, &#125;)&#125;) 4.3 æ–°å¢æ–‡ç« åˆ†ç±»4.3.0 å®ç°æ­¥éª¤ å®šä¹‰è·¯ç”±å’Œå¤„ç†å‡½æ•° éªŒè¯è¡¨å•æ•°æ® æŸ¥è¯¢ åˆ†ç±»åç§° ä¸ åˆ†ç±»åˆ«å æ˜¯å¦è¢«å ç”¨ å®ç°æ–°å¢æ–‡ç« åˆ†ç±»çš„åŠŸèƒ½ 4.3.1 å®šä¹‰è·¯ç”±å’Œå¤„ç†å‡½æ•° åœ¨ /router/artcate.js æ¨¡å—ä¸­ï¼Œæ·»åŠ  æ–°å¢æ–‡ç« åˆ†ç±» çš„è·¯ç”±ï¼š 12// æ–°å¢æ–‡ç« åˆ†ç±»çš„è·¯ç”±router.post(&#x27;/addcates&#x27;, artcate_handler.addArticleCates) åœ¨ /router_handler/artcate.js æ¨¡å—ä¸­ï¼Œå®šä¹‰å¹¶å‘å¤–å…±äº« æ–°å¢æ–‡ç« åˆ†ç±» çš„è·¯ç”±å¤„ç†å‡½æ•°ï¼š 1234// æ–°å¢æ–‡ç« åˆ†ç±»çš„å¤„ç†å‡½æ•°exports.addArticleCates = (req, res) =&gt; &#123; res.send(&#x27;ok&#x27;)&#125; 4.3.2 éªŒè¯è¡¨å•æ•°æ® åˆ›å»º /schema/artcate.js æ–‡ç« åˆ†ç±»æ•°æ®éªŒè¯æ¨¡å—ï¼Œå¹¶å®šä¹‰å¦‚ä¸‹çš„éªŒè¯è§„åˆ™ï¼š 1234567891011121314// å¯¼å…¥å®šä¹‰éªŒè¯è§„åˆ™çš„æ¨¡å—const joi = require(&#x27;@hapi/joi&#x27;)// å®šä¹‰ åˆ†ç±»åç§° å’Œ åˆ†ç±»åˆ«å çš„æ ¡éªŒè§„åˆ™const name = joi.string().required()const alias = joi.string().alphanum().required()// æ ¡éªŒè§„åˆ™å¯¹è±¡ - æ·»åŠ åˆ†ç±»exports.add_cate_schema = &#123; body: &#123; name, alias, &#125;,&#125; åœ¨ /router/artcate.js æ¨¡å—ä¸­ï¼Œä½¿ç”¨ add_cate_schema å¯¹æ•°æ®è¿›è¡ŒéªŒè¯ï¼š 1234567// å¯¼å…¥éªŒè¯æ•°æ®çš„ä¸­é—´ä»¶const expressJoi = require(&#x27;@escook/express-joi&#x27;)// å¯¼å…¥æ–‡ç« åˆ†ç±»çš„éªŒè¯æ¨¡å—const &#123; add_cate_schema &#125; = require(&#x27;../schema/artcate&#x27;)// æ–°å¢æ–‡ç« åˆ†ç±»çš„è·¯ç”±router.post(&#x27;/addcates&#x27;, expressJoi(add_cate_schema), artcate_handler.addArticleCates) 4.3.3 æŸ¥è¯¢åˆ†ç±»åç§°ä¸åˆ«åæ˜¯å¦è¢«å ç”¨ å®šä¹‰æŸ¥é‡çš„ SQL è¯­å¥ï¼š 12// å®šä¹‰æŸ¥è¯¢ åˆ†ç±»åç§° ä¸ åˆ†ç±»åˆ«å æ˜¯å¦è¢«å ç”¨çš„ SQL è¯­å¥const sql = `select * from ev_article_cate where name=? or alias=?` è°ƒç”¨ db.query() æ‰§è¡ŒæŸ¥é‡çš„æ“ä½œï¼š 12345678910111213// æ‰§è¡ŒæŸ¥é‡æ“ä½œdb.query(sql, [req.body.name, req.body.alias], (err, results) =&gt; &#123; // æ‰§è¡Œ SQL è¯­å¥å¤±è´¥ if (err) return res.cc(err) // åˆ¤æ–­ åˆ†ç±»åç§° å’Œ åˆ†ç±»åˆ«å æ˜¯å¦è¢«å ç”¨ if (results.length === 2) return res.cc(&#x27;åˆ†ç±»åç§°ä¸åˆ«åè¢«å ç”¨ï¼Œè¯·æ›´æ¢åé‡è¯•ï¼&#x27;) // åˆ†åˆ«åˆ¤æ–­ åˆ†ç±»åç§° å’Œ åˆ†ç±»åˆ«å æ˜¯å¦è¢«å ç”¨ if (results.length === 1 &amp;&amp; results[0].name === req.body.name) return res.cc(&#x27;åˆ†ç±»åç§°è¢«å ç”¨ï¼Œè¯·æ›´æ¢åé‡è¯•ï¼&#x27;) if (results.length === 1 &amp;&amp; results[0].alias === req.body.alias) return res.cc(&#x27;åˆ†ç±»åˆ«åè¢«å ç”¨ï¼Œè¯·æ›´æ¢åé‡è¯•ï¼&#x27;) // TODOï¼šæ–°å¢æ–‡ç« åˆ†ç±»&#125;) 4.3.4 å®ç°æ–°å¢æ–‡ç« åˆ†ç±»çš„åŠŸèƒ½ å®šä¹‰æ–°å¢æ–‡ç« åˆ†ç±»çš„ SQL è¯­å¥ï¼š 1const sql = `insert into ev_article_cate set ?` è°ƒç”¨ db.query() æ‰§è¡Œæ–°å¢æ–‡ç« åˆ†ç±»çš„ SQL è¯­å¥ï¼š 12345678910db.query(sql, req.body, (err, results) =&gt; &#123; // SQL è¯­å¥æ‰§è¡Œå¤±è´¥ if (err) return res.cc(err) // SQL è¯­å¥æ‰§è¡ŒæˆåŠŸï¼Œä½†æ˜¯å½±å“è¡Œæ•°ä¸ç­‰äº 1 if (results.affectedRows !== 1) return res.cc(&#x27;æ–°å¢æ–‡ç« åˆ†ç±»å¤±è´¥ï¼&#x27;) // æ–°å¢æ–‡ç« åˆ†ç±»æˆåŠŸ res.cc(&#x27;æ–°å¢æ–‡ç« åˆ†ç±»æˆåŠŸï¼&#x27;, 0)&#125;) 4.4 æ ¹æ® Id åˆ é™¤æ–‡ç« åˆ†ç±»4.4.0 å®ç°æ­¥éª¤ å®šä¹‰è·¯ç”±å’Œå¤„ç†å‡½æ•° éªŒè¯è¡¨å•æ•°æ® å®ç°åˆ é™¤æ–‡ç« åˆ†ç±»çš„åŠŸèƒ½ 4.4.1 å®šä¹‰è·¯ç”±å’Œå¤„ç†å‡½æ•° åœ¨ /router/artcate.js æ¨¡å—ä¸­ï¼Œæ·»åŠ  åˆ é™¤æ–‡ç« åˆ†ç±» çš„è·¯ç”±ï¼š 12// åˆ é™¤æ–‡ç« åˆ†ç±»çš„è·¯ç”±router.get(&#x27;/deletecate/:id&#x27;, artcate_handler.deleteCateById) åœ¨ /router_handler/artcate.js æ¨¡å—ä¸­ï¼Œå®šä¹‰å¹¶å‘å¤–å…±äº« åˆ é™¤æ–‡ç« åˆ†ç±» çš„è·¯ç”±å¤„ç†å‡½æ•°ï¼š 1234// åˆ é™¤æ–‡ç« åˆ†ç±»çš„å¤„ç†å‡½æ•°exports.deleteCateById = (req, res) =&gt; &#123; res.send(&#x27;ok&#x27;)&#125; 4.4.2 éªŒè¯è¡¨å•æ•°æ® åœ¨ /schema/artcate.js éªŒè¯è§„åˆ™æ¨¡å—ä¸­ï¼Œå®šä¹‰ id çš„éªŒè¯è§„åˆ™å¦‚ä¸‹ï¼š 12// å®šä¹‰ åˆ†ç±»Id çš„æ ¡éªŒè§„åˆ™const id = joi.number().integer().min(1).required() å¹¶ä½¿ç”¨ exports å‘å¤–å…±äº«å¦‚ä¸‹çš„ éªŒè¯è§„åˆ™å¯¹è±¡ï¼š 123456// æ ¡éªŒè§„åˆ™å¯¹è±¡ - åˆ é™¤åˆ†ç±»exports.delete_cate_schema = &#123; params: &#123; id, &#125;,&#125; åœ¨ /router/artcate.js æ¨¡å—ä¸­ï¼Œå¯¼å…¥éœ€è¦çš„éªŒè¯è§„åˆ™å¯¹è±¡ï¼Œå¹¶åœ¨è·¯ç”±ä¸­ä½¿ç”¨ï¼š 12345// å¯¼å…¥åˆ é™¤åˆ†ç±»çš„éªŒè¯è§„åˆ™å¯¹è±¡const &#123; delete_cate_schema &#125; = require(&#x27;../schema/artcate&#x27;)// åˆ é™¤æ–‡ç« åˆ†ç±»çš„è·¯ç”±router.get(&#x27;/deletecate/:id&#x27;, expressJoi(delete_cate_schema), artcate_handler.deleteCateById) 4.4.3 å®ç°åˆ é™¤æ–‡ç« åˆ†ç±»çš„åŠŸèƒ½ å®šä¹‰åˆ é™¤æ–‡ç« åˆ†ç±»çš„ SQL è¯­å¥ï¼š 1const sql = `update ev_article_cate set is_delete=1 where id=?` è°ƒç”¨ db.query() æ‰§è¡Œåˆ é™¤æ–‡ç« åˆ†ç±»çš„ SQL è¯­å¥ï¼š 12345678910db.query(sql, req.params.id, (err, results) =&gt; &#123; // æ‰§è¡Œ SQL è¯­å¥å¤±è´¥ if (err) return res.cc(err) // SQL è¯­å¥æ‰§è¡ŒæˆåŠŸï¼Œä½†æ˜¯å½±å“è¡Œæ•°ä¸ç­‰äº 1 if (results.affectedRows !== 1) return res.cc(&#x27;åˆ é™¤æ–‡ç« åˆ†ç±»å¤±è´¥ï¼&#x27;) // åˆ é™¤æ–‡ç« åˆ†ç±»æˆåŠŸ res.cc(&#x27;åˆ é™¤æ–‡ç« åˆ†ç±»æˆåŠŸï¼&#x27;, 0)&#125;) 4.5 æ ¹æ® Id è·å–æ–‡ç« åˆ†ç±»æ•°æ®4.5.0 å®ç°æ­¥éª¤ å®šä¹‰è·¯ç”±å’Œå¤„ç†å‡½æ•° éªŒè¯è¡¨å•æ•°æ® å®ç°è·å–æ–‡ç« åˆ†ç±»çš„åŠŸèƒ½ 4.5.1 å®šä¹‰è·¯ç”±å’Œå¤„ç†å‡½æ•° åœ¨ /router/artcate.js æ¨¡å—ä¸­ï¼Œæ·»åŠ  æ ¹æ® Id è·å–æ–‡ç« åˆ†ç±» çš„è·¯ç”±ï¼š 1router.get(&#x27;/cates/:id&#x27;, artcate_handler.getArticleById) åœ¨ /router_handler/artcate.js æ¨¡å—ä¸­ï¼Œå®šä¹‰å¹¶å‘å¤–å…±äº« æ ¹æ® Id è·å–æ–‡ç« åˆ†ç±» çš„è·¯ç”±å¤„ç†å‡½æ•°ï¼š 1234// æ ¹æ® Id è·å–æ–‡ç« åˆ†ç±»çš„å¤„ç†å‡½æ•°exports.getArticleById = (req, res) =&gt; &#123; res.send(&#x27;ok&#x27;)&#125; 4.5.2 éªŒè¯è¡¨å•æ•°æ® åœ¨ /schema/artcate.js éªŒè¯è§„åˆ™æ¨¡å—ä¸­ï¼Œä½¿ç”¨ exports å‘å¤–å…±äº«å¦‚ä¸‹çš„ éªŒè¯è§„åˆ™å¯¹è±¡ï¼š 123456// æ ¡éªŒè§„åˆ™å¯¹è±¡ - æ ¹æ® Id è·å–åˆ†ç±»exports.get_cate_schema = &#123; params: &#123; id, &#125;,&#125; åœ¨ /router/artcate.js æ¨¡å—ä¸­ï¼Œå¯¼å…¥éœ€è¦çš„éªŒè¯è§„åˆ™å¯¹è±¡ï¼Œå¹¶åœ¨è·¯ç”±ä¸­ä½¿ç”¨ï¼š 12345// å¯¼å…¥æ ¹æ® Id è·å–åˆ†ç±»çš„éªŒè¯è§„åˆ™å¯¹è±¡const &#123; get_cate_schema &#125; = require(&#x27;../schema/artcate&#x27;)// æ ¹æ® Id è·å–æ–‡ç« åˆ†ç±»çš„è·¯ç”±router.get(&#x27;/cates/:id&#x27;, expressJoi(get_cate_schema), artcate_handler.getArticleById) 4.5.3 å®ç°è·å–æ–‡ç« åˆ†ç±»çš„åŠŸèƒ½ å®šä¹‰æ ¹æ® Id è·å–æ–‡ç« åˆ†ç±»çš„ SQL è¯­å¥ï¼š 1const sql = `select * from ev_article_cate where id=?` è°ƒç”¨ db.query() æ‰§è¡Œ SQL è¯­å¥ï¼š 1234567891011121314db.query(sql, req.params.id, (err, results) =&gt; &#123; // æ‰§è¡Œ SQL è¯­å¥å¤±è´¥ if (err) return res.cc(err) // SQL è¯­å¥æ‰§è¡ŒæˆåŠŸï¼Œä½†æ˜¯æ²¡æœ‰æŸ¥è¯¢åˆ°ä»»ä½•æ•°æ® if (results.length !== 1) return res.cc(&#x27;è·å–æ–‡ç« åˆ†ç±»æ•°æ®å¤±è´¥ï¼&#x27;) // æŠŠæ•°æ®å“åº”ç»™å®¢æˆ·ç«¯ res.send(&#123; status: 0, message: &#x27;è·å–æ–‡ç« åˆ†ç±»æ•°æ®æˆåŠŸï¼&#x27;, data: results[0], &#125;)&#125;) 4.6 æ ¹æ® Id æ›´æ–°æ–‡ç« åˆ†ç±»æ•°æ®4.6.0 å®ç°æ­¥éª¤ å®šä¹‰è·¯ç”±å’Œå¤„ç†å‡½æ•° éªŒè¯è¡¨å•æ•°æ® æŸ¥è¯¢ åˆ†ç±»åç§° ä¸ åˆ†ç±»åˆ«å æ˜¯å¦è¢«å ç”¨ å®ç°æ›´æ–°æ–‡ç« åˆ†ç±»çš„åŠŸèƒ½ 4.6.1 å®šä¹‰è·¯ç”±å’Œå¤„ç†å‡½æ•° åœ¨ /router/artcate.js æ¨¡å—ä¸­ï¼Œæ·»åŠ  æ›´æ–°æ–‡ç« åˆ†ç±» çš„è·¯ç”±ï¼š 12// æ›´æ–°æ–‡ç« åˆ†ç±»çš„è·¯ç”±router.post(&#x27;/updatecate&#x27;, artcate_handler.updateCateById) åœ¨ /router_handler/artcate.js æ¨¡å—ä¸­ï¼Œå®šä¹‰å¹¶å‘å¤–å…±äº« æ›´æ–°æ–‡ç« åˆ†ç±» çš„è·¯ç”±å¤„ç†å‡½æ•°ï¼š 1234// æ›´æ–°æ–‡ç« åˆ†ç±»çš„å¤„ç†å‡½æ•°exports.updateCateById = (req, res) =&gt; &#123; res.send(&#x27;ok&#x27;)&#125; 4.6.2 éªŒè¯è¡¨å•æ•°æ® åœ¨ /schema/artcate.js éªŒè¯è§„åˆ™æ¨¡å—ä¸­ï¼Œä½¿ç”¨ exports å‘å¤–å…±äº«å¦‚ä¸‹çš„ éªŒè¯è§„åˆ™å¯¹è±¡ï¼š 12345678// æ ¡éªŒè§„åˆ™å¯¹è±¡ - æ›´æ–°åˆ†ç±»exports.update_cate_schema = &#123; body: &#123; Id: id, name, alias, &#125;,&#125; åœ¨ /router/artcate.js æ¨¡å—ä¸­ï¼Œå¯¼å…¥éœ€è¦çš„éªŒè¯è§„åˆ™å¯¹è±¡ï¼Œå¹¶åœ¨è·¯ç”±ä¸­ä½¿ç”¨ï¼š 12345// å¯¼å…¥æ›´æ–°æ–‡ç« åˆ†ç±»çš„éªŒè¯è§„åˆ™å¯¹è±¡const &#123; update_cate_schema &#125; = require(&#x27;../schema/artcate&#x27;)// æ›´æ–°æ–‡ç« åˆ†ç±»çš„è·¯ç”±router.post(&#x27;/updatecate&#x27;, expressJoi(update_cate_schema), artcate_handler.updateCateById) 4.5.4 æŸ¥è¯¢åˆ†ç±»åç§°ä¸åˆ«åæ˜¯å¦è¢«å ç”¨ å®šä¹‰æŸ¥é‡çš„ SQL è¯­å¥ï¼š 12// å®šä¹‰æŸ¥è¯¢ åˆ†ç±»åç§° ä¸ åˆ†ç±»åˆ«å æ˜¯å¦è¢«å ç”¨çš„ SQL è¯­å¥const sql = `select * from ev_article_cate where Id&lt;&gt;? and (name=? or alias=?)` è°ƒç”¨ db.query() æ‰§è¡ŒæŸ¥é‡çš„æ“ä½œï¼š 123456789101112// æ‰§è¡ŒæŸ¥é‡æ“ä½œdb.query(sql, [req.body.Id, req.body.name, req.body.alias], (err, results) =&gt; &#123; // æ‰§è¡Œ SQL è¯­å¥å¤±è´¥ if (err) return res.cc(err) // åˆ¤æ–­ åˆ†ç±»åç§° å’Œ åˆ†ç±»åˆ«å æ˜¯å¦è¢«å ç”¨ if (results.length === 2) return res.cc(&#x27;åˆ†ç±»åç§°ä¸åˆ«åè¢«å ç”¨ï¼Œè¯·æ›´æ¢åé‡è¯•ï¼&#x27;) if (results.length === 1 &amp;&amp; results[0].name === req.body.name) return res.cc(&#x27;åˆ†ç±»åç§°è¢«å ç”¨ï¼Œè¯·æ›´æ¢åé‡è¯•ï¼&#x27;) if (results.length === 1 &amp;&amp; results[0].alias === req.body.alias) return res.cc(&#x27;åˆ†ç±»åˆ«åè¢«å ç”¨ï¼Œè¯·æ›´æ¢åé‡è¯•ï¼&#x27;) // TODOï¼šæ›´æ–°æ–‡ç« åˆ†ç±»&#125;) 4.5.5 å®ç°æ›´æ–°æ–‡ç« åˆ†ç±»çš„åŠŸèƒ½ å®šä¹‰æ›´æ–°æ–‡ç« åˆ†ç±»çš„ SQL è¯­å¥ï¼š 1const sql = `update ev_article_cate set ? where Id=?` è°ƒç”¨ db.query() æ‰§è¡Œ SQL è¯­å¥ï¼š 12345678910db.query(sql, [req.body, req.body.Id], (err, results) =&gt; &#123; // æ‰§è¡Œ SQL è¯­å¥å¤±è´¥ if (err) return res.cc(err) // SQL è¯­å¥æ‰§è¡ŒæˆåŠŸï¼Œä½†æ˜¯å½±å“è¡Œæ•°ä¸ç­‰äº 1 if (results.affectedRows !== 1) return res.cc(&#x27;æ›´æ–°æ–‡ç« åˆ†ç±»å¤±è´¥ï¼&#x27;) // æ›´æ–°æ–‡ç« åˆ†ç±»æˆåŠŸ res.cc(&#x27;æ›´æ–°æ–‡ç« åˆ†ç±»æˆåŠŸï¼&#x27;, 0)&#125;) 5. æ–‡ç« ç®¡ç†5.1 æ–°å»º ev_articles è¡¨ 5.2 å‘å¸ƒæ–°æ–‡ç« 5.2.0 å®ç°æ­¥éª¤ åˆå§‹åŒ–è·¯ç”±æ¨¡å— åˆå§‹åŒ–è·¯ç”±å¤„ç†å‡½æ•°æ¨¡å— ä½¿ç”¨ multer è§£æè¡¨å•æ•°æ® éªŒè¯è¡¨å•æ•°æ® å®ç°å‘å¸ƒæ–‡ç« çš„åŠŸèƒ½ 5.2.1 åˆå§‹åŒ–è·¯ç”±æ¨¡å— åˆ›å»º /router/article.js è·¯ç”±æ¨¡å—ï¼Œå¹¶åˆå§‹åŒ–å¦‚ä¸‹çš„ä»£ç ç»“æ„ï¼š 123456789101112// å¯¼å…¥ expressconst express = require(&#x27;express&#x27;)// åˆ›å»ºè·¯ç”±å¯¹è±¡const router = express.Router()// å‘å¸ƒæ–°æ–‡ç« router.post(&#x27;/add&#x27;, (req, res) =&gt; &#123; res.send(&#x27;ok&#x27;)&#125;)// å‘å¤–å…±äº«è·¯ç”±å¯¹è±¡module.exports = router åœ¨ app.js ä¸­å¯¼å…¥å¹¶ä½¿ç”¨æ–‡ç« çš„è·¯ç”±æ¨¡å—ï¼š 1234// å¯¼å…¥å¹¶ä½¿ç”¨æ–‡ç« è·¯ç”±æ¨¡å—const articleRouter = require(&#x27;./router/article&#x27;)// ä¸ºæ–‡ç« çš„è·¯ç”±æŒ‚è½½ç»Ÿä¸€çš„è®¿é—®å‰ç¼€ /my/articleapp.use(&#x27;/my/article&#x27;, articleRouter) 5.2.2 åˆå§‹åŒ–è·¯ç”±å¤„ç†å‡½æ•°æ¨¡å— åˆ›å»º /router_handler/article.js è·¯ç”±å¤„ç†å‡½æ•°æ¨¡å—ï¼Œå¹¶åˆå§‹åŒ–å¦‚ä¸‹çš„ä»£ç ç»“æ„ï¼š 1234// å‘å¸ƒæ–°æ–‡ç« çš„å¤„ç†å‡½æ•°exports.addArticle = (req, res) =&gt; &#123; res.send(&#x27;ok&#x27;)&#125; ä¿®æ”¹ /router/article.js ä¸­çš„ä»£ç å¦‚ä¸‹ï¼š 12345678910const express = require(&#x27;express&#x27;)const router = express.Router()// å¯¼å…¥æ–‡ç« çš„è·¯ç”±å¤„ç†å‡½æ•°æ¨¡å—const article_handler = require(&#x27;../router_handler/article&#x27;)// å‘å¸ƒæ–°æ–‡ç« router.post(&#x27;/add&#x27;, article_handler.addArticle)module.exports = router 5.2.3 ä½¿ç”¨ multer è§£æè¡¨å•æ•°æ® æ³¨æ„ï¼šä½¿ç”¨ express.urlencoded() ä¸­é—´ä»¶æ— æ³•è§£æ multipart/form-data æ ¼å¼çš„è¯·æ±‚ä½“æ•°æ®ã€‚ å½“å‰é¡¹ç›®ï¼Œæ¨èä½¿ç”¨ multer æ¥è§£æ multipart/form-data æ ¼å¼çš„è¡¨å•æ•°æ®ã€‚https://www.npmjs.com/package/multer è¿è¡Œå¦‚ä¸‹çš„ç»ˆç«¯å‘½ä»¤ï¼Œåœ¨é¡¹ç›®ä¸­å®‰è£… multerï¼š 1npm i multer@1.4.2 åœ¨ /router_handler/article.js æ¨¡å—ä¸­å¯¼å…¥å¹¶é…ç½® multerï¼š 1234567// å¯¼å…¥è§£æ formdata æ ¼å¼è¡¨å•æ•°æ®çš„åŒ…const multer = require(&#x27;multer&#x27;)// å¯¼å…¥å¤„ç†è·¯å¾„çš„æ ¸å¿ƒæ¨¡å—const path = require(&#x27;path&#x27;)// åˆ›å»º multer çš„å®ä¾‹å¯¹è±¡ï¼Œé€šè¿‡ dest å±æ€§æŒ‡å®šæ–‡ä»¶çš„å­˜æ”¾è·¯å¾„const upload = multer(&#123; dest: path.join(__dirname, &#x27;../uploads&#x27;) &#125;) ä¿®æ”¹ å‘å¸ƒæ–°æ–‡ç«  çš„è·¯ç”±å¦‚ä¸‹ï¼š 12345// å‘å¸ƒæ–°æ–‡ç« çš„è·¯ç”±// upload.single() æ˜¯ä¸€ä¸ªå±€éƒ¨ç”Ÿæ•ˆçš„ä¸­é—´ä»¶ï¼Œç”¨æ¥è§£æ FormData æ ¼å¼çš„è¡¨å•æ•°æ®// å°†æ–‡ä»¶ç±»å‹çš„æ•°æ®ï¼Œè§£æå¹¶æŒ‚è½½åˆ° req.file å±æ€§ä¸­// å°†æ–‡æœ¬ç±»å‹çš„æ•°æ®ï¼Œè§£æå¹¶æŒ‚è½½åˆ° req.body å±æ€§ä¸­router.post(&#x27;/add&#x27;, upload.single(&#x27;cover_img&#x27;), article_handler.addArticle) åœ¨ /router_handler/article.js æ¨¡å—ä¸­çš„ addArticle å¤„ç†å‡½æ•°ä¸­ï¼Œå°† multer è§£æå‡ºæ¥çš„æ•°æ®è¿›è¡Œæ‰“å°ï¼š 12345678// å‘å¸ƒæ–°æ–‡ç« çš„å¤„ç†å‡½æ•°exports.addArticle = (req, res) =&gt; &#123; console.log(req.body) // æ–‡æœ¬ç±»å‹çš„æ•°æ® console.log(&#x27;--------åˆ†å‰²çº¿----------&#x27;) console.log(req.file) // æ–‡ä»¶ç±»å‹çš„æ•°æ® res.send(&#x27;ok&#x27;)&#125;) 5.2.4 éªŒè¯è¡¨å•æ•°æ® å®ç°æ€è·¯ï¼šé€šè¿‡ express-joi è‡ªåŠ¨éªŒè¯ req.body ä¸­çš„æ–‡æœ¬æ•°æ®ï¼›é€šè¿‡ if åˆ¤æ–­æ‰‹åŠ¨éªŒè¯ req.file ä¸­çš„æ–‡ä»¶æ•°æ®ï¼› åˆ›å»º /schema/article.js éªŒè¯è§„åˆ™æ¨¡å—ï¼Œå¹¶åˆå§‹åŒ–å¦‚ä¸‹çš„ä»£ç ç»“æ„ï¼š 123456789101112131415161718// å¯¼å…¥å®šä¹‰éªŒè¯è§„åˆ™çš„æ¨¡å—const joi = require(&#x27;@hapi/joi&#x27;)// å®šä¹‰ æ ‡é¢˜ã€åˆ†ç±»Idã€å†…å®¹ã€å‘å¸ƒçŠ¶æ€ çš„éªŒè¯è§„åˆ™const title = joi.string().required()const cate_id = joi.number().integer().min(1).required()const content = joi.string().required().allow(&#x27;&#x27;)const state = joi.string().valid(&#x27;å·²å‘å¸ƒ&#x27;, &#x27;è‰ç¨¿&#x27;).required()// éªŒè¯è§„åˆ™å¯¹è±¡ - å‘å¸ƒæ–‡ç« exports.add_article_schema = &#123; body: &#123; title, cate_id, content, state, &#125;,&#125; åœ¨ /router/article.js æ¨¡å—ä¸­ï¼Œå¯¼å…¥éœ€è¦çš„éªŒè¯è§„åˆ™å¯¹è±¡ï¼Œå¹¶åœ¨è·¯ç”±ä¸­ä½¿ç”¨ï¼š 12345678910// å¯¼å…¥éªŒè¯æ•°æ®çš„ä¸­é—´ä»¶const expressJoi = require(&#x27;@escook/express-joi&#x27;)// å¯¼å…¥æ–‡ç« çš„éªŒè¯æ¨¡å—const &#123; add_article_schema &#125; = require(&#x27;../schema/article&#x27;)// å‘å¸ƒæ–°æ–‡ç« çš„è·¯ç”±// æ³¨æ„ï¼šåœ¨å½“å‰çš„è·¯ç”±ä¸­ï¼Œå…ˆåä½¿ç”¨äº†ä¸¤ä¸ªä¸­é—´ä»¶ï¼š// å…ˆä½¿ç”¨ multer è§£æè¡¨å•æ•°æ®// å†ä½¿ç”¨ expressJoi å¯¹è§£æçš„è¡¨å•æ•°æ®è¿›è¡ŒéªŒè¯router.post(&#x27;/add&#x27;, upload.single(&#x27;cover_img&#x27;), expressJoi(add_article_schema), article_handler.addArticle) åœ¨ /router_handler/article.js æ¨¡å—ä¸­çš„ addArticle å¤„ç†å‡½æ•°ä¸­ï¼Œé€šè¿‡ if åˆ¤æ–­å®¢æˆ·ç«¯æ˜¯å¦æäº¤äº† å°é¢å›¾ç‰‡ï¼š 1234567// å‘å¸ƒæ–°æ–‡ç« çš„å¤„ç†å‡½æ•°exports.addArticle = (req, res) =&gt; &#123; // æ‰‹åŠ¨åˆ¤æ–­æ˜¯å¦ä¸Šä¼ äº†æ–‡ç« å°é¢ if (!req.file || req.file.fieldname !== &#x27;cover_img&#x27;) return res.cc(&#x27;æ–‡ç« å°é¢æ˜¯å¿…é€‰å‚æ•°ï¼&#x27;) // TODOï¼šè¡¨å•æ•°æ®åˆæ³•ï¼Œç»§ç»­åé¢çš„å¤„ç†æµç¨‹...&#125;) 5.2.5 å®ç°å‘å¸ƒæ–‡ç« çš„åŠŸèƒ½ æ•´ç†è¦æ’å…¥æ•°æ®åº“çš„æ–‡ç« ä¿¡æ¯å¯¹è±¡ï¼š 12345678910111213// å¯¼å…¥å¤„ç†è·¯å¾„çš„ path æ ¸å¿ƒæ¨¡å—const path = require(&#x27;path&#x27;)const articleInfo = &#123; // æ ‡é¢˜ã€å†…å®¹ã€çŠ¶æ€ã€æ‰€å±çš„åˆ†ç±»Id ...req.body, // æ–‡ç« å°é¢åœ¨æœåŠ¡å™¨ç«¯çš„å­˜æ”¾è·¯å¾„ cover_img: path.join(&#x27;/uploads&#x27;, req.file.filename), // æ–‡ç« å‘å¸ƒæ—¶é—´ pub_date: new Date(), // æ–‡ç« ä½œè€…çš„Id author_id: req.user.id,&#125; å®šä¹‰å‘å¸ƒæ–‡ç« çš„ SQL è¯­å¥ï¼š 1const sql = `insert into ev_articles set ?` è°ƒç”¨ db.query() æ‰§è¡Œå‘å¸ƒæ–‡ç« çš„ SQL è¯­å¥ï¼š 1234567891011121314// å¯¼å…¥æ•°æ®åº“æ“ä½œæ¨¡å—const db = require(&#x27;../db/index&#x27;)// æ‰§è¡Œ SQL è¯­å¥db.query(sql, articleInfo, (err, results) =&gt; &#123; // æ‰§è¡Œ SQL è¯­å¥å¤±è´¥ if (err) return res.cc(err) // æ‰§è¡Œ SQL è¯­å¥æˆåŠŸï¼Œä½†æ˜¯å½±å“è¡Œæ•°ä¸ç­‰äº 1 if (results.affectedRows !== 1) return res.cc(&#x27;å‘å¸ƒæ–‡ç« å¤±è´¥ï¼&#x27;) // å‘å¸ƒæ–‡ç« æˆåŠŸ res.cc(&#x27;å‘å¸ƒæ–‡ç« æˆåŠŸ&#x27;, 0)&#125;) åœ¨ app.js ä¸­ï¼Œä½¿ç”¨ express.static() ä¸­é—´ä»¶ï¼Œå°† uploads ç›®å½•ä¸­çš„å›¾ç‰‡æ‰˜ç®¡ä¸ºé™æ€èµ„æºï¼š 12// æ‰˜ç®¡é™æ€èµ„æºæ–‡ä»¶app.use(&#x27;/uploads&#x27;, express.static(&#x27;./uploads&#x27;))","categories":[],"tags":[]},{"title":"Hello World","slug":"hello-world","date":"2024-09-28T13:04:35.234Z","updated":"2024-09-28T13:04:35.234Z","comments":true,"path":"2024/09/28/hello-world/","permalink":"http://eastyn7.github.io/2024/09/28/hello-world/","excerpt":"","text":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new &quot;My New Post&quot; More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment","categories":[],"tags":[]},{"title":"HEXOæ­å»ºåšå®¢å¹³å°","slug":"åˆ©ç”¨HEXOæ­æ­å»ºè‡ªå·±çš„åšå®¢","date":"2024-09-28T12:58:51.580Z","updated":"2024-09-29T13:11:17.384Z","comments":true,"path":"2024/09/28/åˆ©ç”¨HEXOæ­æ­å»ºè‡ªå·±çš„åšå®¢/","permalink":"http://eastyn7.github.io/2024/09/28/%E5%88%A9%E7%94%A8HEXO%E6%90%AD%E6%90%AD%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84%E5%8D%9A%E5%AE%A2/","excerpt":"","text":"HEXOæ­å»ºåšå®¢å¹³å°æœ¬æœºç¯å¢ƒ Win11 node.jsï¼š18.17.0 npmï¼š10.8.2 å®‰è£…ä¸‹è½½hexo1npm install -g hexo-cli hexo -v éªŒè¯å¹¶æŸ¥çœ‹ç‰ˆæœ¬ åˆ›å»ºé¡¹ç›®æ–‡ä»¶å¤¹1hexo init myblog å®‰è£…12cd myblognpm install å¯åŠ¨æœåŠ¡12hexo ghexo server åœ¨GitHubåˆ›å»ºä»“åº“å®‰è£…hexoä¸Šä¼ æ’ä»¶1npm install hexo-deployer-git --save ä¿®æ”¹hexoé…ç½®æ–‡ä»¶æŒ‡å®šä»“åº“è·¯å¾„åœ¨æ–‡ä»¶å¤¹ä¸­ç›´æ¥æ‰“å¼€_config.ymlæ–‡ä»¶ä¿®æ”¹ deploy: â€‹ type: git â€‹ repo : gitåœ°å€ â€‹ branch: master æ¨é€åˆ°GitHub1hexo d è·Ÿæ–°å®Œ æ¸…ç†ï¼šhexo clean æ„å»ºï¼šhexo g ä¸Šä¼ ï¼šhexo d","categories":[],"tags":[]},{"title":"é’é˜Ÿäº‘å¹³å°å¼€å‘","slug":"é’é˜Ÿäº‘å¹³å°å¼€å‘æ–‡æ¡£","date":"2024-09-04T15:00:04.749Z","updated":"2024-10-15T15:41:44.517Z","comments":true,"path":"2024/09/04/é’é˜Ÿäº‘å¹³å°å¼€å‘æ–‡æ¡£/","permalink":"http://eastyn7.github.io/2024/09/04/%E9%9D%92%E9%98%9F%E4%BA%91%E5%B9%B3%E5%8F%B0%E5%BC%80%E5%8F%91%E6%96%87%E6%A1%A3/","excerpt":"","text":"é’é˜Ÿäº‘å¹³å°å¼€å‘æ–‡æ¡£ğŸ’•å¯åŠ¨æ—¶é—´ï¼š2024.09.04 é¡¹ç›®æ¦‚è¿°èƒŒæ™¯éšç€å¿—æ„¿æœåŠ¡åœ¨é«˜æ ¡ä¸­çš„è“¬å‹ƒå‘å±•ï¼Œâ€œå°çº¢å¸½â€å¸¸é’è—¤é’å¹´å¿—æ„¿è€…æœåŠ¡é˜Ÿã€ä»¥ä¸‹ç®€ç§°é’é˜Ÿã€‘é€æ¸æˆä¸ºå­¦é™¢å†…å¤–å„ç±»å…¬ç›Šæ´»åŠ¨çš„é‡è¦ç»„ç»‡è€…ã€‚ä½œä¸ºä¸€ä¸ªç”±çƒ­å¿ƒé’å¹´å­¦ç”Ÿç»„æˆçš„å¿—æ„¿è€…é˜Ÿä¼ï¼Œæˆ‘ä»¬çš„æˆå‘˜åœ¨å¤šä¸ªé¢†åŸŸç§¯æå‚ä¸ï¼Œå±•ç°äº†è‰¯å¥½çš„ç²¾ç¥é£è²Œå’Œç¤¾ä¼šè´£ä»»æ„Ÿã€‚ä¸ºäº†æ›´å¥½åœ°æå‡æœåŠ¡é˜Ÿçš„å†…éƒ¨ç®¡ç†å’Œå¯¹å¤–å®£ä¼ ï¼Œæˆ‘ä»¬å¸Œæœ›é€šè¿‡å¼€å‘ä¸€ä¸ªå†…éƒ¨ç®¡ç†å’Œå±•ç¤ºå¹³å°ï¼Œå¼ºåŒ–é˜Ÿä¼å‡èšåŠ›å’Œæˆå‘˜å½’å±æ„Ÿï¼ŒåŒæ—¶å‘å…¬ä¼—å±•ç¤ºæˆ‘ä»¬çš„æˆæœå’Œç²¾ç¥é£è²Œã€‚ å½“å‰é—®é¢˜å’ŒæŒ‘æˆ˜1ã€é˜Ÿä¼å½¢è±¡å±•ç¤ºä¸è¶³ï¼šæœåŠ¡é˜Ÿåœ¨å­¦é™¢å’Œç¤¾ä¼šä¸Šçš„å½±å“åŠ›æœ‰é™ï¼Œç¼ºä¹ä¸€ä¸ªé›†ä¸­å±•ç¤ºæœåŠ¡é˜Ÿå†å²ã€æˆå°±å’Œæ´»åŠ¨çš„çª—å£ï¼Œä½¿å¤–ç•Œéš¾ä»¥å……åˆ†äº†è§£æˆ‘ä»¬çš„å›¢é˜Ÿæ–‡åŒ–å’Œæ ¸å¿ƒä»·å€¼è§‚ã€‚ 2ã€ä¿¡æ¯å‘å¸ƒä¸åŠæ—¶ï¼šå½“å‰æ´»åŠ¨å’Œå†…éƒ¨ä¿¡æ¯çš„å‘å¸ƒä¸»è¦ä¾èµ–äºå¾®ä¿¡ç¾¤ã€QQç¾¤ç­‰éé›†ä¸­åŒ–æ¸ é“ï¼Œå®¹æ˜“å¯¼è‡´ä¿¡æ¯é—æ¼æˆ–ä¼ æ’­ä¸åŠæ—¶ï¼Œå½±å“æ´»åŠ¨çš„å‚ä¸ç‡å’Œå›¢é˜Ÿæ²Ÿé€šæ•ˆç‡ã€‚ 3ã€å¿—æ„¿ç²¾ç¥ä¼ é€’ä¸è¶³ï¼šåœ¨æå‡æˆå‘˜å¿—æ„¿æœåŠ¡ç²¾ç¥ã€æŠ€èƒ½åŸ¹è®­å’Œç»éªŒåˆ†äº«æ–¹é¢ç¼ºå°‘æœ‰æ•ˆçš„å·¥å…·å’Œæ‰‹æ®µï¼Œéš¾ä»¥ä¸ºæ–°æˆå‘˜æä¾›ç³»ç»Ÿæ€§çš„æˆé•¿è·¯å¾„å’Œæ”¯æŒã€‚ é¡¹ç›®ç›®æ ‡æœ¬é¡¹ç›®æ—¨åœ¨ä¸ºé’é˜Ÿå¼€å‘ä¸€ä¸ªä¸“å±çš„äº‘å¹³å°ï¼Œä»¥è§£å†³ä»¥ä¸Šé—®é¢˜ï¼Œå¹¶å®ç°ä»¥ä¸‹ç›®æ ‡ï¼š 1ã€å±•ç¤ºé˜Ÿä¼å½¢è±¡å’Œæˆå°±ï¼šé€šè¿‡å¹³å°å±•ç¤ºæœåŠ¡é˜Ÿçš„å†å²ã€å›¢é˜Ÿæ–‡åŒ–ã€æ´»åŠ¨æˆæœå’Œä¼˜ç§€é˜Ÿå‘˜çš„é£é‡‡ï¼ŒåŠ å¼ºå…¬ä¼—å¯¹æœåŠ¡é˜Ÿçš„è®¤è¯†å’Œæ”¯æŒã€‚ 2ã€æå‡ä¿¡æ¯å‘å¸ƒå’Œæ²Ÿé€šæ•ˆç‡ï¼šé€šè¿‡å¹³å°å‘å¸ƒå…¬å‘Šã€æ´»åŠ¨é¢„å‘Šå’Œå†…éƒ¨ä¿¡æ¯ï¼Œç¡®ä¿æˆå‘˜èƒ½å¤ŸåŠæ—¶è·å–æœ€æ–°ä¿¡æ¯ï¼Œæå‡é˜Ÿå†…æ²Ÿé€šæ•ˆç‡ã€‚ 3ã€ä¿ƒè¿›å¿—æ„¿ç²¾ç¥ä¼ æ’­ä¸æˆé•¿ï¼šæä¾›å¿—æ„¿è€…å­¦ä¹ èµ„æºã€ç»éªŒåˆ†äº«å’ŒåŸ¹è®­æ”¯æŒï¼Œå¸®åŠ©æˆå‘˜æˆé•¿ï¼Œå¹¶æœ‰æ•ˆä¼ æ’­å¿—æ„¿æœåŠ¡ç²¾ç¥ã€‚ æ•°æ®åº“è®¾è®¡ç”¨æˆ·ç™»å½•ä¿¡æ¯è¡¨ï¼ˆuser_auth)1234567891011CREATE TABLE `user_login` ( `auth_id` int NOT NULL AUTO_INCREMENT COMMENT &#x27;è®¤è¯ID&#x27;, `student_id` varchar(10) NOT NULL COMMENT &#x27;å­¦å·&#x27;, `email` varchar(50) NOT NULL COMMENT &#x27;é‚®ç®±ï¼Œè¦æ±‚@ctbu.edu.cnç»“å°¾&#x27;, `password_hash` varchar(255) NOT NULL COMMENT &#x27;å¯†ç å“ˆå¸Œå€¼&#x27;, `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT &#x27;è´¦å·åˆ›å»ºæ—¶é—´&#x27;, `updated_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT &#x27;æœ€åæ›´æ–°æ—¶é—´&#x27;, PRIMARY KEY (`auth_id`), UNIQUE KEY `unique_email` (`email`), UNIQUE KEY `unique_student_id` (`student_id`)); è§¦å‘å™¨ æ³¨å†Œæ—¶åŒæ­¥åˆ›å»ºä¸€ä¸ªæ–°çš„ç”¨æˆ·ä¿¡æ¯ 12345BEGIN -- æ’å…¥åˆ° user_info ä¸­ï¼Œå¹¶å°† username è®¾ç½®ä¸º student_id INSERT INTO `user_info` (auth_id, username) VALUES (NEW.auth_id, NEW.student_id);END ç”¨æˆ·è¯¦ç»†ä¿¡æ¯è¡¨(user_info)12345678910111213CREATE TABLE `user_info` ( `auth_id` int NOT NULL COMMENT &#x27;å…³è”è®¤è¯è¡¨çš„å¤–é”®&#x27;, `role` tinyint NOT NULL DEFAULT &#x27;0&#x27; COMMENT &#x27;ç”¨æˆ·è§’è‰²ï¼ˆ0=æ™®é€šç”¨æˆ·, 1=è¶…çº§ç®¡ç†å‘˜, 2=æ™®é€šç®¡ç†å‘˜ï¼‰&#x27;, `nickname` varchar(64) DEFAULT NULL COMMENT &#x27;ç”¨æˆ·å&#x27;, `username` varchar(18) DEFAULT NULL COMMENT &#x27;çœŸå®å§“å&#x27;, `gender` tinyint NOT NULL DEFAULT &#x27;0&#x27; COMMENT &#x27;æ€§åˆ«ï¼ˆ0=æœªæŒ‡å®š, 1=ç”·, 2=å¥³ï¼‰&#x27;, `avatar` varchar(255) DEFAULT NULL COMMENT &#x27;å¤´åƒURL&#x27;, `phone` varchar(11) DEFAULT NULL COMMENT &#x27;æ‰‹æœºå·&#x27;, `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT &#x27;åˆ›å»ºæ—¶é—´&#x27;, `updated_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT &#x27;æ›´æ–°æ—¶é—´&#x27;, PRIMARY KEY (`auth_id`), CONSTRAINT `user_info_ibfk_1` FOREIGN KEY (`auth_id`) REFERENCES `user_login` (`auth_id`) ON DELETE CASCADE); åŠŸèƒ½è®¾è®¡é¦–é¡µï¼ˆ&#x2F;homeï¼‰ è½®æ’­å›¾ å°å…¬å‘Š é˜Ÿå¾½é˜Ÿå åŠŸèƒ½å®«æ ¼ã€æ ¡å›­æœåŠ¡é€šã€çˆ±å¿ƒé›¨ä¼ã€æœåŠ¡é˜Ÿæ´»åŠ¨é£é‡‡ã€å¿—æ„¿æ´»åŠ¨æŠ¥åã€å…³äºé’é˜Ÿã€ç”¨æˆ·æ„è§åé¦ˆã€‘ ä¸ªäººä¸­å¿ƒï¼ˆ&#x2F;userï¼‰ æœªç™»å½•æƒ…å†µ é»˜è®¤ç™»å½•æ ï¼ˆé»˜è®¤å¤´åƒã€ç‚¹å‡»ç™»å½•ï¼‰ é€‰æ‹©åˆ—è¡¨ï¼ˆä¸ªäººèµ„æ–™ã€æƒé™ç”³è¯·ã€ä½¿ç”¨æŒ‡å—ã€è®¾ç½®ï¼‰ã€éœ€è¦ç™»å½•ä¹‹åæ‰èƒ½ç‚¹å‡»ä½¿ç”¨ã€‘ å·²ç™»å½•æƒ…å†µ å·²ç™»å½•çŠ¶æ€æ ï¼ˆç™»å½•å¤´åƒã€åç§°ï¼‰ é€‰æ‹©åˆ—è¡¨ï¼ˆä¸ªäººèµ„æ–™ã€æƒé™ç”³è¯·ï¼ˆå®¡æ ¸ï¼‰ã€?åå°ç®¡ç†ã€ä½¿ç”¨æŒ‡å—ã€è®¾ç½®ï¼‰ å…³äºé’é˜Ÿï¼ˆAbout Usï¼‰å‰ç«¯å¼€å‘åˆ›å»ºå‰ç«¯é¡¹ç›®1pnpm create vue é…ç½®Vantæ·»åŠ vant 1pnpm add vant å®‰è£…è‡ªåŠ¨å¯¼å…¥æ’ä»¶ 1pnpm add @vant/auto-import-resolver unplugin-vue-components unplugin-auto-import -D é…ç½®è‡ªåŠ¨å¯¼å…¥ 1234567891011121314151617181920212223242526import &#123; fileURLToPath, URL &#125; from &#x27;node:url&#x27;import &#123; defineConfig &#125; from &#x27;vite&#x27;import vue from &#x27;@vitejs/plugin-vue&#x27;import AutoImport from &#x27;unplugin-auto-import/vite&#x27;;import Components from &#x27;unplugin-vue-components/vite&#x27;;import &#123; VantResolver &#125; from &#x27;@vant/auto-import-resolver&#x27;;// https://vitejs.dev/config/export default defineConfig(&#123; plugins: [ vue(), AutoImport(&#123; // vantæŒ‰éœ€å¯¼å…¥ resolvers: [VantResolver()], &#125;), Components(&#123; resolvers: [VantResolver()], &#125;) ], resolve: &#123; alias: &#123; &#x27;@&#x27;: fileURLToPath(new URL(&#x27;./src&#x27;, import.meta.url)) &#125; &#125;&#125;) é…ç½®è‡ªåŠ¨å¯¼å…¥å’Œç»„ä»¶1234567891011121314151617181920212223242526272829AutoImport(&#123; include: [ /\\.[tj]sx?$/, // .ts, .tsx, .js, .jsx /\\.vue$/, /\\.vue\\?vue/, // .vue /\\.md$/ // .md ], imports: [&#x27;vue&#x27;, &#x27;vue-router&#x27;, &#x27;pinia&#x27;], // é…ç½®å¯¼å‡ºçš„æ–‡ä»¶ dts: &#x27;src/auto-import.d.ts&#x27;, // vueã€vue-router tsç±»å‹å¯¼å‡ºä½ç½® // vantæŒ‰éœ€å¯¼å…¥ resolvers: [VantResolver()], // eslint é…ç½® eslintrc: &#123; enabled: true, // å½“é…ç½® enabled: true æ—¶ï¼Œä¼šæ ¹æ® filepath é…ç½®çš„è·¯å¾„ç”Ÿæˆä¸€ä¸ª .eslintrc-auto-import.json æ–‡ä»¶ filepath: &#x27;src/.eslintrc-auto-import.json&#x27;, globalsPropValue: true &#125; &#125;), Components(&#123; // æœç´¢å­ç›®å½• deep: true, // ç»„ä»¶æœ‰æ•ˆçš„æ‰©å±•å extensions: [&#x27;vue&#x27;, &#x27;js&#x27;, &#x27;jsx&#x27;, &#x27;ts&#x27;, &#x27;tsx&#x27;, &#x27;.mjs&#x27;], include: [/\\.vue$/, /\\.vue\\?vue/, /\\.js$/, /\\.jsx$/, /\\.ts$/, /\\.tsx$/], resolvers: [VantResolver()], dirs: [&#x27;src/components&#x27;], dts: &#x27;src/components.d.ts&#x27;, directives: true &#125;) é…ç½®Eslintå’ŒPrettier123456789101112131415161718192021rules: &#123; &#x27;prettier/prettier&#x27;: [ &#x27;warn&#x27;, &#123; singleQuote: true, semi: false, printWidth: 100, trailingComma: &#x27;none&#x27;, endOfLine: &#x27;auto&#x27; &#125; ], &#x27;vue/multi-word-component-names&#x27;: [ &#x27;warn&#x27;, &#123; ignores: [&#x27;index&#x27;] &#125; ], &#x27;vue/no-setup-props-destructure&#x27;: [&#x27;off&#x27;] // &#x27;no-undef&#x27;: &#x27;error&#x27;&#125; é…ç½®Viewportå®‰è£…æ’ä»¶ 1pnpm install postcss-px-to-viewport -D é…ç½® 12345678910111213141516171819/* eslint-env node */// postcss.config.cjsmodule.exports = &#123; plugins: &#123; &#x27;postcss-px-to-viewport&#x27;: &#123; uniToConvert: &#x27;px&#x27;, // éœ€è¦è½¬æ¢çš„å•ä½ &#x27;é»˜è®¤px&#x27; viewportWidth: 375, // è®¾è®¡ç¨¿çš„è§†å£å®½åº¦ unitPrecision: 5, // å•ä½è½¬æ¢åä¿ç•™çš„å°æ•°ä½æ•° proList: [&#x27;*&#x27;], // è¦è¿›è¡Œè½¬æ¢çš„å±æ€§åˆ—è¡¨ ,*è¡¨ç¤ºåŒ¹é…æ‰€æœ‰ viewportUnit: &#x27;vw&#x27;, // è½¬æ¢åçš„è§†å£å•ä½ selectorBlackList: [&#x27;.ignore&#x27;, &#x27;.hairlines&#x27;], // ä¸è½¬æ¢çš„é€‰æ‹©å™¨åˆ—è¡¨ fontViewportUnit: &#x27;vw&#x27;, // è½¬æ¢åå­—ä½“ä½¿ç”¨çš„è§†å£å•ä½ minPixelValue: 1, // è®¾ç½®æœ€å°çš„è½¬æ¢æ•°å€¼ replace: true, // æ˜¯å¦ç›´æ¥è½¬åŒ–è€Œä¸æ·»åŠ å¤‡ç”¨å±æ€§ mediaQuery: true, // æ˜¯å¦å…è®¸åœ¨åª’ä½“æŸ¥è¯¢ä¸­è½¬æ¢ exclude: [/node_modules/] // å¿½ç•¥æŸäº›æ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶ &#125;, &#125;,&#125;; é…ç½®Axioså®‰è£…Axios 1pnpm add axios é…ç½®Requestæ–‡ä»¶ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970import axios from &#x27;axios&#x27;import type &#123; InternalAxiosRequestConfig &#125; from &#x27;axios&#x27;import &#123; getLocalData, removeLocalData, isLogin &#125; from &#x27;@/utils/util&#x27;// è‡ªå®šä¹‰è¯·æ±‚é…ç½®æ¥å£ï¼Œæ‰©å±•äº† Axios çš„é…ç½®é€‰é¡¹ï¼Œå¢åŠ äº† needToken å±æ€§interface CustomRequestConfig extends InternalAxiosRequestConfig &#123; needToken?: boolean // æ ‡è¯†è¯·æ±‚æ˜¯å¦éœ€è¦æºå¸¦Token&#125;// åˆ›å»ºaxioså®ä¾‹ï¼Œå¹¶è®¾ç½®åŸºç¡€é…ç½®const http = axios.create(&#123; baseURL: import.meta.env.VITE_BASE_URL, // APIçš„åŸºç¡€URLï¼Œä½¿ç”¨Viteçš„ç¯å¢ƒå˜é‡æ¥è®¾ç½® timeout: 10000 // è¯·æ±‚è¶…æ—¶æ—¶é—´ä¸º10ç§’&#125;)// è¯·æ±‚æ‹¦æˆªå™¨ï¼šåœ¨è¯·æ±‚å‘é€ä¹‹å‰åšä¸€äº›å¤„ç†http.interceptors.request.use( (config: CustomRequestConfig) =&gt; &#123; // åˆ¤æ–­å½“å‰è¯·æ±‚æ˜¯å¦éœ€è¦Token if (config.needToken) &#123; // æ£€æŸ¥æ˜¯å¦å·²ç™»å½• if (isLogin()) &#123; // ä»æœ¬åœ°å­˜å‚¨ä¸­è·å–ç”¨æˆ·ä¿¡æ¯ const userinfo = getLocalData(&#x27;userinfo&#x27;) if (userinfo) &#123; // å¦‚æœç”¨æˆ·ä¿¡æ¯å­˜åœ¨ï¼Œå°†Tokenæ·»åŠ åˆ°è¯·æ±‚å¤´ä¸­ config.headers[&#x27;Authorization&#x27;] = `Bearer $&#123;userinfo.sk&#125;` // sk ä¸ºç”¨æˆ·å¯†é’¥å­—æ®µ &#125; &#125; // å¦‚æœç”¨æˆ·æœªç™»å½•ï¼Œä½†æœ¬åœ°æœ‰Tokenè¿‡æœŸæ—¶é—´ else if (getLocalData(&#x27;token_expires_at&#x27;)) &#123; // ç§»é™¤è¿‡æœŸçš„ç”¨æˆ·ä¿¡æ¯å’ŒToken removeLocalData(&#x27;userinfo&#x27;) removeLocalData(&#x27;token_expires_at&#x27;) // æç¤ºç”¨æˆ·ç™»å½•å·²è¿‡æœŸ showFailToast(&#x27;ç™»å½•å·²è¿‡æœŸï¼Œè¯·é‡æ–°ç™»å½•&#x27;) &#125; // ç”¨æˆ·æœªç™»å½•ä¸”æ²¡æœ‰è¿‡æœŸçš„Token else &#123; // æç¤ºç”¨æˆ·å…ˆç™»å½• showFailToast(&#x27;è¯·å…ˆç™»å½•&#x27;) &#125; &#125; // ä¸ºæ‰€æœ‰è¯·æ±‚è®¾ç½®è¯·æ±‚å¤´ï¼ŒæŒ‡å®šè¯·æ±‚å†…å®¹ç±»å‹ä¸ºx-www-form-urlencoded config.headers[&#x27;Content-Type&#x27;] = &#x27;application/x-www-form-urlencoded&#x27; // è¿”å›å¤„ç†åçš„è¯·æ±‚é…ç½® return config &#125;, (error) =&gt; &#123; // å¦‚æœè¯·æ±‚å‘ç”Ÿé”™è¯¯ï¼Œç›´æ¥è¿”å›é”™è¯¯ return Promise.reject(error) &#125;)// å“åº”æ‹¦æˆªå™¨ï¼šåœ¨å“åº”è¿”å›ä¹‹ååšä¸€äº›å¤„ç†http.interceptors.response.use( (response) =&gt; &#123; // åªè¿”å›å“åº”çš„dataéƒ¨åˆ†ï¼Œç®€åŒ–åç»­è°ƒç”¨çš„æ•°æ®å¤„ç† return response.data &#125;, (error) =&gt; &#123; // å¦‚æœå“åº”å‘ç”Ÿé”™è¯¯ï¼Œè¿”å›é”™è¯¯ return Promise.reject(error) &#125;)// å¯¼å‡ºå¤„ç†å¥½çš„ http å®ä¾‹export default http é…ç½®Piniaå®‰è£…æ’ä»¶ 1pnpm add pinia-plugin-persistedstate -D åœ¨ä»“åº“ä¸­å¯¼å…¥ 123456789101112131415import &#123; createPinia &#125; from &#x27;pinia&#x27;import persist from &#x27;pinia-plugin-persistedstate&#x27;const pinia = createPinia()pinia.use(persist)import &#123; useCounterStore &#125; from &#x27;./counter&#x27; // ä¸¾ä¾‹å¯¼å…¥export default piniaexport const useStore = () =&gt; &#123; return &#123; counter: useCounterStore() &#125;&#125; é…ç½®Vantåº•éƒ¨å®‰å…¨åŒºé€‚é…123/* index.html */&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, viewport-fit=cover&quot;/&gt;&lt;link rel=&quot;stylesheet&quot; href=&quot;./css/viewportFit.css&quot;&gt; 12345678/* viewportFit.css *//* é€‚é… iphone åº•éƒ¨å®‰å…¨åŒºï¼ˆæŒ‡ç¤ºæ¡ï¼Œé…åˆindex.html &lt;meta name=&quot;viewport&quot; ... /&gt;ä½¿ç”¨ */@supports (bottom: env(safe-area-inset-bottom))&#123; #app &#123; padding-bottom: constant(safe-area-inset-bottom);/* å…¼å®¹ios&lt;11.2 */ padding-bottom: env(safe-area-inset-bottom);/* å…¼å®¹ios&gt;=11.2 */ &#125;&#125; é…ç½®å…¨å±€æ ·å¼1234567891011121314151617181920212223242526/* src/styles/index.css */#app &#123; max-width: 1280px; margin: 0 auto; padding: 0.5rem; font-weight: normal;&#125;html &#123; line-height: 1.2;&#125;body &#123; background-color: rgba(194, 194, 194, 0.131); font-family: &#x27;KaiTi&#x27;, &#x27;æ¥·ä½“&#x27;, &#x27;STKaiti&#x27;, &#x27;SimSun&#x27;, &#x27;é»‘ä½“&#x27;, &#x27;Heiti SC&#x27;, &#x27;Arial&#x27;, sans-serif; color: #3e3e3e; margin: 0; padding: 0; box-sizing: border-box;&#125;h1, h2, h3, h4, h5, h6 &#123; color: #222; font-family: &#x27;KaiTi&#x27;, &#x27;æ¥·ä½“&#x27;;&#125; é…ç½®è·¯ç”±1234567891011121314151617181920212223242526272829303132import &#123; createRouter, createWebHashHistory &#125; from &#x27;vue-router&#x27;import indexRoutes from &#x27;./routes&#x27;const router = createRouter(&#123; history: createWebHashHistory(), routes: [ &#123; path: &#x27;/&#x27;, redirect: &#x27;/home&#x27;, children: [ &#123; path: &#x27;/home&#x27;, name: &#x27;Home&#x27;, component: () =&gt; import(&#x27;@/views/Home/HomeView.vue&#x27;) &#125;, &#123; path: &#x27;/user&#x27;, name: &#x27;User&#x27;, component: () =&gt; import(&#x27;@/views/User/UserView.vue&#x27;) &#125;, &#123; path: &#x27;/notice&#x27;, name: &#x27;Notice&#x27;, component: () =&gt; import(&#x27;@/views/Notice/NoticeView.vue&#x27;) &#125; ] &#125;, ...indexRoutes //åŸºç¡€åŠŸèƒ½é¡µé¢ ]&#125;)export default router å…¶ä»–è·¯ç”± 1234567891011121314151617181920212223242526272829303132333435/* indexRoutes.ts */const routes = [ &#123; path: &#x27;/campusservice&#x27;, name: &#x27;CampusService&#x27;, component: () =&gt; import(&#x27;@/views/CampusService/CampusService.vue&#x27;) &#125;, &#123; path: &#x27;/loveumbrella&#x27;, name: &#x27;LoveUmbrella&#x27;, component: () =&gt; import(&#x27;@/views/LoveUmbrella/LoveUmbrella.vue&#x27;) &#125;, &#123; path: &#x27;/activities&#x27;, name: &#x27;Activities&#x27;, component: () =&gt; import(&#x27;@/views/Activities/Activities.vue&#x27;) &#125;, &#123; path: &#x27;/signup&#x27;, name: &#x27;SignUp&#x27;, component: () =&gt; import(&#x27;@/views/SignUp/SignUp.vue&#x27;) &#125;, &#123; path: &#x27;/aboutus&#x27;, name: &#x27;AboutUs&#x27;, component: () =&gt; import(&#x27;@/views/AboutUs/AboutUs.vue&#x27;) &#125;, &#123; path: &#x27;/feedback&#x27;, name: &#x27;Feedback&#x27;, component: () =&gt; import(&#x27;@/views/Feedback/Feedback.vue&#x27;) &#125;]export default routes é…ç½®é˜¿é‡Œå›¾æ ‡ åœ¨é˜¿é‡Œå›¾æ ‡å®˜ç½‘åˆ›å»ºé¡¹ç›®ï¼Œå¹¶å°†é€‰å¥½çš„å›¾æ ‡ä¿å­˜åˆ°é¡¹ç›®ä¸­ï¼Œå†å°†é¡¹ç›®ä¸‹è½½ä¸‹æ¥ æŠŠä¸‹è½½çš„é¡¹ç›®ä¸­çš„æ–‡ä»¶ï¼ˆé™¤äº†demo.csså’Œdemo_index.htmlæ–‡ä»¶ï¼‰ä¿å­˜è‡³è¯¥é¡¹ç›®ä¸­ åœ¨main.tsä¸­å¯¼å…¥iconfont.cssæ–‡ä»¶ åœ¨é¡¹ç›®ä¸­ä½¿ç”¨icon=&quot; icon-great-activities&quot; icon-prefix=&quot;iconfont&quot;ã€éœ€è¦æ³¨æ„çš„æ˜¯å›¾æ ‡ç±»åå‰å¿…é¡»åŠ ä¸€ä¸ªç©ºæ ¼ã€‘ App.vue12345678910111213141516171819202122232425262728293031323334&lt;script setup lang=&quot;ts&quot;&gt;const route = useRoute()&lt;/script&gt;&lt;template&gt; &lt;div class=&quot;layout&quot;&gt; &lt;router-view&gt;&lt;/router-view&gt; &lt;van-tabbar route v-if=&quot;[&#x27;/&#x27;, &#x27;/home&#x27;, &#x27;/notice&#x27;, &#x27;/user&#x27;].includes(route.path)&quot; active-color=&quot;#1989fa&quot; inactive-color=&quot;#000&quot; placeholder &gt; &lt;van-tabbar-item replace to=&quot;/home&quot; icon=&quot;home-o&quot;&gt; é¦–é¡µ &lt;/van-tabbar-item&gt; &lt;!-- è¿™é‡Œçš„`dot`çº¢ç‚¹é€šè¿‡åˆ¤æ–­æ˜¯å¦æœ‰æ–°æ›´æ–°çš„é€šçŸ¥æ¥æ§åˆ¶ --&gt; &lt;van-tabbar-item replace to=&quot;/notice&quot; icon=&quot;chat-o&quot; :dot=&quot;false&quot;&gt; é€šçŸ¥ &lt;/van-tabbar-item&gt; &lt;van-tabbar-item replace to=&quot;/user&quot; icon=&quot;user-o&quot;&gt; ä¸ªäººä¸­å¿ƒ &lt;/van-tabbar-item&gt; &lt;/van-tabbar&gt; &lt;/div&gt;&lt;/template&gt;&lt;style scoped&gt;.van-tabbar-item &#123; background-color: rgb(255, 255, 255);&#125;&lt;/style&gt; é¦–é¡µ123456789101112131415161718192021&lt;script setup lang=&quot;ts&quot;&gt;// å®šä¹‰ä¸€ä¸ªå“åº”å¼çš„æ–‡æœ¬å˜é‡ï¼Œéœ€è¦é€šè¿‡åç«¯æ¥æ§åˆ¶æ–‡æœ¬å†…å®¹ï¼Œç»„ä»¶æŒ‚è½½ï¼ˆonMountedï¼‰æ—¶axioså‘è¯·æ±‚const notification = ref&lt;string&gt;(&#x27;å†…å®¹å¾…ç®¡ç†å‘˜æ›´æ–°...&#x27;)&lt;/script&gt;&lt;template&gt; &lt;div class=&quot;home-layout&quot;&gt; &lt;!-- è½®æ’­å›¾ --&gt; &lt;HomeSwipe /&gt; &lt;!-- å°å…¬å‘Š --&gt; &lt;HomeNoticeBar :notification=&quot;notification&quot; /&gt; &lt;!-- é˜Ÿå¾½é˜Ÿå --&gt; &lt;HomeTeamName /&gt; &lt;!-- åŠŸèƒ½è¡¨ --&gt; &lt;HomeGrid /&gt; &lt;!-- åº•çº¿ --&gt; &lt;Divider dividerText=&quot;æš‚æ—¶æ²¡æœ‰æ›´å¤šåŠŸèƒ½&quot; /&gt; &lt;/div&gt;&lt;/template&gt;&lt;style scoped&gt;&lt;/style&gt; é¦–é¡µ-è½®æ’­å›¾ å›¾ç‰‡æ›´æ–°éœ€è¦æ”¹æˆåç«¯æ›´æ–°å›¾ç‰‡ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899/* components/HomeSwipe/index.vue */&lt;script setup lang=&quot;ts&quot;&gt;// éœ€è¦æ”¹æˆåç«¯è°ƒç”¨æ›´æ–°å›¾ç‰‡const SwipeImages = reactive([ &#123; imgUrl: &#x27;https://olrando.oss-cn-chengdu.aliyuncs.com/img/duiqi.jpg&#x27;, index: 0 &#125;, &#123; imgUrl: &#x27;https://olrando.oss-cn-chengdu.aliyuncs.com/img/1681282717068.jpeg&#x27;, index: 1 &#125;, &#123; imgUrl: &#x27;https://olrando.oss-cn-chengdu.aliyuncs.com/img/1681282717071.jpeg&#x27;, index: 2 &#125;, &#123; imgUrl: &#x27;https://olrando.oss-cn-chengdu.aliyuncs.com/img/1681282717075.jpeg&#x27;, index: 3 &#125;])&lt;/script&gt;&lt;template&gt; &lt;div class=&quot;swipe-container&quot;&gt; &lt;!-- è½®æ’­å›¾ä¸Šå±‚éƒ¨åˆ† --&gt; &lt;div class=&quot;foreground&quot;&gt; &lt;van-swipe loop class=&quot;my-swipe-fore&quot; :autoplay=&quot;3000&quot; indicator-color=&quot;#1989fa&quot; :touchable=&quot;false&quot; &gt; &lt;van-swipe-item v-for=&quot;item in SwipeImages&quot; :key=&quot;item.index&quot;&gt; &lt;img :src=&quot;item.imgUrl&quot; /&gt; &lt;/van-swipe-item&gt; &lt;/van-swipe&gt; &lt;/div&gt; &lt;!-- è½®æ’­å›¾ä¸‹å±‚éƒ¨åˆ† --&gt; &lt;div class=&quot;background&quot;&gt; &lt;van-swipe loop class=&quot;my-swipe-back&quot; :autoplay=&quot;3000&quot; :touchable=&quot;false&quot;&gt; &lt;van-swipe-item v-for=&quot;item in SwipeImages&quot; :key=&quot;item.index&quot;&gt; &lt;img :src=&quot;item.imgUrl&quot; /&gt; &lt;/van-swipe-item&gt; &lt;/van-swipe&gt; &lt;/div&gt; &lt;/div&gt;&lt;/template&gt;&lt;style scoped&gt;.swipe-container &#123; display: flex; align-items: center; justify-content: center; position: relative; overflow: hidden; border-radius: 20px 20px 20px 20px;&#125;.foreground &#123; z-index: 1;&#125;.my-swipe-fore &#123; border-radius: 20px 20px 20px 20px; height: 210px; width: 330px; margin: 20px 0px 20px 0px; box-shadow: 2px 2px 20px #3b2e32; border: transparent;&#125;.my-swipe-fore .van-swipe-item img &#123; width: 100%; height: 100%; border-radius: 20px 20px 20px 20px;&#125;.background &#123; z-index: 0; filter: blur(4px); opacity: 0.8; position: absolute;&#125;.my-swipe-back &#123; border-radius: 20px 20px 20px 20px; height: 240px; width: 365px;&#125;.my-swipe-back .van-swipe-item img &#123; width: 100%; height: 100%; border-radius: 20px 20px 20px 20px;&#125;&lt;/style&gt; é¦–é¡µ-å°é€šçŸ¥12345678910111213141516171819202122/* components/HomeNoticeBar/index.vue */&lt;script setup lang=&quot;ts&quot;&gt;// ä½¿ç”¨ç±»å‹å£°æ˜æ¥å®šä¹‰ Props ç±»å‹interface Props &#123; text?: string // è®© text æˆä¸ºå¯é€‰çš„&#125;// ä½¿ç”¨ defineProps æ¥å®šä¹‰ç»„ä»¶çš„ PropsdefineProps&lt;Props&gt;()&lt;/script&gt;&lt;template&gt; &lt;van-notice-bar scrollable left-icon=&quot;volume-o&quot; color=&quot;#1989fa&quot; background=&quot;#ecf9ff&quot; :text=&quot;text || &#x27;æš‚æ—¶æ²¡æœ‰å…¬å‘Šå“¦~&#x27;&quot; /&gt;&lt;/template&gt;&lt;style scoped&gt;&lt;/style&gt; é¦–é¡µ-é˜Ÿå¾½é˜Ÿå1234567891011121314151617181920212223/* components/HomeTeamName/index.vue */&lt;script setup lang=&quot;ts&quot;&gt;&lt;/script&gt;&lt;template&gt; &lt;div class=&quot;TeamName&quot;&gt; &lt;img src=&quot;@/assets/images/é€æ˜é˜Ÿå¾½.png&quot; alt=&quot;&quot; /&gt; &lt;h3&gt;&quot;å°çº¢å¸½&quot;å¸¸é’è—¤é’å¹´å¿—æ„¿è€…æœåŠ¡é˜Ÿ&lt;/h3&gt; &lt;/div&gt;&lt;/template&gt;&lt;style scoped&gt;.TeamName &#123; display: flex; align-items: center; justify-content: center; margin: 5px 0;&#125;.TeamName img &#123; width: 30px; height: 30px;&#125;&lt;/style&gt; é¦–é¡µ-å®«æ ¼123456789101112131415161718192021222324252627282930313233343536373839404142434445/* components/HomeGrid/index.vue */&lt;template&gt; &lt;van-grid icon-size=&quot;30px&quot; :column-num=&quot;2&quot; clickable&gt; &lt;van-grid-item text=&quot;æ ¡å›­æœåŠ¡é€š&quot; icon=&quot; icon-campus-service&quot; icon-prefix=&quot;iconfont&quot; to=&quot;/campusservice&quot; /&gt; &lt;van-grid-item text=&quot;çˆ±å¿ƒé›¨ä¼&quot; icon=&quot; icon-love-umbrella&quot; icon-prefix=&quot;iconfont&quot; to=&quot;/loveumbrella&quot; /&gt; &lt;van-grid-item text=&quot;æœåŠ¡é˜Ÿæ´»åŠ¨é£é‡‡&quot; icon=&quot; icon-great-activities&quot; icon-prefix=&quot;iconfont&quot; to=&quot;/activities&quot; /&gt; &lt;van-grid-item text=&quot;å¿—æ„¿æ´»åŠ¨æŠ¥å&quot; icon=&quot; icon-signup-activities&quot; icon-prefix=&quot;iconfont&quot; to=&quot;/signup&quot; /&gt; &lt;van-grid-item text=&quot;å…³äºé’é˜Ÿ&quot; icon=&quot; icon-about-us&quot; icon-prefix=&quot;iconfont&quot; to=&quot;/aboutus&quot; /&gt; &lt;van-grid-item text=&quot;ç”¨æˆ·æ„è§åé¦ˆ&quot; icon=&quot; icon-feedback&quot; icon-prefix=&quot;iconfont&quot; to=&quot;/feedback&quot; /&gt; &lt;/van-grid&gt;&lt;/template&gt;&lt;script setup lang=&quot;ts&quot;&gt;&lt;/script&gt;&lt;style scoped&gt;&lt;/style&gt; é¦–é¡µåŠŸèƒ½-ç”¨æˆ·é—®é¢˜åé¦ˆé¡µé¢123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120&lt;script setup lang=&quot;ts&quot;&gt;// é€šçŸ¥æ¶ˆæ¯const notification = ref&lt;string&gt;( &#x27;ä¸ºäº†æ›´å¥½åœ°æå‡æˆ‘ä»¬çš„æœåŠ¡è´¨é‡ï¼Œæˆ‘ä»¬è¯šæŒšé‚€è¯·æ‚¨æä¾›å®è´µçš„æ„è§å’Œå»ºè®®&#x27;)// è¡¨å•æ•°æ®const isAnonymous = ref&lt;boolean&gt;(false) // æ§åˆ¶æ˜¯å¦åŒ¿åconst username = ref&lt;string&gt;(&#x27;&#x27;)const phone = ref&lt;string&gt;(&#x27;&#x27;)const studentId = ref&lt;string&gt;(&#x27;&#x27;)const message = ref&lt;string&gt;(&#x27;&#x27;)// éªŒè¯è§„åˆ™const rules = &#123; username: [ &#123; required: !isAnonymous.value, message: &#x27;å§“åä¸èƒ½ä¸ºç©º&#x27;, trigger: &#x27;onBlur&#x27; &#125; ], phone: [ &#123; required: false &#125;, &#123; pattern: /^1[3-9]\\d&#123;9&#125;$/, message: &#x27;æ‰‹æœºå·æ ¼å¼é”™è¯¯&#x27;, trigger: &#x27;onBlur&#x27; &#125; ], studentId: [ &#123; required: !isAnonymous.value, message: &#x27;å­¦å·ä¸èƒ½ä¸ºç©º&#x27;, trigger: &#x27;onBlur&#x27; &#125;, &#123; pattern: /^\\d&#123;8,12&#125;$/, message: &#x27;å­¦å·æ ¼å¼ä¸æ­£ç¡®&#x27;, trigger: &#x27;onBlur&#x27; &#125; // å­¦å·å‡è®¾ä¸º8åˆ°12ä½æ•°å­— ], message: [&#123; required: true, message: &#x27;åé¦ˆå†…å®¹ä¸èƒ½ä¸ºç©º&#x27;, trigger: &#x27;onBlur&#x27; &#125;]&#125;// æäº¤å¤„ç†const onSubmit = () =&gt; &#123; // æäº¤è¡¨å•é€»è¾‘ if (isAnonymous.value) &#123; console.log(&#x27;åŒ¿åæäº¤åé¦ˆ&#x27;) &#125; else &#123; console.log(&#x27;å®åæäº¤åé¦ˆ&#x27;) &#125; showToast(&#x27;æäº¤æˆåŠŸ&#x27;)&#125;// ç›‘å¬åŒ¿åå¼€å…³çŠ¶æ€å˜åŒ–ï¼Œå®æ—¶æ›´æ–°éªŒè¯è§„åˆ™watch(isAnonymous, (newVal) =&gt; &#123; rules.username[0].required = !newVal rules.studentId[0].required = !newVal&#125;)&lt;/script&gt;&lt;template&gt; &lt;div&gt; &lt;!-- å°å…¬å‘Š --&gt; &lt;HomeNoticeBar :notification=&quot;notification&quot; /&gt; &lt;!-- é˜Ÿå¾½é˜Ÿå --&gt; &lt;HomeTeamName /&gt; &lt;van-form @submit=&quot;onSubmit&quot;&gt; &lt;van-cell-group inset&gt; &lt;!-- å§“å --&gt; &lt;van-field v-model=&quot;username&quot; :rules=&quot;rules.username&quot; :required=&quot;rules.username[0].required&quot; label=&quot;å§“å&quot; placeholder=&quot;è¯·è¾“å…¥æ‚¨çš„å§“å&quot; v-if=&quot;!isAnonymous&quot; /&gt; &lt;!-- å­¦å· --&gt; &lt;van-field v-model=&quot;studentId&quot; :rules=&quot;rules.studentId&quot; :required=&quot;rules.studentId[0].required&quot; label=&quot;å­¦å·&quot; placeholder=&quot;è¯·è¾“å…¥æ‚¨çš„å­¦å·&quot; v-if=&quot;!isAnonymous&quot; /&gt; &lt;!-- æ‰‹æœºå· --&gt; &lt;van-field v-model=&quot;phone&quot; :rules=&quot;rules.phone&quot; :required=&quot;rules.phone[0].required&quot; label=&quot;æ‰‹æœºå·&quot; placeholder=&quot;è¯·è¾“å…¥æ‚¨çš„æ‰‹æœºå·&quot; v-if=&quot;!isAnonymous&quot; /&gt; &lt;!-- åé¦ˆå†…å®¹ --&gt; &lt;van-field v-model=&quot;message&quot; :rules=&quot;rules.message&quot; :required=&quot;rules.message[0].required&quot; rows=&quot;2&quot; autosize label=&quot;åé¦ˆå†…å®¹&quot; type=&quot;textarea&quot; maxlength=&quot;1000&quot; placeholder=&quot;è¯·è¾“å…¥åé¦ˆå†…å®¹&quot; show-word-limit /&gt; &lt;van-field name=&quot;switch&quot; label=&quot;åŒ¿åæäº¤&quot;&gt; &lt;template #input&gt; &lt;van-switch v-model=&quot;isAnonymous&quot; /&gt; &lt;/template&gt; &lt;/van-field&gt; &lt;/van-cell-group&gt; &lt;div style=&quot;margin: 16px&quot;&gt; &lt;van-button round block type=&quot;primary&quot; native-type=&quot;submit&quot;&gt; æäº¤ &lt;/van-button&gt; &lt;/div&gt; &lt;/van-form&gt; &lt;/div&gt;&lt;/template&gt;&lt;style scoped&gt;&lt;/style&gt; ä¸ªäººä¸­å¿ƒ12345678910111213141516171819202122232425&lt;script setup&gt;import UserIsLoginView from &#x27;@/views/User/UserIsLogin/UserIsLoginView.vue&#x27;import UserUnLoginView from &#x27;@/views/User/UserUnLogin/UserUnLoginView.vue&#x27;// import&#123;isLogin&#125; from &#x27;@/utils/util&#x27;let show = ref(false)// onMounted(() =&gt; &#123;// if (isLogin()) &#123;// show.value = true// &#125; else &#123;// show.value = false// &#125;// &#125;)&lt;/script&gt;&lt;template&gt; &lt;div&gt; &lt;UserUnLoginView v-if=&quot;show&quot; /&gt; &lt;UserIsLoginView v-else /&gt; &lt;Divider dividerText=&quot;äººå·¥æ™ºèƒ½å­¦é™¢ â€œå°çº¢å¸½â€å¸¸é’è—¤é’å¹´å¿—æ„¿è€…æœåŠ¡é˜Ÿ&quot; /&gt; &lt;/div&gt;&lt;/template&gt;&lt;style&gt;&lt;/style&gt; ä¸ªäººä¸­å¿ƒ-æœªç™»å½•123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120&lt;script setup lang=&quot;ts&quot;&gt;const menuItems = [ &#123; icon: &#x27; icon-personal-data&#x27;, classPrefix: &#x27;iconfont&#x27;, text: &#x27;ä¸ªäººèµ„æ–™&#x27;, routerLink: &#x27;&#x27; &#125;, &#123; icon: &#x27; icon-permission-application&#x27;, classPrefix: &#x27;iconfont&#x27;, text: &#x27;æƒé™ç”³è¯·&#x27;, routerLink: &#x27;&#x27; &#125;, &#123; icon: &#x27; icon-operating-guide&#x27;, classPrefix: &#x27;iconfont&#x27;, text: &#x27;ä½¿ç”¨æŒ‡å—&#x27;, routerLink: &#x27;/operatingguide&#x27; &#125;, &#123; icon: &#x27; icon-setting&#x27;, classPrefix: &#x27;iconfont&#x27;, text: &#x27;è®¾ç½®&#x27;, routerLink: &#x27;&#x27; &#125;]const login = () =&gt; &#123; showToast(&#123; message: &#x27;æ­£åœ¨å¼€å‘ä¸­...&#x27;, position: &#x27;top&#x27; &#125;)&#125;const toastFn = () =&gt; &#123; showToast(&#123; message: &#x27;è¯·ç™»å½•ä¹‹åå†ä½¿ç”¨&#x27;, position: &#x27;top&#x27; &#125;)&#125;&lt;/script&gt;&lt;template&gt; &lt;div class=&quot;container&quot;&gt; &lt;div class=&quot;defaultProfile&quot; @click=&quot;login&quot;&gt; &lt;div class=&quot;defaultAvatar&quot;&gt; &lt;van-icon name=&quot; icon-default-avatar&quot; class-prefix=&quot;iconfont&quot; size=&quot;80&quot; /&gt; &lt;div class=&quot;defaultText&quot;&gt;ç‚¹å‡»ç™»å½•&lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;defaultSection&quot;&gt; &lt;ul&gt; &lt;li v-for=&quot;item in menuItems&quot; :key=&quot;item.text&quot; @click=&quot;toastFn()&quot;&gt; &lt;router-link :to=&quot;item.routerLink&quot; class=&quot;menuLink&quot;&gt; &lt;van-icon :name=&quot;item.icon&quot; :class-prefix=&quot;item.classPrefix&quot; style=&quot;margin: 0px 10px 0px 0px&quot; /&gt; &#123;&#123; item.text &#125;&#125; &lt;/router-link&gt; &lt;/li&gt; &lt;/ul&gt; &lt;/div&gt; &lt;/div&gt;&lt;/template&gt;&lt;style scoped&gt;.defaultProfile &#123; margin: 30px 0;&#125;.defaultProfile .defaultAvatar &#123; display: flex; flex-direction: column; align-items: center; justify-content: center;&#125;.defaultSection &#123; padding: 20px; background-color: #fff; box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1); display: flex; align-items: center; justify-content: center;&#125;.defaultSection ul &#123; list-style: none; width: 100%; padding: 0; margin: 0;&#125;.defaultSection li &#123; margin: 20px 0px 20px 0px;&#125;.menuLink &#123; display: block; padding: 10px; color: #333; text-decoration: none; border-radius: 5px; background-color: #f6f6f6; box-shadow: 0 0 5px rgba(0, 0, 0, 0.1); display: flex; align-items: center;&#125;.menuLink:hover &#123; background-color: #e6e6e6;&#125;&lt;/style&gt; ä¸ªäººä¸­å¿ƒ-å·²ç™»å½•123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123&lt;script setup lang=&quot;ts&quot;&gt;const menuItems = [ &#123; icon: &#x27; icon-personal-data&#x27;, classPrefix: &#x27;iconfont&#x27;, text: &#x27;ä¸ªäººèµ„æ–™&#x27;, routerLink: &#x27;/personaldata&#x27; &#125;, &#123; icon: &#x27; icon-permission-application&#x27;, classPrefix: &#x27;iconfont&#x27;, text: &#x27;æƒé™ç”³è¯·&#x27;, routerLink: &#x27;/permissionapplication&#x27; &#125;, &#123; icon: &#x27; icon-operating-guide&#x27;, classPrefix: &#x27;iconfont&#x27;, text: &#x27;ä½¿ç”¨æŒ‡å—&#x27;, routerLink: &#x27;/operatingguide&#x27; &#125;, &#123; icon: &#x27; icon-setting&#x27;, classPrefix: &#x27;iconfont&#x27;, text: &#x27;è®¾ç½®&#x27;, routerLink: &#x27;/setting&#x27; &#125;]// ç”¨æˆ·åã€åº”å½“é€šè¿‡ä¼ä¸šå¾®ä¿¡ç™»å½•ä¹‹åæ¥ç¡®å®šã€‘const username = &#x27;å¸…å“¥/ç¾å¥³&#x27;// è®¾ç½®é—®å€™è¯­const greeting = computed(() =&gt; &#123; const hour = new Date().getHours() if (hour &gt;= 6 &amp;&amp; hour &lt; 11) &#123; return `æ—©ä¸Šå¥½, $&#123;username&#125;` &#125; else if (hour &gt;= 11 &amp;&amp; hour &lt; 13) &#123; return `ä¸­åˆå¥½, $&#123;username&#125;` &#125; else if (hour &gt;= 13 &amp;&amp; hour &lt; 18) &#123; return `ä¸‹åˆå¥½, $&#123;username&#125;` &#125; else &#123; return `æ™šä¸Šå¥½, $&#123;username&#125;` &#125;&#125;)&lt;/script&gt;&lt;template&gt; &lt;div class=&quot;container&quot;&gt; &lt;div class=&quot;defaultProfile&quot;&gt; &lt;div class=&quot;defaultAvatar&quot;&gt; &lt;van-icon name=&quot; icon-volunteer-avatar&quot; class-prefix=&quot;iconfont&quot; size=&quot;80&quot; /&gt; &lt;div class=&quot;defaultText&quot;&gt;&#123;&#123; greeting &#125;&#125;&lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;defaultSection&quot;&gt; &lt;ul&gt; &lt;li v-for=&quot;item in menuItems&quot; :key=&quot;item.text&quot;&gt; &lt;router-link :to=&quot;item.routerLink&quot; class=&quot;menuLink&quot;&gt; &lt;van-icon :name=&quot;item.icon&quot; :class-prefix=&quot;item.classPrefix&quot; style=&quot;margin: 0px 10px 0px 0px&quot; /&gt; &#123;&#123; item.text &#125;&#125; &lt;/router-link&gt; &lt;/li&gt; &lt;/ul&gt; &lt;/div&gt; &lt;/div&gt;&lt;/template&gt;&lt;style scoped&gt;.defaultProfile &#123; margin: 30px 0;&#125;.defaultProfile .defaultAvatar &#123; display: flex; flex-direction: column; align-items: center; justify-content: center;&#125;.defaultSection &#123; padding: 20px; background-color: #fff; box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1); display: flex; align-items: center; justify-content: center;&#125;.defaultSection ul &#123; list-style: none; width: 100%; padding: 0; margin: 0;&#125;.defaultSection li &#123; margin: 20px 0px 20px 0px;&#125;.menuLink &#123; display: block; padding: 10px; color: #333; text-decoration: none; border-radius: 5px; background-color: #f6f6f6; box-shadow: 0 0 5px rgba(0, 0, 0, 0.1); display: flex; align-items: center;&#125;.menuLink:hover &#123; background-color: #e6e6e6;&#125;&lt;/style&gt; ä¸ªäººä¸­å¿ƒåŠŸèƒ½-ä¸ªäººèµ„æ–™é¡µé¢123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153&lt;script setup lang=&quot;ts&quot;&gt;// ç”¨æˆ·çš„ä¸ªäººä¿¡æ¯const userInfo = ref(&#123; avatar: &#x27;&#x27;, // ç”¨æˆ·å¤´åƒ username: &#x27;ç”¨æˆ·å&#x27;, realName: &#x27;å¼ ä¸‰&#x27;, // çœŸå®å§“åï¼Œä¸èƒ½ä¿®æ”¹ studentId: &#x27;20230001&#x27;, // å­¦å·ï¼Œä¸èƒ½ä¿®æ”¹ phone: &#x27;12345678901&#x27;, email: &#x27;example@example.com&#x27;, bio: &#x27;è¿™æ˜¯æˆ‘çš„ä¸ªäººç®€ä»‹ã€‚&#x27;, gender: 0 // æ€§åˆ«ï¼š0 = ä¸å¡«å†™ï¼Œ1 = ç”·ï¼Œ2 = å¥³&#125;)const isEditing = ref(false) // æ ‡è®°æ˜¯å¦å¤„äºç¼–è¾‘æ¨¡å¼// è¿›å…¥ç¼–è¾‘æ¨¡å¼const startEditing = () =&gt; &#123; isEditing.value = true&#125;// æäº¤ä¿®æ”¹const saveChanges = () =&gt; &#123; isEditing.value = false&#125;// ä¸Šä¼ å¤´åƒconst uploadAvatar = (e: Event) =&gt; &#123; const file = (e.target as HTMLInputElement).files?.[0] if (file) &#123; userInfo.value.avatar = URL.createObjectURL(file) showToast(&#x27;å¤´åƒä¸Šä¼ æˆåŠŸ&#x27;) &#125;&#125;&lt;/script&gt;&lt;template&gt; &lt;div&gt; &lt;van-nav-bar title=&quot;ä¸ªäººèµ„æ–™&quot; fixed placeholder /&gt; &lt;!-- å¤´åƒéƒ¨åˆ† --&gt; &lt;div style=&quot;text-align: center; margin: 20px 0&quot;&gt; &lt;label for=&quot;avatar-upload&quot; style=&quot;cursor: pointer&quot;&gt; &lt;img :src=&quot;userInfo.avatar || &#x27;https://via.placeholder.com/80&#x27;&quot; alt=&quot;avatar&quot; style=&quot;width: 80px; height: 80px; border-radius: 50%&quot; /&gt; &lt;/label&gt; &lt;!-- å½“å¤„äºç¼–è¾‘æ¨¡å¼æ—¶æ‰æ˜¾ç¤ºæç¤º --&gt; &lt;p v-if=&quot;isEditing&quot;&gt;ç‚¹å‡»å¤´åƒä¿®æ”¹&lt;/p&gt; &lt;input :disabled=&quot;!isEditing&quot; id=&quot;avatar-upload&quot; type=&quot;file&quot; accept=&quot;image/*&quot; style=&quot;display: none&quot; @change=&quot;uploadAvatar&quot; /&gt; &lt;/div&gt; &lt;!-- ä¸ªäººä¿¡æ¯éƒ¨åˆ† --&gt; &lt;van-cell-group&gt; &lt;!-- ç”¨æˆ·å --&gt; &lt;van-field v-model=&quot;userInfo.username&quot; label=&quot;ç”¨æˆ·å&quot; :disabled=&quot;!isEditing&quot; :input-align=&quot;&#x27;left&#x27;&quot; /&gt; &lt;!-- çœŸå®å§“åï¼ˆä¸å¯ä¿®æ”¹ï¼‰ --&gt; &lt;van-field v-model=&quot;userInfo.realName&quot; label=&quot;çœŸå®å§“å&quot; :disabled=&quot;true&quot; :input-align=&quot;&#x27;left&#x27;&quot; :class=&quot;isEditing ? &#x27;disabled-field&#x27; : &#x27;&#x27;&quot; /&gt; &lt;!-- å­¦å·ï¼ˆä¸å¯ä¿®æ”¹ï¼‰ --&gt; &lt;van-field v-model=&quot;userInfo.studentId&quot; label=&quot;å­¦å·&quot; :disabled=&quot;true&quot; :input-align=&quot;&#x27;left&#x27;&quot; :class=&quot;isEditing ? &#x27;disabled-field&#x27; : &#x27;&#x27;&quot; /&gt; &lt;!-- æ‰‹æœºå· --&gt; &lt;van-field v-model=&quot;userInfo.phone&quot; label=&quot;æ‰‹æœºå·&quot; :disabled=&quot;!isEditing&quot; :input-align=&quot;&#x27;left&#x27;&quot; /&gt; &lt;!-- é‚®ç®± --&gt; &lt;van-field v-model=&quot;userInfo.email&quot; label=&quot;é‚®ç®±&quot; :disabled=&quot;!isEditing&quot; :input-align=&quot;&#x27;left&#x27;&quot; /&gt; &lt;!-- æ€§åˆ« --&gt; &lt;van-field label=&quot;æ€§åˆ«&quot; :disabled=&quot;!isEditing&quot; :input-align=&quot;&#x27;left&#x27;&quot;&gt; &lt;template #input&gt; &lt;van-radio-group :disabled=&quot;!isEditing&quot; v-model=&quot;userInfo.gender&quot; direction=&quot;horizontal&quot; &gt; &lt;van-radio name=&quot;1&quot;&gt;ç”·&lt;/van-radio&gt; &lt;van-radio name=&quot;2&quot;&gt;å¥³&lt;/van-radio&gt; &lt;van-radio name=&quot;0&quot;&gt;ä¿å¯†&lt;/van-radio&gt; &lt;/van-radio-group&gt; &lt;/template&gt; &lt;/van-field&gt; &lt;!-- ä¸ªäººç®€ä»‹ --&gt; &lt;van-field v-model=&quot;userInfo.bio&quot; label=&quot;ä¸ªäººç®€ä»‹&quot; type=&quot;textarea&quot; rows=&quot;3&quot; :autosize=&quot;&#123; maxHeight: 100 &#125;&quot; maxlength=&quot;150&quot; placeholder=&quot;è¯·è¾“å…¥ä¸ªäººç®€ä»‹&quot; show-word-limit :disabled=&quot;!isEditing&quot; /&gt; &lt;/van-cell-group&gt; &lt;!-- ç¼–è¾‘æŒ‰é’® --&gt; &lt;div style=&quot;margin: 16px&quot;&gt; &lt;van-button v-if=&quot;!isEditing&quot; type=&quot;primary&quot; block @click=&quot;startEditing&quot;&gt; ä¿®æ”¹ä¸ªäººä¿¡æ¯ &lt;/van-button&gt; &lt;van-button v-else type=&quot;success&quot; block @click=&quot;saveChanges&quot;&gt; ä¿å­˜ä¿®æ”¹ &lt;/van-button&gt; &lt;/div&gt; &lt;Divider dividerText=&quot;äººå·¥æ™ºèƒ½å­¦é™¢ â€œå°çº¢å¸½â€å¸¸é’è—¤é’å¹´å¿—æ„¿è€…æœåŠ¡é˜Ÿ&quot; /&gt; &lt;/div&gt;&lt;/template&gt;&lt;style scoped&gt;.disabled-field input &#123; background-color: #f5f5f5; color: #aaa;&#125;&lt;/style&gt; ä¸ªäººä¸­å¿ƒåŠŸèƒ½-æƒé™ç”³è¯·é¡µé¢123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115&lt;script setup lang=&quot;ts&quot;&gt;// é€šçŸ¥æ¶ˆæ¯const notification = ref&lt;string&gt;( &#x27;ç›®å‰åªæ”¯æŒé’é˜Ÿæˆå‘˜å¯ä»¥ç”³è¯·æƒé™å“¦~åç»­ä¹Ÿä¼šä¸ºæ™®é€šç”¨æˆ·æä¾›æƒé™ç¦åˆ©ï¼&#x27;)// è¡¨å•æ•°æ®const username = ref&lt;string&gt;(&#x27;&#x27;)const studentId = ref&lt;string&gt;(&#x27;&#x27;)const reson = ref&lt;string&gt;(&#x27;&#x27;)const right = ref(&#x27;&#x27;)const showPicker = ref(false)const right_columns = [ &#123; text: &#x27;è¶…çº§ç®¡ç†å‘˜&#x27;, value: &#x27;1&#x27; &#125;, &#123; text: &#x27;ç®¡ç†å‘˜&#x27;, value: &#x27;2&#x27; &#125;]const onConfirm = (&#123; selectedOptions &#125;) =&gt; &#123; right.value = selectedOptions[0]?.text showPicker.value = false&#125;// éªŒè¯è§„åˆ™const rules = &#123; username: [&#123; required: true, message: &#x27;å§“åä¸èƒ½ä¸ºç©º&#x27;, trigger: &#x27;onBlur&#x27; &#125;], studentId: [ &#123; required: true, message: &#x27;å­¦å·ä¸èƒ½ä¸ºç©º&#x27;, trigger: &#x27;onBlur&#x27; &#125;, &#123; pattern: /^\\d&#123;8,12&#125;$/, message: &#x27;å­¦å·æ ¼å¼ä¸æ­£ç¡®&#x27;, trigger: &#x27;onBlur&#x27; &#125; // å­¦å·å‡è®¾ä¸º8åˆ°12ä½æ•°å­— ], right: [&#123; required: true, message: &#x27;è¯·é€‰æ‹©è¦ç”³è¯·çš„æƒé™&#x27;, trigger: &#x27;onBlur&#x27; &#125;], reson: [&#123; required: true, message: &#x27;ç”³è¯·åŸå› ä¸èƒ½ä¸ºç©º&#x27;, trigger: &#x27;onBlur&#x27; &#125;]&#125;// æäº¤å¤„ç†const onSubmit = () =&gt; &#123; showToast(&#x27;æäº¤æˆåŠŸ&#x27;)&#125;&lt;/script&gt;&lt;template&gt; &lt;div&gt; &lt;!-- å°å…¬å‘Š --&gt; &lt;HomeNoticeBar :notification=&quot;notification&quot; /&gt; &lt;!-- é˜Ÿå¾½é˜Ÿå --&gt; &lt;HomeTeamName /&gt; &lt;van-form @submit=&quot;onSubmit&quot;&gt; &lt;van-cell-group inset&gt; &lt;!-- å§“å --&gt; &lt;van-field v-model=&quot;username&quot; :rules=&quot;rules.username&quot; :required=&quot;rules.username[0].required&quot; label=&quot;å§“å&quot; placeholder=&quot;è¯·è¾“å…¥æ‚¨çš„å§“å&quot; /&gt; &lt;!-- å­¦å· --&gt; &lt;van-field v-model=&quot;studentId&quot; :rules=&quot;rules.studentId&quot; :required=&quot;rules.studentId[0].required&quot; label=&quot;å­¦å·&quot; placeholder=&quot;è¯·è¾“å…¥æ‚¨çš„å­¦å·&quot; /&gt; &lt;!-- ç”³è¯·æƒé™ --&gt; &lt;van-field v-model=&quot;right&quot; :rules=&quot;rules.right&quot; :required=&quot;rules.right[0].required&quot; is-link readonly name=&quot;picker&quot; label=&quot;é€‰æ‹©å™¨&quot; placeholder=&quot;ç‚¹å‡»é€‰æ‹©æƒé™&quot; @click=&quot;showPicker = true&quot; /&gt; &lt;van-popup v-model:show=&quot;showPicker&quot; position=&quot;top&quot;&gt; &lt;van-picker :columns=&quot;right_columns&quot; @confirm=&quot;onConfirm&quot; @cancel=&quot;showPicker = false&quot; /&gt; &lt;/van-popup&gt; &lt;!-- ç”³è¯·åŸå›  --&gt; &lt;van-field v-model=&quot;reson&quot; :rules=&quot;rules.reson&quot; :required=&quot;rules.reson[0].required&quot; rows=&quot;2&quot; autosize label=&quot;ç”³è¯·åŸå› &quot; type=&quot;textarea&quot; maxlength=&quot;1000&quot; placeholder=&quot;è¯·è¾“å…¥ç”³è¯·åŸå› &quot; show-word-limit /&gt; &lt;/van-cell-group&gt; &lt;div style=&quot;margin: 16px&quot;&gt; &lt;van-button round block type=&quot;primary&quot; native-type=&quot;submit&quot;&gt; æäº¤ &lt;/van-button&gt; &lt;/div&gt; &lt;/van-form&gt; &lt;Divider dividerText=&quot;äººå·¥æ™ºèƒ½å­¦é™¢ â€œå°çº¢å¸½â€å¸¸é’è—¤é’å¹´å¿—æ„¿è€…æœåŠ¡é˜Ÿ&quot; /&gt; &lt;/div&gt;&lt;/template&gt;&lt;style scoped&gt;&lt;/style&gt; ä¸ªäººä¸­å¿ƒåŠŸèƒ½-ä½¿ç”¨æŒ‡å—é¡µé¢12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667&lt;script setup lang=&quot;ts&quot;&gt;const activeName = ref&lt;string&gt;(&#x27;1&#x27;)&lt;/script&gt;&lt;template&gt; &lt;div&gt; &lt;van-nav-bar title=&quot;ä½¿ç”¨æŒ‡å—&quot; fixed placeholder /&gt; &lt;van-collapse v-model=&quot;activeName&quot; accordion&gt; &lt;!-- ç™»å½•è´¦æˆ·æŒ‡å— --&gt; &lt;van-collapse-item title=&quot;æ­¥éª¤ 1: ç™»å½•è´¦æˆ·&quot; name=&quot;1&quot; :title-style=&quot;&#123; color: activeName === &#x27;1&#x27; ? &#x27;#1989fa&#x27; : &#x27;#000&#x27; &#125;&quot; &gt; ä½¿ç”¨æ³¨å†Œæ—¶çš„æ‰‹æœºå·æˆ–é‚®ç®±è¿›è¡Œç™»å½•ï¼Œæœªæ³¨å†Œç”¨æˆ·è¯·å…ˆæ³¨å†Œã€‚ç™»å½•åå¯ä»¥è®¿é—®æ‰€æœ‰åŠŸèƒ½ã€‚ &lt;/van-collapse-item&gt; &lt;!-- æŸ¥çœ‹é€šçŸ¥æŒ‡å— --&gt; &lt;van-collapse-item title=&quot;æ­¥éª¤ 2: æŸ¥çœ‹é€šçŸ¥&quot; name=&quot;2&quot; :title-style=&quot;&#123; color: activeName === &#x27;2&#x27; ? &#x27;#1989fa&#x27; : &#x27;#000&#x27; &#125;&quot; &gt; ç™»å½•åå¯ä»¥åœ¨é€šçŸ¥é¡µé¢æŸ¥çœ‹æœ€æ–°çš„å…¬å‘Šå’Œé€šçŸ¥ï¼Œä¿æŒä¿¡æ¯çš„åŠæ—¶è·å–ã€‚ &lt;/van-collapse-item&gt; &lt;!-- æäº¤åé¦ˆæŒ‡å— --&gt; &lt;van-collapse-item title=&quot;æ­¥éª¤ 3: æäº¤åé¦ˆ&quot; name=&quot;3&quot; :title-style=&quot;&#123; color: activeName === &#x27;3&#x27; ? &#x27;#1989fa&#x27; : &#x27;#000&#x27; &#125;&quot; &gt; åœ¨åé¦ˆé¡µé¢å¡«å†™æ‚¨çš„æ„è§å’Œå»ºè®®ï¼Œæ”¯æŒåŒ¿åæäº¤ï¼Œå¸®åŠ©æˆ‘ä»¬æ”¹è¿›æœåŠ¡ã€‚ &lt;/van-collapse-item&gt; &lt;!-- ä¿®æ”¹ä¸ªäººä¿¡æ¯æŒ‡å— --&gt; &lt;van-collapse-item title=&quot;æ­¥éª¤ 4: ä¿®æ”¹ä¸ªäººä¿¡æ¯&quot; name=&quot;4&quot; :title-style=&quot;&#123; color: activeName === &#x27;4&#x27; ? &#x27;#1989fa&#x27; : &#x27;#000&#x27; &#125;&quot; &gt; æ‚¨å¯ä»¥åœ¨ä¸ªäººä¸­å¿ƒä¿®æ”¹å¤´åƒã€æ˜µç§°å’Œè”ç³»æ–¹å¼ç­‰ä¿¡æ¯ï¼Œä»¥ç¡®ä¿ä¸ªäººèµ„æ–™çš„å‡†ç¡®æ€§ã€‚ &lt;/van-collapse-item&gt; &lt;!-- å¸¸è§é—®é¢˜æŒ‡å— --&gt; &lt;van-collapse-item title=&quot;å¸¸è§é—®é¢˜&quot; name=&quot;5&quot; :title-style=&quot;&#123; color: activeName === &#x27;5&#x27; ? &#x27;#1989fa&#x27; : &#x27;#000&#x27; &#125;&quot; &gt; åœ¨å¸¸è§é—®é¢˜é¡µé¢ï¼Œæˆ‘ä»¬æ•´ç†äº†ä¸€äº›å¸¸è§çš„ä½¿ç”¨ç–‘é—®åŠè§£ç­”ï¼Œä¾›æ‚¨å‚è€ƒã€‚ &lt;/van-collapse-item&gt; &lt;!-- è”ç³»å®¢æœæŒ‡å— --&gt; &lt;van-collapse-item title=&quot;è”ç³»å®¢æœ&quot; name=&quot;6&quot; :title-style=&quot;&#123; color: activeName === &#x27;6&#x27; ? &#x27;#1989fa&#x27; : &#x27;#000&#x27; &#125;&quot; &gt; å¦‚æœé‡åˆ°é—®é¢˜æ— æ³•è§£å†³ï¼Œæ‚¨å¯ä»¥é€šè¿‡è”ç³»å®¢æœåŠŸèƒ½ä¸æˆ‘ä»¬å–å¾—è”ç³»ã€‚ &lt;/van-collapse-item&gt; &lt;/van-collapse&gt; &lt;Divider dividerText=&quot;äººå·¥æ™ºèƒ½å­¦é™¢ â€œå°çº¢å¸½â€å¸¸é’è—¤é’å¹´å¿—æ„¿è€…æœåŠ¡é˜Ÿ&quot; /&gt; &lt;/div&gt;&lt;/template&gt;&lt;style scoped&gt;&lt;/style&gt; ä¸ªäººä¸­å¿ƒåŠŸèƒ½-è®¾ç½®é¡µé¢12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758&lt;script setup lang=&quot;ts&quot;&gt;const router = useRouter()// é€€å‡ºç™»å½•å‡½æ•°const logout = () =&gt; &#123; // æ¨¡æ‹Ÿé€€å‡ºç™»å½•é€»è¾‘ï¼Œå¯ä»¥åœ¨è¿™é‡Œå¤„ç†å®é™…çš„é€€å‡ºç™»å½•æ“ä½œ showSuccessToast(&#123; message: &#x27;å·²é€€å‡ºç™»å½•&#x27;, position: &#x27;top&#x27; &#125;) router.push(&#x27;/&#x27;)&#125;// å¤„ç†å…¶ä»–è®¾ç½®é¡¹ç‚¹å‡»äº‹ä»¶const handleSettingClick = (message: string) =&gt; &#123; showToast(&#123; message: message, position: &#x27;top&#x27; &#125;)&#125;&lt;/script&gt;&lt;template&gt; &lt;div&gt; &lt;van-nav-bar title=&quot;è®¾ç½®&quot; fixed placeholder /&gt; &lt;!-- è®¾ç½®é€‰é¡¹ --&gt; &lt;van-cell-group&gt; &lt;!-- ä¿®æ”¹å¯†ç  --&gt; &lt;van-cell title=&quot;ä¿®æ”¹å¯†ç &quot; is-link @click=&quot;handleSettingClick(&#x27;ä¿®æ”¹å¯†ç åŠŸèƒ½æ­£åœ¨å¼€å‘ä¸­...&#x27;)&quot; /&gt; &lt;!-- é€šçŸ¥è®¾ç½® --&gt; &lt;van-cell title=&quot;é€šçŸ¥è®¾ç½®&quot; is-link @click=&quot;handleSettingClick(&#x27;é€šçŸ¥è®¾ç½®åŠŸèƒ½æ­£åœ¨å¼€å‘ä¸­...&#x27;)&quot; /&gt; &lt;!-- éšç§è®¾ç½® --&gt; &lt;van-cell title=&quot;éšç§è®¾ç½®&quot; is-link @click=&quot;handleSettingClick(&#x27;éšç§è®¾ç½®åŠŸèƒ½æ­£åœ¨å¼€å‘ä¸­...&#x27;)&quot; /&gt; &lt;/van-cell-group&gt; &lt;!-- é€€å‡ºç™»å½•æŒ‰é’® --&gt; &lt;div style=&quot;margin: 16px&quot;&gt; &lt;van-button type=&quot;danger&quot; block @click=&quot;logout&quot;&gt; é€€å‡ºç™»å½• &lt;/van-button&gt; &lt;/div&gt; &lt;Divider dividerText=&quot;äººå·¥æ™ºèƒ½å­¦é™¢ â€œå°çº¢å¸½â€å¸¸é’è—¤é’å¹´å¿—æ„¿è€…æœåŠ¡é˜Ÿ&quot; /&gt; &lt;/div&gt;&lt;/template&gt;&lt;style scoped&gt;&lt;/style&gt; ç»„ä»¶-åº•çº¿1234567891011121314151617181920212223/* components/Divider/index.vue */&lt;script setup lang=&quot;ts&quot;&gt;// ä½¿ç”¨ç±»å‹å£°æ˜æ¥å®šä¹‰ Props ç±»å‹interface Props &#123; dividerText?: string // è®© dividerText æˆä¸ºå¯é€‰çš„&#125;// ä½¿ç”¨ defineProps æ¥å®šä¹‰ç»„ä»¶çš„ PropsdefineProps&lt;Props&gt;()&lt;/script&gt;&lt;template&gt; &lt;van-divider class=&quot;divider&quot;&gt; &#123;&#123; dividerText &#125;&#125; &lt;/van-divider&gt;&lt;/template&gt;&lt;style scoped&gt;.divider &#123; margin: 20px 0px 20px 0px; padding: 0px 10px 0px 10px;&#125;&lt;/style&gt; åç«¯å¼€å‘ controllers æ–‡ä»¶å¤¹ ä½œç”¨ï¼šå­˜æ”¾ä¸šåŠ¡é€»è¾‘å¤„ç†å‡½æ•°ã€‚æ¯ä¸ªæ§åˆ¶å™¨è´Ÿè´£å¤„ç†ç‰¹å®šè·¯ç”±çš„è¯·æ±‚ï¼Œè°ƒç”¨ç›¸åº”çš„ service æ¥æ‰§è¡Œæ“ä½œï¼Œç„¶åå°†å“åº”è¿”å›ç»™å®¢æˆ·ç«¯ã€‚ æ·»åŠ å†…å®¹ï¼šä¸ºæ¯ä¸ªå®ä½“æˆ–æ¨¡å—åˆ›å»ºä¸€ä¸ªæ§åˆ¶å™¨æ–‡ä»¶ï¼ŒåŒ…å«å¢ã€åˆ ã€æ”¹ã€æŸ¥ç­‰æ“ä½œã€‚ä¾‹å¦‚ï¼šuserController.ts å¤„ç†ç”¨æˆ·ç›¸å…³çš„è¯·æ±‚ã€‚ db æ–‡ä»¶å¤¹ ä½œç”¨ï¼šå­˜æ”¾æ•°æ®åº“è¿æ¥é…ç½®å’Œæ•°æ®åº“æ“ä½œç›¸å…³çš„ä»£ç ã€‚ä½ å¯ä»¥åœ¨è¿™é‡Œåˆ›å»ºæ•°æ®åº“è¿æ¥æ± å’Œå¤„ç†æ•°æ®åº“æŸ¥è¯¢ã€‚ æ·»åŠ å†…å®¹ï¼šåˆ›å»º index.ts æ–‡ä»¶ï¼Œç”¨æ¥ç®¡ç†æ•°æ®åº“è¿æ¥ï¼ˆå¦‚ MySQLï¼‰ã€‚è¿˜å¯ä»¥æ ¹æ®éœ€æ±‚åˆ›å»ºæ•°æ®åº“æŸ¥è¯¢æ–¹æ³•ã€‚ middlewares æ–‡ä»¶å¤¹ ä½œç”¨ï¼šå­˜æ”¾ä¸­é—´ä»¶ï¼Œç”¨äºå¤„ç†è·¯ç”±è¯·æ±‚å‰çš„ä¸€äº›å…¬å…±æ“ä½œï¼Œå¦‚éªŒè¯ã€æ—¥å¿—ã€é”™è¯¯å¤„ç†ç­‰ã€‚ æ·»åŠ å†…å®¹ï¼šæ·»åŠ å¸¸è§çš„ä¸­é—´ä»¶æ–‡ä»¶ï¼Œå¦‚ authMiddleware.tsï¼ˆç”¨äºè®¤è¯ï¼‰å’Œ errorMiddleware.tsï¼ˆç”¨äºç»Ÿä¸€é”™è¯¯å¤„ç†ï¼‰ã€‚ routers æ–‡ä»¶å¤¹ ä½œç”¨ï¼šå­˜æ”¾è·¯ç”±å®šä¹‰ï¼ŒæŒ‡å®šå“ªäº› URL å¯¹åº”å“ªäº›æ§åˆ¶å™¨çš„æ“ä½œã€‚ æ·»åŠ å†…å®¹ï¼šä¸ºæ¯ä¸ªæ¨¡å—åˆ›å»ºä¸€ä¸ªè·¯ç”±æ–‡ä»¶ï¼Œä¾‹å¦‚ userRouter.tsã€‚ä½¿ç”¨ express.Router() æ¥å®šä¹‰è·¯ç”±ï¼Œå¹¶å¯¼å…¥ç›¸åº”çš„æ§åˆ¶å™¨æ–¹æ³•ã€‚ services æ–‡ä»¶å¤¹ ä½œç”¨ï¼šè´Ÿè´£å¤„ç†ä¸šåŠ¡é€»è¾‘å’Œæ•°æ®æ“ä½œï¼Œä¸»è¦ä¸ db å±‚è¿›è¡Œäº¤äº’ã€‚service å±‚è®©æ§åˆ¶å™¨å’Œæ•°æ®åº“é€»è¾‘åˆ†ç¦»ï¼Œä½¿å¾—ä»£ç ç»“æ„æ›´åŠ æ¸…æ™°ã€‚ æ·»åŠ å†…å®¹ï¼šä¸ºæ¯ä¸ªå®ä½“åˆ›å»ºæœåŠ¡æ–‡ä»¶ï¼Œä¾‹å¦‚ userService.tsï¼Œè´Ÿè´£ç”¨æˆ·çš„å¢åˆ æ”¹æŸ¥é€»è¾‘ã€‚ types æ–‡ä»¶å¤¹ ä½œç”¨ï¼šå­˜æ”¾ TypeScript ç±»å‹å®šä¹‰ã€‚ä½ å¯ä»¥åœ¨è¿™é‡Œå®šä¹‰å…¨å±€çš„æ¥å£ã€ç±»å‹ç­‰ã€‚ æ·»åŠ å†…å®¹ï¼šä¾‹å¦‚ user.d.ts ç”¨äºå®šä¹‰ç”¨æˆ·å®ä½“çš„ç±»å‹ï¼Œæˆ–è€…å®šä¹‰ responseFormat.ts ç”¨äºæ ‡å‡†åŒ– API å“åº”ç»“æ„çš„ç±»å‹ã€‚ utils æ–‡ä»¶å¤¹ ä½œç”¨ï¼šå­˜æ”¾é€šç”¨çš„å·¥å…·å‡½æ•°æˆ–è¾…åŠ©åŠŸèƒ½ï¼Œä¾‹å¦‚åŠ å¯†å‡½æ•°ã€æ ¼å¼åŒ–å·¥å…·ã€æ—¥å¿—å·¥å…·ç­‰ã€‚ æ·»åŠ å†…å®¹ï¼šæ¯”å¦‚åˆ›å»ºä¸€ä¸ª responseHandler.tsï¼Œå°è£…å’Œä¼˜åŒ– res.send() çš„å“åº”æ ¼å¼ï¼Œä½¿å…¶å¯ä»¥ç»Ÿä¸€å¤„ç†æˆåŠŸæˆ–å¤±è´¥çš„è¯·æ±‚ã€‚ åˆ›å»ºåç«¯é¡¹ç›®åˆå§‹åŒ–npmé¡¹ç›® 1npm init -y å®‰è£…expressæ¡†æ¶ 1npm i express å®‰è£…ä¾èµ–ä¸tsæœ‰å…³çš„ä¾èµ–ï¼šexpressæ˜¯åŸºäºnodeç¯å¢ƒçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å®‰è£…ä¸¤ä¸ªç±»å‹ä¾èµ–ï¼Œä»¥è·å¾—ç›¸å…³apiçš„ç±»å‹æç¤º 1npm install typescript ts-node @types/node @types/express --save-dev åˆå§‹åŒ– TypeScript é…ç½®ï¼šæ‰§è¡Œä»¥ä¸‹å‘½ä»¤æ¥ç”Ÿæˆ tsconfig.json æ–‡ä»¶ï¼š 1tsc --init tsconfig.json æ–‡ä»¶ä¸­çš„é…ç½®ï¼š 123456789101112131415161718&#123; &quot;compilerOptions&quot;: &#123; &quot;target&quot;: &quot;es2016&quot;, &quot;module&quot;: &quot;commonjs&quot;, &quot;esModuleInterop&quot;: true, &quot;forceConsistentCasingInFileNames&quot;: true, &quot;strict&quot;: true, &quot;skipLibCheck&quot;: true, &quot;rootDir&quot;: &quot;./src&quot;, &quot;outDir&quot;: &quot;./dist&quot;, &#125;, &quot;include&quot;: [ &quot;src/**/*&quot; ], &quot;exclude&quot;: [ &quot;node_modules&quot; ]&#125; é¡¹ç›®å…¥å£æ–‡ä»¶åˆ›å»ºé¡¹ç›®å…¥å£æ–‡ä»¶ï¼šåœ¨ src ç›®å½•ä¸‹åˆ›å»º app.ts æ–‡ä»¶ï¼š 1234567891011// å¯¼å…¥ express æ¨¡å—const express = require(&#x27;express&#x27;)// åˆ›å»º express çš„æœåŠ¡å™¨å®ä¾‹const app = express()// write your code here...// è°ƒç”¨ app.listen æ–¹æ³•ï¼ŒæŒ‡å®šç«¯å£å·å¹¶å¯åŠ¨webæœåŠ¡å™¨app.listen(3007, function () &#123; console.log(&#x27;api server running at http://127.0.0.1:3007&#x27;)&#125;) é…ç½® cors è·¨åŸŸå®‰è£…corsä¸­é—´ä»¶ 1npm i cors åœ¨app.jsä¸­é…ç½®corsä¸­é—´ä»¶ 1234// å¯¼å…¥ cors ä¸­é—´ä»¶const cors = require(&#x27;cors&#x27;)// å°† cors æ³¨å†Œä¸ºå…¨å±€ä¸­é—´ä»¶app.use(cors()) é…ç½®è§£æè¡¨å•æ•°æ®çš„ä¸­é—´ä»¶é…ç½®è§£æ JSON å’Œ application&#x2F;x-www-form-urlencoded æ ¼å¼çš„è¡¨å•æ•°æ®çš„ä¸­é—´ä»¶ï¼š 123// é…ç½®è§£æè¡¨å•æ•°æ®çš„ä¸­é—´ä»¶app.use(express.json())app.use(express.urlencoded(&#123; extended: false &#125;)) é…ç½®è·¯ç”±åˆ›å»ºroutersã€controllersã€servicesä¸‰å¤§æ–‡ä»¶å¤¹ routersï¼šindex.tsæ–‡ä»¶ç»Ÿä¸€ç®¡ç†æ‰€æœ‰æ¨¡å—çš„è·¯ç”±ï¼›å…¶ä»–å‡ä¸ºæ¨¡å—å•ç‹¬çš„è·¯ç”±ç®¡ç† controllersï¼šæ¯ä¸ªæ¨¡å—çš„ç®¡ç†ç«¯ä»£ç ï¼Œæ”¾ç½®è¯·æ±‚çš„æ•´ä½“ä»£ç  servicesï¼šæ¯ä¸ªæ¨¡å—çš„æœåŠ¡ç«¯ä»£ç ï¼Œæ”¾ç½®å…·ä½“çš„è¯·æ±‚å†…å®¹å’Œå®ç°é€»è¾‘ å°è£…ç»Ÿä¸€çš„å“åº”æ ¼å¼æ–°å»º/utils/responseUtil.tsæ–‡ä»¶ï¼Œåœ¨æ­¤å°è£…ç»Ÿä¸€å“åº”æ ¼å¼ï¼š 12345678910111213141516171819202122232425// å°è£…ç»Ÿä¸€çš„å“åº”æ ¼å¼import &#123; Response &#125; from &#x27;express&#x27;;interface ResponseFormat &#123; success: boolean; message: string; data?: any;&#125;export const successResponse = (res: Response, data: any, message = &#x27;Success&#x27;, statusCode = 200) =&gt; &#123; const response: ResponseFormat = &#123; success: true, message, data &#125;; res.status(statusCode).json(response);&#125;;export const errorResponse = (res: Response, message: string, statusCode = 500) =&gt; &#123; const response: ResponseFormat = &#123; success: false, message &#125;; res.status(statusCode).json(response);&#125;; å®‰è£…å¹¶é…ç½® mysql æ¨¡å—è¿è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œå®‰è£… mysql æ¨¡å—ï¼š 12npm i mysqlnpm install @types/mysql --save-dev æ–°å»º /db/index.js æ–‡ä»¶ï¼Œåœ¨æ­¤è‡ªå®šä¹‰æ¨¡å—ä¸­åˆ›å»ºæ•°æ®åº“çš„è¿æ¥å¯¹è±¡ï¼š 12345678910111213141516171819202122import mysql from &#x27;mysql&#x27;;const db = mysql.createPool(&#123; host: &#x27;127.0.0.1&#x27;, user: &#x27;root&#x27;, password: &#x27;Hu1282861514&#x27;, database: &#x27;cqt_cloud_platform&#x27;&#125;);// å°è£… db.query ä¸º Promiseexport const query = &lt;T&gt;(sql: string, values?: any): Promise&lt;T&gt; =&gt; &#123; return new Promise((resolve, reject) =&gt; &#123; db.query(sql, values, (error, results) =&gt; &#123; if (error) &#123; return reject(error); &#125; resolve(results); &#125;); &#125;);&#125;;export default db; é…ç½®ä¸­é—´ä»¶åˆ›å»ºmiddlewaresæ–‡ä»¶å¤¹ï¼Œæ”¾ç½®ä½¿ç”¨çš„ä¸­é—´ä»¶ è¡¨å•éªŒè¯ä¸­é—´ä»¶ï¼ˆvalidateInput.tsï¼‰ 123456789101112131415161718192021222324252627282930313233343536373839404142434445import &#123; Request, Response, NextFunction &#125; from &#x27;express&#x27;;const studentIdRegex = /^\\d&#123;10&#125;$/; // æ­£åˆ™è¡¨è¾¾å¼ç”¨äºéªŒè¯å­¦å·const emailRegex = /^[a-zA-Z0-9._%+-]+@ctbu\\.edu\\.cn$/; // æ­£åˆ™è¡¨è¾¾å¼ç”¨äºéªŒè¯é‚®ç®±export const validateRegistration = (req: Request, res: Response, next: NextFunction): void =&gt; &#123; const &#123; student_id, email, password &#125; = req.body; if (!student_id || !studentIdRegex.test(student_id)) &#123; res.status(400).json(&#123; message: &#x27;å­¦å·å¿…é¡»ä¸º10ä½æ•°å­—&#x27; &#125;); return; &#125; if (!email || !email.endsWith(&#x27;@ctbu.edu.cn&#x27;)) &#123; res.status(400).json(&#123; message: &#x27;é‚®ç®±å¿…é¡»ä»¥ @ctbu.edu.cn ç»“å°¾&#x27; &#125;); return; &#125; if (!password || password.length &lt; 6 || !/[A-Z]/.test(password) || !/[a-z]/.test(password) || !/\\d/.test(password)) &#123; res.status(400).json(&#123; message: &#x27;å¯†ç é•¿åº¦è‡³å°‘ä¸º6ä½ï¼Œå¹¶ä¸”åŒ…å«å¤§å°å†™å­—æ¯å’Œæ•°å­—&#x27; &#125;); return; &#125; // å¦‚æœéªŒè¯é€šè¿‡ï¼Œè°ƒç”¨ next() next();&#125;;export const validateLogin = (req: Request, res: Response, next: NextFunction): void =&gt; &#123; const &#123; loginInput, password &#125; = req.body; // æ£€æŸ¥æ˜¯å¦è¾“å…¥äº†å­¦å·æˆ–é‚®ç®± if (!loginInput || (!studentIdRegex.test(loginInput) &amp;&amp; !emailRegex.test(loginInput))) &#123; res.status(400).json(&#123; message: &#x27;å­¦å·æˆ–é‚®ç®±æ ¼å¼é”™è¯¯&#x27; &#125;); return; &#125; // æ£€æŸ¥æ˜¯å¦è¾“å…¥äº†å¯†ç  if (!password) &#123; res.status(400).json(&#123; message: &#x27;å¯†ç ä¸èƒ½ä¸ºç©º&#x27; &#125;); return; &#125; // å¦‚æœéªŒè¯é€šè¿‡ï¼Œè°ƒç”¨ next() next();&#125;; å®‰è£…å¯†ç åŠ å¯†åº“ (bcrypt) å’Œ JWT åº“123npm install bcrypt jsonwebtokennpm install @types/bcrypt --save-devnpm install @types/jsonwebtoken --save-dev bcrypt: ç”¨äºå¯†ç å“ˆå¸Œå’ŒéªŒè¯ã€‚ jsonwebtoken: ç”¨äºç”Ÿæˆå’ŒéªŒè¯ JWTã€‚ @types/bcrypt: bcrypt çš„ TypeScript ç±»å‹å®šä¹‰ã€‚ @types/jsonwebtoken: JWT çš„ TypeScript ç±»å‹å®šä¹‰ã€‚ ç”¨æˆ·æ³¨å†Œé€»è¾‘æ³¨æ„äº‹é¡¹åŠé—®é¢˜è§£å†³å¼€å‘ç¯å¢ƒå‡†å¤‡æœ¬é¡¹ç›®å¼€å‘å»ºè®®ä½¿ç”¨ä¸‹æ–¹çš„å¼€å‘è½¯ä»¶ï¼Œè¯·æå‰é…ç½®å¥½ä¸‹æ–¹æ‰€ç¤ºçš„å¼€å‘ç¯å¢ƒ å¼€å‘è½¯ä»¶ï¼šVS Codeï¼Œå¾®ä¿¡å¼€å‘è€…å·¥å…· å¼€å‘ç¯å¢ƒä¾èµ–ï¼š nodeï¼š18.17.0 npmï¼š10.8.2 pnpmï¼š9.1.0 ts-nodeï¼š10.9.2 nodemonï¼š3.1.0 å¯¼å…¥vueæ–‡ä»¶TSæŠ¥é”™é”™è¯¯ä¿¡æ¯æç¤ºï¼š TypeScript æ— æ³•æ‰¾åˆ°æ¨¡å— @/views/**/**.vue çš„å£°æ˜æ–‡ä»¶ï¼Œè¿™æ„å‘³ç€ TypeScript æ— æ³•æ¨æ–­è¯¥æ–‡ä»¶çš„ç±»å‹ï¼Œå› æ­¤é»˜è®¤å°†å…¶è§†ä¸º any ç±»å‹ã€‚ åŸå› ï¼šTypeScript é»˜è®¤ä¸æ”¯æŒ .vue æ–‡ä»¶çš„æ¨¡å—ç±»å‹è§£æï¼Œéœ€è¦æ‰‹åŠ¨æ·»åŠ ç±»å‹å£°æ˜æ–‡ä»¶ã€‚ è§£å†³æ–¹æ³•ï¼š 12345678/* env.d.ts *//// &lt;reference types=&quot;vite/client&quot; /&gt;declare module &#x27;*.vue&#x27; &#123; import type &#123; DefineComponent &#125; from &#x27;vue&#x27; // eslint-disable-next-line @typescript-eslint/no-explicit-any, @typescript-eslint/ban-types const component: DefineComponent&lt;&#123;&#125;, &#123;&#125;, any&gt; export default component&#125;","categories":[],"tags":[]},{"title":"æš‘å‡å­¦ä¹ ","slug":"æš‘å‡å­¦ä¹ ","date":"2024-08-02T06:22:19.784Z","updated":"2024-10-07T15:47:03.191Z","comments":true,"path":"2024/08/02/æš‘å‡å­¦ä¹ /","permalink":"http://eastyn7.github.io/2024/08/02/%E6%9A%91%E5%81%87%E5%AD%A6%E4%B9%A0/","excerpt":"","text":"TypeScriptJSå·²æœ‰çš„ç±»å‹ åŸå§‹ç±»å‹ï¼šnumber&#x2F;string&#x2F;boolean&#x2F;null&#x2F;undefined&#x2F;symbol å¯¹è±¡ç±»å‹ï¼šobjectï¼ˆæ•°ç»„ã€å¯¹è±¡ã€å‡½æ•°ç­‰å¯¹è±¡ï¼‰ TSæ–°å¢çš„ç±»å‹ è”åˆç±»å‹ã€è‡ªå®šä¹‰ç±»å‹ï¼ˆç±»å‹åˆ«åï¼‰ã€æ¥å£ã€å…ƒç¥–ã€å­—é¢é‡ç±»å‹ã€æšä¸¾ã€voidã€anyç­‰ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115// åŸå§‹ç±»å‹let age: number = 18let myName: string = &#x27;eee&#x27;let isLoading: boolean = truelet a: null = nulllet b: undefined = undefinedlet s: symbol = Symbol()// å¯¹è±¡ç±»å‹let numbers: number[] = [1,2,3]let strings: string[] = [&#x27;1&#x27;,&#x27;2&#x27;,&#x27;3&#x27;]let strings: Array&lt;string&gt; = [&#x27;1&#x27;,&#x27;2&#x27;,&#x27;3&#x27;]// è”åˆç±»å‹let arr: (number | string)[] = [&#x27;1&#x27;,1,&#x27;2&#x27;,2,&#x27;3&#x27;,3]// ç±»å‹åˆ«åtype CustomArray = (number | string)[]let arr1: CustomArray = [&#x27;1&#x27;,1,&#x27;2&#x27;,2,&#x27;3&#x27;,3]// å‡½æ•°ç±»å‹function add(num1: number, num2: number): number &#123; return num1 + num2&#125;const add = (num1: number, num2: number): number =&gt; &#123; return num1 + num2&#125;const add: (num1: number, num2: number) =&gt; number = (num1, num2) =&gt; &#123; return num1 + num2&#125;function greet(name: string): void &#123; console.log(&#x27;Hello&#x27;, name)&#125;// å¯é€‰å‚æ•°function mySlice(start?: number, end?: number): void &#123; console.log(&#x27;èµ·å§‹ç´¢å¼•ï¼š&#x27;, start, &#x27;ç»“æŸç´¢å¼•ï¼š&#x27;, end)&#125;// å¯¹è±¡ç±»å‹let person: &#123; name: string; age: number; &#125;// æ¥å£interface IPerson &#123; name: string age: number sayHi(): void&#125;let person: IPerson = &#123; name: &#x27;Jack&#x27;, age: 19, sayHi() &#123;&#125;&#125;/*æ¥å£ä¸ç±»å‹åˆ«åçš„å¯¹æ¯”ï¼šç›¸åŒç‚¹ï¼šéƒ½å¯ä»¥ç»™å¯¹è±¡æŒ‡å®šç±»å‹ä¸åŒç‚¹ï¼šæ¥å£åªèƒ½ä¸ºå¯¹è±¡æŒ‡å®šç±»å‹ï¼›ç±»å‹åˆ«åä¸ä»…å¯ä»¥ä¸ºå¯¹è±¡æŒ‡å®šç±»å‹ï¼Œå®é™…ä¸Šå¯ä»¥ä¸ºä»»æ„ç±»å‹æŒ‡å®šåˆ«å*/type IPerson = &#123; name: string age: number sayHi(): void&#125;type NumStr = number |string// æ¥å£çš„ç»§æ‰¿interface Point2D &#123; x: number; y: number &#125;interface Point3D extends Point2D &#123; z: number &#125;// å…ƒç»„let position: [number, number] = [0.11, 0.22]// ç±»å‹æ–­è¨€const aLink: HTMLAnchorElementconst aLink = document.getElementByID(&#x27;link&#x27;) as HTMLAnchorElement// const aLink = &lt;HTMLAnchorElement&gt;document.getELementById(&#x27;link&#x27;)ã€ä¸å¸¸ç”¨ï¼Œè·Ÿreactæœ‰å†²çªã€‘// å­—é¢é‡ç±»å‹let str1 = &#x27;Hello TS&#x27; // stringï¼›letå£°æ˜å˜é‡const str2 = &#x27;Hello TS&#x27; // &quot;Hello TS&quot;ï¼›constå£°æ˜å¸¸é‡// ç”¨æ¥è¡¨ç¤ºä¸€ç»„æ˜ç¡®çš„å¯é€‰å€¼åˆ—è¡¨function changeDirection(directin: &#x27;up&#x27; | &#x27;down&#x27; | &#x27;left&#x27; | &#x27;right&#x27;)&#123; console.log(direction)&#125;// æšä¸¾(enum)enum Direction &#123; Up, Down, Left, Right &#125;function changeDirection(directin: Direction)&#123; console.log(direction)&#125;changeDirection(Direction.Left)/*æšä¸¾æˆå‘˜çš„å€¼é»˜è®¤ç¬¬ä¸€ä¸ªä¸º0ä¾æ¬¡å¢åŠ ï¼Œä¹Ÿå¯ä»¥è‡ªå®šä¹‰å€¼ã€é»˜è®¤æ•°å­—ï¼Œä¹Ÿå¯ä»¥ä¸ºå­—ç¬¦ä¸²ã€‘enum Direction &#123; Up = 10, Down, Left, Right &#125;enum Direction &#123; Up = 2, Down = 4, Left = 8, Right = 16 &#125;*/// å­—ç¬¦ä¸²æšä¸¾enum Direction &#123; Up = &#x27;UP&#x27;, Down = &#x27;DOWN&#x27;, Left = &#x27;LEFT&#x27;, Right = &#x27;RIGHT&#x27; &#125;// anyç±»å‹let obj: any = &#123; x: 0 &#125;// typeofconsole.log(typeof &quot;Hello world&quot;)// æ ¹æ®ç±»å‹ä¸Šä¸‹æ–‡æ¥let p = &#123; x: 1, y: 2 &#125;function formatPoint(point: &#123; x: number; y: number&#125;)&#123;&#125;formatPoint(p)function formatPoint(point: typeof p) TSé«˜çº§ç±»å‹ classç±»ã€ç±»å‹å…¼å®¹æ€§ã€äº¤å‰ç±»å‹ã€æ³›å‹å’Œkeyofã€ç´¢å¼•ç­¾åç±»å‹å’Œç´¢å¼•æŸ¥è¯¢ç±»å‹ã€æ˜ å°„ç±»å‹ç­‰ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182// classç±»class Person&#123; age: number // gender: &#x27;ç”·&#x27; gender: string x = 10 y = 10 // æ„é€ å‡½æ•° constructor(age: number, gender: string)&#123; this.age = age this.gender = gender &#125; // å®ä¾‹æ–¹æ³• scale(n: number): void &#123; this.x *= n this.y *= n &#125;&#125;const p = new Person()p.age// ç±»ç»§æ‰¿class Animal &#123; move() &#123; console.log(&#x27;Moving along!&#x27;) &#125;&#125;class Dog extends Animal &#123; bark() &#123; console.log(&#x27;wang!&#x27;) &#125;&#125;const dog = new Dog()// æ¥å£interface Singable &#123; sing(): void&#125;class Person implements Singable &#123; sing() &#123; console.log(&#x27;asdfadf&#x27;) &#125;&#125;// ä¿®é¥°ç¬¦publicprotectedprivatereadonlyï¼šè¡¨ç¤ºåªè¯»ï¼Œåªèƒ½è¢«æ„é€ å‡½æ•°è¿›è¡Œèµ‹å€¼// ç±»å‹å…¼å®¹æ€§å¯¹è±¡å…¼å®¹ï¼šæˆå‘˜å¤šçš„èµ‹å€¼ç»™æˆå‘˜å°‘çš„æ¥å£å…¼å®¹ï¼šå¤šçš„èµ‹å€¼ç»™å°‘çš„å‡½æ•°å…¼å®¹ï¼šå‚æ•°ä¸ªæ•°å°‘çš„èµ‹å€¼ç»™å‚æ•°ä¸ªæ•°å¤šçš„ï¼›å‚æ•°ç±»å‹å¯¹åº”ä¸€è‡´ï¼›è¿”å›å€¼å¤šçš„èµ‹å€¼ç»™å°‘çš„// äº¤å‰ç±»å‹ï¼ˆ&amp;ï¼‰interface Person &#123; name: string &#125;interface Contact &#123; phone: string &#125;type PersonDetail = Person &amp; Contactlet obj = PersonDetail = &#123; name: &#x27;Jack&#x27;, phone: &#x27;123...&#x27;&#125;/*äº¤å‰ç±»å‹å’Œæ¥å£ç»§æ‰¿çš„å¯¹æ¯”ç›¸åŒç‚¹ï¼šéƒ½å¯ä»¥å®ç°å¯¹è±¡ç±»å‹çš„ç»„åˆä¸åŒç‚¹ï¼šä¸¤ç§æ–¹å¼å®ç°ç±»å‹ç»„åˆæ—¶ï¼Œå¯¹äºåŒåå±æ€§ä¹‹é—´ï¼Œå¤„ç†ç±»å‹å†²çªçš„æ–¹å¼ä¸åŒã€‚ç»§æ‰¿ä¼šæŠ¥é”™ä½†æ˜¯äº¤å‰ç±»å‹ä¸ä¼šinterface A &#123; fn: (value: number) =&gt; string&#125;interface B extends A &#123; fn: (value: string) =&gt; string&#125;è¿™é‡Œæ˜¯é”™è¯¯çš„interface A &#123; fn: (value: number) =&gt; string&#125;interface B &#123; fn: (value: string) =&gt; string&#125;type C = A &amp; B ç›¸å½“äº åœ¨Cä¸­fn: (value: string | number) =&gt; string*/// æ³›å‹function id&lt;Type&gt;(value: Type): Type &#123; return value &#125;const num = id&lt;number&gt;(10) // æ­¤æ—¶numçš„ç±»å‹å³ä¸ºnumberconst str = id&lt;string&gt;(&#x27;str&#x27;) // æ­¤æ—¶strçš„ç±»å‹å³ä¸ºstringlet num = id(10) // å¯ä»¥ç®€åŒ–ä¸ç”¨å†™&lt;&gt;ï¼Œä¼šæ¨æ–­ä¸ºå­—é¢é‡ç±»å‹// æ³›å‹çº¦æŸ/*æŒ‡å®šæ›´åŠ å…·ä½“çš„ç±»å‹*/function id&lt;Type&gt;(value: Type[]): Type[] &#123; console.log(value.length) return value&#125;/*æ·»åŠ çº¦æŸ*//*åªè¦æœ‰lengthå±æ€§å°±å¯ä»¥*/interface ILength &#123; length: number &#125;function id&lt;Type extedns ILength&gt;(value: Type): Type &#123; console.log(value.length) return value&#125;// å¤šä¸ªæ³›å‹å˜é‡çš„æƒ…å†µfunction getProp&lt;Type, Key extends keyof Type&gt;(obj: Type, key: Key)&#123; return obj[key]&#125;let person = &#123; name: &#x27;Jack&#x27;, age: 18 &#125;getProp(person, &#x27;name&#x27;)// æ³›å‹æ¥å£interface IdFunc&lt;Type&gt; &#123; id: (value: Type) =&gt; Type ids: () =&gt; Type[]&#125;let obj: IdFunc&lt;number&gt; &#123; id(value) &#123; return value &#125;, ids() &#123; return [1, 3, 5] &#125;&#125;// æ³›å‹ç±»class GenericNumber&lt;NumType&gt; &#123; defaultValue: NumType add: (x: NumType, y: NumType) =&gt; NumType&#125;const myNum = new GenericNumber&lt;number&gt;()// æ³›å‹å·¥å…·ç±»å‹ï¼ˆPartialï¼‰/*æ„é€ å‡ºæ¥çš„æ–°ç±»å‹PartialPropsç»“æ„å’ŒPropsç›¸åŒï¼Œä½†æ‰€æœ‰å±æ€§éƒ½å˜ä¸ºæ˜¯å¯é€‰çš„*/interface Props &#123; id: string children: number[]&#125;type PartialProps = Partial&lt;Props&gt;// æ³›å‹å·¥å…·ç±»å‹ï¼ˆReadonlyï¼‰/*æ„é€ ä¸€ä¸ªæ‰€æœ‰å±æ€§ä¸ºåªè¯»çš„ç±»å‹*/interface Props &#123; id: string children: number[]&#125;type ReadonlyProps = Readonly&lt;Props&gt;// æ³›å‹å·¥å…·ç±»å‹ï¼ˆPickï¼‰/*Pick&lt;Type,Keys&gt;ä»Typeä¸­é€‰æ‹©ä¸€ç»„å±æ€§æ¥æ„é€ æ–°ç±»å‹*/interface Props &#123; id: string title: string children: number[]&#125;type PickProps = Pick&lt;Props, &#x27;id&#x27; | &#x27;title&#x27;&gt;// æ³›å‹å·¥å…·ç±»å‹ï¼ˆRecordï¼‰/*Record&lt;Keys,Type&gt;æ„é€ ä¸€ä¸ªæ–°å¯¹è±¡ç±»å‹ï¼Œå±æ€§é”®ä¸ºKeysï¼Œå±æ€§ç±»å‹ä¸ºType*/type RecordObj = Record&lt;&#x27;a&#x27; | &#x27;b&#x27; | &#x27;c&#x27;, string[]&gt;let obj: RecordObj = &#123; a: [&#x27;1&#x27;], b: [&#x27;2&#x27;], c: [&#x27;3&#x27;]&#125;// ç´¢å¼•ç­¾åç±»å‹interface AnyObject &#123; [key: steing]: number&#125;let obj: AnyObject = &#123; a: 1, b: 2&#125; // æ˜ å°„ç±»å‹/*åŸºäºæ—§ç±»å‹åˆ›å»ºæ–°ç±»å‹ï¼Œåªèƒ½åœ¨ç±»å‹åˆ«åä¸­ä½¿ç”¨*/type PropKeys = &#x27;x&#x27; | &#x27;y&#x27; | &#x27;z&#x27;type Type = &#123; [Key in PropKeys]: number &#125;type Props = &#123; a: number; b: string; c: boolean &#125;type Type = &#123; [Key in keyof Props]: number &#125;// ç´¢å¼•æŸ¥è¯¢ç±»å‹/*T[P]è¯­æ³•ç”¨æ¥æŸ¥è¯¢å±æ€§çš„ç±»å‹*/type Props = &#123; a: number; b: string; c: boolean &#125;type TypeA = Props[&#x27;a&#x27;]//numbertype TypeA = Props[&#x27;a&#x27; | &#x27;b&#x27;]//number|stringtype TypeA = Props[keyof Props]//number|string|boolean TSä¸­çš„æ–‡ä»¶ç±»å‹ .tsæ–‡ä»¶ æ—¢åŒ…å«ç±»å‹ä¿¡æ¯åˆå¯æ‰§è¡Œä»£ç  å¯ä»¥è¢«ç¼–è¯‘ä¸º.jsæ–‡ä»¶ç„¶åæ‰§è¡Œ ç”¨é€”ï¼šç¼–å†™ç¨‹åºä»£ç çš„åœ°æ–¹ .d.tsæ–‡ä»¶ï¼ˆç±»ä¼¼äºC++ä¸­çš„å¤´æ–‡ä»¶ï¼‰ åªåŒ…å«ç±»å‹ä¿¡æ¯çš„ç±»å‹å£°æ˜æ–‡ä»¶ ä¸ä¼šç”Ÿæˆ.jsæ–‡ä»¶ï¼Œä»…ç”¨äºæä¾›ç±»å‹ä¿¡æ¯ ç”¨é€”ï¼šä¸ºjsæä¾›ç±»å‹ä¿¡æ¯ //ä¸ºjsæ–‡ä»¶æä¾›ç±»å‹å£°æ˜ /* åœ¨jsæ–‡ä»¶ä¸­å·²å­˜åœ¨å¦‚ä¸‹çš„å†…å®¹ let count = 10 let songName = &#39;ç—´å¿ƒç»å¯¹&#39; let position = &#123; x: 0, y: 0 &#125; function add(x,y) &#123; retrun x+y &#125; function changeDirection(direction)&#123; console.log(direction) &#125; const fomartPoint = point =&gt; &#123; console.log(&#39;å½“å‰åæ ‡:&#39;, point) &#125; export &#123;count, songName, position, add, changeDirection&#125; */ declare let count: number declare let someName: string interface Point &#123; x: number y: number &#125; declare let positon: Point declare function add(x: mumber, y: number): number declare function changeDirection(direction: &#39;up&#39;|&#39;down&#39;|&#39;left&#39;|&#39;right&#39;):void type FomartPoint = (point: Point) =&gt; void declare const fomartPoint: FomartPoint // declare const fomartPoint: (point: Point) =&gt; void export &#123;count, songName, position, add, changeDirection&#125; SSMSpring1.Spring Frameworkç³»ç»Ÿæ¶æ„ Core Container : æ ¸å¿ƒå®¹å™¨ AOP : é¢å‘åˆ‡é¢ç¼–ç¨‹ Aspects : AOPæ€æƒ³å®ç° Data Access : æ•°æ®è®¿é—® Data Integration : æ•°æ®é›†æˆ Web : Webå¼€å‘ Test : å•å…ƒæµ‹è¯•ä¸é›†æˆæµ‹è¯• IoCï¼ˆInversion of Controlï¼‰æ§åˆ¶åè½¬ï¼šä½¿ç”¨å¯¹è±¡äº‹ï¼Œç”±ä¸»åŠ¨newäº§ç”Ÿå¯¹è±¡è½¬æ¢ä¸ºç”±å¤–éƒ¨æä¾›å¯¹è±¡ï¼Œæ­¤è¿‡ç¨‹ä¸­å¯¹è±¡åˆ›å»ºæ§åˆ¶æƒç”±ç¨‹åºè½¬ç§»åˆ°å¤–éƒ¨ï¼Œæ­¤æ€æƒ³ç§°ä¸ºæ§åˆ¶åè½¬ Springæä¾›äº†ä¸€ä¸ªå®¹å™¨ï¼Œç§°ä¸ºIoCå®¹å™¨ï¼Œç”¨æ¥å……å½“IoCæ€æƒ³ä¸­çš„â€œå¤–éƒ¨â€ IoCå®¹å™¨è´Ÿè´£å¯¹è±¡çš„åˆ›å»ºã€åˆå§‹åŒ–ç­‰ä¸€ç³»åˆ—å·¥ä½œï¼Œè¢«åˆ›å»ºæˆ–è¢«ç®¡ç†çš„å¯¹è±¡åœ¨IoCå®¹å™¨ä¸­ç»Ÿç§°ä¸ºBean DIï¼ˆDependency Injectionï¼‰ä¾èµ–æ³¨å…¥ï¼šåœ¨å®¹å™¨ä¸­å»ºç«‹beanä¸beanä¹‹é—´çš„ä¾èµ–å…³ç³»çš„æ•´ä¸ªè¿‡ç¨‹ï¼Œç§°ä¸ºä¾èµ–æ³¨å…¥ 2.bean ç±»åˆ« æè¿° åç§° bean ç±»å‹ æ ‡ç­¾ æ‰€å± beansæ ‡ç­¾ æ ¼å¼ å±æ€§åˆ—è¡¨ idï¼šbeançš„idï¼Œä½¿ç”¨å®¹å™¨å¯ä»¥é€šè¿‡idå€¼è·å–å¯¹åº”çš„beanï¼Œåœ¨ä¸€ä¸ªå®¹å™¨ä¸­idå€¼å”¯ä¸€classï¼šbeançš„ç±»å‹ï¼Œå³é…ç½®çš„beançš„å…¨è·¯å¾„ç±»ånameï¼šbeançš„åˆ«åï¼Œå¯ä»¥æœ‰å¤šåç§°ï¼Œç©ºæ ¼åˆ†å¼€scopeï¼šbeançš„ä½œç”¨èŒƒå›´ï¼Œå¯ä»¥æ§åˆ¶åˆ›å»ºå®ä¾‹çš„æ•°é‡ï¼Œæ˜¯å¦æ˜¯å•ä¾‹çš„å¯¹è±¡ï¼Œå¯é€‰èŒƒå›´ã€singletonï¼ˆå•ä¾‹é»˜è®¤ï¼‰ã€prototypeï¼ˆéå•ä¾‹ï¼‰ã€‘init-methodï¼šbeanåˆå§‹åŒ–æ–¹æ³•destroy-methodï¼šbeançš„é”€æ¯æ–¹æ³• èŒƒä¾‹ å®ä¾‹åŒ– æ„é€ å‡½æ•°ï¼šä½¿ç”¨é™æ€å·¥å‚ï¼šä½¿ç”¨å®ä¾‹å·¥å‚ï¼š ç”Ÿå‘½å‘¨æœŸ é˜¶æ®µï¼š1ã€åˆå§‹åŒ–å®¹å™¨ï¼šâ‘ åˆ›å»ºå¯¹è±¡ï¼ˆå†…å­˜åˆ†é…ï¼‰â‘¡æ‰§è¡Œæ„é€ æ–¹æ³•â‘¢æ‰§è¡Œå±æ€§æ³¨å…¥ï¼ˆsetæ“ä½œï¼‰â‘£æ‰§è¡Œbeanåˆå§‹åŒ–æ–¹æ³•2ã€ä½¿ç”¨beanï¼šâ‘ æ‰§è¡Œä¸šåŠ¡æ“ä½œ3ã€å…³é—­&#x2F;é”€æ¯å®¹å™¨ï¼šâ‘ æ‰§è¡Œbeané”€æ¯æ–¹æ³•pbulic class BookDaoImpl implements BookDao { &#x2F;&#x2F; è¡¨ç¤ºbeanåˆå§‹åŒ–å¯¹åº”çš„æ“ä½œ public void init(){ System.out.println(â€œinitâ€¦â€) } &#x2F;&#x2F; è¡¨ç¤ºbeané”€æ¯å‰å¯¹åº”çš„æ“ä½œ ã€ éœ€è¦å…³é—­å®¹å™¨ï¼š â‘ æ‰‹å·¥å…³é—­å®¹å™¨ï¼šConfigurableApplicationContextæ¥å£close()æ“ä½œ â‘¡æ³¨å†Œå…³é—­é’©å­ï¼Œåœ¨è™šæ‹Ÿæœºé€€å‡ºå‰å…ˆå…³é—­å®¹å™¨å†é€€å‡ºè™šæ‹Ÿæœºï¼šConfigurableApplicationContextæ¥å£registerShutdownHook()æ“ä½œ ã€‘ public void destory{ System.out.println(â€œdestoryâ€¦â€) }}&#x2F;&#x2F; éœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­è¿›è¡Œé…ç½®ã€ä¹Ÿå¯ä»¥ä½¿ç”¨æ¥å£æ§åˆ¶ç”Ÿå‘½å‘¨æœŸï¼ŒInitializingBeanï¼ŒDisposableBeanæ¥å£ã€‘ 3.ä¾èµ–æ³¨å…¥ setteræ³¨å…¥ æ„é€ å™¨æ³¨å…¥ è‡ªåŠ¨è£…é…ï¼š æ–¹å¼ï¼šæŒ‰ç±»å‹ï¼ˆå¸¸ç”¨ï¼‰ã€æŒ‰åç§°ã€æŒ‰æ„é€ æ–¹æ³•ã€ä¸å¯ç”¨è‡ªåŠ¨è£…é… 4.é›†åˆæ³¨å…¥","categories":[],"tags":[]},{"title":"Expresså…¥é—¨","slug":"expresså…¥é—¨","date":"2024-02-22T08:30:19.690Z","updated":"2024-10-07T15:46:52.579Z","comments":true,"path":"2024/02/22/expresså…¥é—¨/","permalink":"http://eastyn7.github.io/2024/02/22/express%E5%85%A5%E9%97%A8/","excerpt":"","text":"expresså…¥é—¨ç®€ä»‹ä½œä¸ºå‰ç«¯å¼€å‘ï¼ŒNodejså·²ç»æˆäº†å¾ˆå¤šå…¬å¸å¯¹æˆ‘ä»¬è¿™ä¸€å²—ä½çš„ç¡¬æ€§è¦æ±‚ï¼Œè€Œ Express æ¡†æ¶åˆ™æ˜¯å…¶ä¸­çŸ¥ååº¦æœ€é«˜ã€ä¹Ÿæ˜¯æœ€å—æ¬¢è¿çš„Nodejså¼€å‘æ¡†æ¶ï¼Œå®ƒå¸®åŠ©æˆ‘ä»¬å°è£…äº†Nodejsåº•å±‚çš„APIï¼Œå±è”½äº†å¤§é‡çš„ç¹ççš„ç»†èŠ‚ï¼Œè®©æˆ‘ä»¬åªéœ€è¦å…³æ³¨ä¸šåŠ¡å¼€å‘å°±è¡Œäº†ï¼Œæå¤§çš„é™ä½äº†å­¦ä¹ çš„æˆæœ¬ã€‚ä»Šå¤©è¿™ä¸ªè¯¾ç¨‹å°±æ˜¯æ•™å¤§å®¶å»æŒæ¡å¦‚ä½•ä½¿ç”¨expresså»æ­å»ºä¸€ä¸ªç®€æ˜“çš„åç«¯æœåŠ¡ï¼Œæˆ‘ä»¬ä¸»è¦å›´ç»•ä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ï¼š è·¯ç”± ä¸­é—´ä»¶ é™æ€æ–‡ä»¶æœåŠ¡ æ¨¡æ¿å¼•æ“ ç¯å¢ƒå‡†å¤‡ ç”µè„‘ - mac Node - 16.14.2 Npm - 8.5.0 Express - 4.x ç¬¬ä¸€ä¸ªdemoä½¿ç”¨Nodejså†…ç½®çš„httpæ¨¡å—æ­å»ºæœåŠ¡ä¸ºäº†ä¾¿äºå¤§å®¶å»ç†è§£expresså¯¹nodejsåšäº†å“ªäº›å°è£…ï¼Œåœ¨ä½¿ç”¨expressä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹ä¸‹ä½¿ç”¨nodejså†…ç½®çš„httpæ¨¡å—æ˜¯æ€ä¹ˆæ­å»ºnodeæœåŠ¡çš„ã€‚ é¦–å…ˆåˆ›å»ºä¸€ä¸ªexpress-demoçš„æ–‡ä»¶å¤¹å¹¶è¿›å…¥ 1mkdir express-demo &amp;&amp; cd express-demo åˆ›å»ºserver.jsï¼Œå¹¶æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š 1234567891011const http = require(&#x27;http&#x27;)const server = http.createServer((req, res) =&gt; &#123; res.statusCode = 200 res.setHeader(&#x27;Content-Type&#x27;, &#x27;text/html&#x27;) res.end(&#x27;hello world&#x27;)&#125;)server.listen(3000, () =&gt; &#123; console.log(&#x27;æœåŠ¡å·²å¯åŠ¨...&#x27;);&#125;) ç„¶ååœ¨æ§åˆ¶å°ä¸­è¿è¡Œï¼š 1node server.js ä½¿ç”¨expressæ­å»ºæœåŠ¡æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å†ç”¨expressæ­å»ºæœåŠ¡ã€‚ åœ¨ express-demo æ–‡ä»¶å¤¹ä¸‹æ‰§è¡Œ npm init å‘½ä»¤ï¼Œç„¶åä¸€è·¯å›è½¦ï¼Œå°±ä¼šå¸®æˆ‘ä»¬åˆ›å»ºä¸€ä¸ª package.json æ–‡ä»¶ï¼Œç„¶åå†æ‰§è¡Œ npm install express æ¥å®‰è£…expressæ¨¡å—ï¼Œç„¶åæ”¹å†™ server.js ã€‚ 1234567891011const express = require(&#x27;express&#x27;)const app = express()app.get(&#x27;/&#x27;, (req, res) =&gt; &#123; res.send(&#x27;hello world&#x27;)&#125;)app.listen(3000, () =&gt; &#123; console.log(&#x27;æœåŠ¡å·²å¯åŠ¨...&#x27;);&#125;) Requestå’ŒResponseå¯¹è±¡ Requestå¯¹è±¡æ˜¯è¯·æ±‚å¯¹è±¡ï¼Œå°±æ˜¯å›è°ƒå‡½æ•°ä¸­çš„reqå‚æ•°ï¼Œä¸»è¦æ˜¯ç½‘ç»œè¯·æ±‚ä¸­å¸¦çš„ä¸€äº›å±æ€§ï¼Œæ¯”å¦‚å‚æ•°, cookieç­‰ç­‰ã€‚ã€‚ã€‚ Responseå¯¹è±¡æ˜¯å“åº”å¯¹è±¡ï¼Œå°±æ˜¯å›è°ƒå‡½æ•°ä¸­çš„reså‚æ•°ï¼Œå¯ä»¥æ‰§è¡Œä¸€ç³»åˆ—çš„å“åº”æ“ä½œï¼Œæ¯”å¦‚ç»™å®¢æˆ·ç«¯å“åº”å†…å®¹å’ŒçŠ¶æ€ç­‰ç­‰ã€‚ã€‚ã€‚ æŸ¥çœ‹Requestå’ŒResponseå¯¹è±¡çš„æ‰€æœ‰API è·¯ç”±æœºåˆ¶æ€è€ƒï¼šæˆ‘ä»¬åœ¨å‘åç«¯å‘è¯·æ±‚æ—¶é€šè¿‡ä»€ä¹ˆå»åŒºåˆ†æ¥å£çš„ï¼Ÿ ç­”ï¼šè¯·æ±‚æ–¹å¼+æ¥å£url æˆ‘ä»¬åœ¨expressä¸­ï¼Œå®šä¹‰è·¯ç”±çš„æ–¹å¼æ˜¯ï¼š 1app.METHOD(URL, CALLBACK) è¿™ç§æ–¹å¼å°±å¯ä»¥é€šè¿‡è¯·æ±‚æ–¹å¼å’ŒURLæ¥å¸®æˆ‘ä»¬åŒºåˆ†ä¸åŒçš„è¯·æ±‚ï¼Œä»è€Œå»æ‰§è¡Œä¸åŒçš„å“åº”ã€‚ nodemonnodemonèƒ½å¤Ÿæ£€æµ‹å·¥ä½œåŒºä»£ç çš„å˜åŒ–ï¼Œå¹¶è‡ªåŠ¨é‡å¯ã€‚ æ‰§è¡Œ npm install nodemon --save-dev å®‰è£…nodemonï¼Œç„¶åä¿®æ”¹package.jsonæ–‡ä»¶ä¸­çš„startå‘½ä»¤ï¼š 123456789101112131415161718&#123; &quot;name&quot;: &quot;express-demo&quot;, &quot;version&quot;: &quot;1.0.0&quot;, &quot;description&quot;: &quot;&quot;, &quot;main&quot;: &quot;server.js&quot;, &quot;scripts&quot;: &#123; &quot;test&quot;: &quot;echo \\&quot;Error: no test specified\\&quot; &amp;&amp; exit 1&quot;, &quot;start&quot;: &quot;nodemon server.js&quot; &#125;, &quot;author&quot;: &quot;&quot;, &quot;license&quot;: &quot;ISC&quot;, &quot;dependencies&quot;: &#123; &quot;express&quot;: &quot;^4.18.2&quot; &#125;, &quot;devDependencies&quot;: &#123; &quot;nodemon&quot;: &quot;^2.0.20&quot; &#125;&#125; å†æ‰§è¡Œnpm startå¯åŠ¨æœåŠ¡ï¼Œä¹‹åæˆ‘ä»¬å†ä¿®æ”¹ä»£ç å°±ä¸éœ€è¦æ‰‹åŠ¨çš„é‡å¯æœåŠ¡äº†ã€‚ æ ¸å¿ƒæ¦‚å¿µè·¯ç”±åœ¨æµè§ˆå™¨ä¸­æˆ‘ä»¬æƒ³è¦è®¿é—®ç™¾åº¦ï¼Œåªéœ€è¦çŸ¥é“ç™¾åº¦çš„åœ°å€å°±è¡Œäº†ï¼Œè·¯ç”±ä¹Ÿæ˜¯ç±»ä¼¼çš„æ¦‚å¿µï¼Œæˆ‘ä»¬æƒ³è¦çŸ¥é“å®¢æˆ·ç«¯è°ƒç”¨çš„æ˜¯å“ªä¸ªæ¥å£ï¼Œå°±æ˜¯é€šè¿‡è·¯ç”±æ¥åˆ¤æ–­çš„ã€‚ è·¯ç”±æ–¹æ³•Express æ”¯æŒå¯¹åº”äº HTTP æ–¹æ³•çš„ä»¥ä¸‹è·¯ç”±æ–¹æ³•ï¼šgetã€postã€putã€deleteç­‰ç­‰ã€‚ä½¿ç”¨æ–¹æ³•ä¸ºï¼š 1app.METHOD(URL, CALLBACK) ç¤ºä¾‹ï¼š 1234567891011const express = require(&#x27;express&#x27;)const app = express()app.get(&#x27;/&#x27;, (req, res) =&gt; &#123; res.send(&#x27;hello world&#x27;)&#125;)app.post(&#x27;/about&#x27;, (req, res) =&gt; &#123; res.send(&#123; name: &#x27;å°æ˜&#x27;, age: 18 &#125;)&#125;) æœ‰ä¸€ç§ç‰¹æ®Šè·¯ç”±æ–¹æ³•ï¼šapp.all()ï¼Œè¯¥æ–¹æ³•ç”¨äºåœ¨æ‰€æœ‰è¯·æ±‚æ–¹æ³•çš„è·¯å¾„ä¸­è£…å…¥ä¸­é—´ä»¶å‡½æ•°ã€‚ 123456app.all(&#x27;/about&#x27;, function(req, res) &#123; res.send(&#123; name: &#x27;jackie&#x27;, age: 18 &#125;)&#125;) è¿™ä¸ªç¤ºä¾‹ä¸­ä¸ç®¡æ˜¯get, postæ–¹å¼å»è¯·æ±‚/aboutè·¯å¾„çš„æ¥å£ï¼Œéƒ½ä¼šç»è¿‡è¿™ä¸ªå›è°ƒå‡½æ•°ç„¶åè¿”å›å¯¹åº”çš„æ•°æ®ã€‚ è·¯ç”±è·¯å¾„è·¯ç”±è·¯å¾„å¯ä»¥æ˜¯å­—ç¬¦ä¸²ã€å­—ç¬¦ä¸²æ¨¡å¼æˆ–æ­£åˆ™è¡¨è¾¾å¼ã€‚å­—ç¬¦ä¸²ç±»å‹çš„å°±æ˜¯æˆ‘ä»¬ä¹‹å‰ä¸¾çš„é‚£äº›ä¾‹å­ï¼Œæˆ‘ä»¬å†æ¥çœ‹ä¸‹å­—ç¬¦ä¸²æ¨¡å¼å’Œæ­£åˆ™è¡¨è¾¾å¼è¿™ä¸¤ç§ã€‚ ä»¥ä¸‹æ˜¯åŸºäºå­—ç¬¦ä¸²æ¨¡å¼çš„è·¯ç”±è·¯å¾„çš„ä¸€äº›ç¤ºä¾‹ã€‚ æ­¤è·¯ç”±è·¯å¾„å°†åŒ¹é… acd å’Œ abcdã€‚ 123app.get(&#x27;/ab?cd&#x27;, function(req, res) &#123; res.send(&#x27;ab?cd&#x27;);&#125;); æ­¤è·¯ç”±è·¯å¾„å°†åŒ¹é… abcdã€abbcdã€abbbcd ç­‰ã€‚ 123app.get(&#x27;/ab+cd&#x27;, function(req, res) &#123; res.send(&#x27;ab+cd&#x27;);&#125;); æ­¤è·¯ç”±è·¯å¾„å°†åŒ¹é… abcdã€abxcdã€abRABDOMcdã€ab123cd ç­‰ã€‚ 123app.get(&#x27;/ab*cd&#x27;, function(req, res) &#123; res.send(&#x27;ab*cd&#x27;);&#125;); åŸºäºæ­£åˆ™è¡¨è¾¾å¼çš„è·¯ç”±è·¯å¾„çš„ç¤ºä¾‹ï¼š æ­¤è·¯ç”±è·¯å¾„å°†åŒ¹é…åç§°ä¸­å…·æœ‰â€œaâ€çš„æ‰€æœ‰è·¯ç”±ã€‚ 123app.get(/a/, function(req, res) &#123; res.send(&#x27;/a/&#x27;);&#125;); æ­¤è·¯ç”±è·¯å¾„å°†åŒ¹é… butterfly å’Œ dragonflyï¼Œä½†æ˜¯ä¸åŒ¹é… butterflymanã€dragonfly man ç­‰ã€‚ 123app.get(/.*fly$/, function(req, res) &#123; res.send(&#x27;/.*fly$/&#x27;);&#125;); è·¯ç”±æ‹†åˆ†å½“æˆ‘ä»¬çš„è·¯ç”±è¶Šæ¥è¶Šå¤æ‚ï¼Œæ¯”å¦‚æœ‰ç”¨æˆ·ç›¸å…³çš„è·¯å¾„ï¼Œæœ‰ç³»ç»Ÿç›¸å…³çš„è·¯å¾„ï¼Œä¸ç»Ÿä¸€ç®¡ç†çš„è¯ä¼šæ˜¾å¾—ç‰¹åˆ«ä¹±ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œå¯¹è·¯ç”±è¿›è¡Œæ‹†åˆ†æ˜¯ä¸ªä¸é”™çš„é€‰æ‹©ã€‚ æ‹†åˆ†å‰ 123456789101112const express = require(&#x27;express&#x27;);const app = express();app.get(&#x27;/user/list&#x27;, function(req, res, next)&#123; res.send(&#x27;/list&#x27;);&#125;);app.get(&#x27;/user/detail&#x27;, function(req, res, next)&#123; res.send(&#x27;/detail&#x27;);&#125;);app.listen(3000); æ‹†åˆ†å 12345678910111213141516const express = require(&#x27;express&#x27;);const app = express();const user = express.Router();user.get(&#x27;/list&#x27;, function(req, res, next)&#123; res.send(&#x27;/list&#x27;);&#125;);user.get(&#x27;/detail&#x27;, function(req, res, next)&#123; res.send(&#x27;/detail&#x27;);&#125;);app.use(&#x27;/user&#x27;, user); // æ³¨å†Œuserå­è·¯ç”±app.listen(3000); ä¸­é—´ä»¶ä¸€èˆ¬å­¦ä¹ jsçš„æ—¶å€™ï¼Œæˆ‘ä»¬éƒ½ä¼šå¬åˆ°ä¸€å¥è¯ï¼šä¸€åˆ‡çš†å‡½æ•°ã€‚è€Œåœ¨å­¦ä¹ expressçš„è¿‡ç¨‹ä¸­ï¼Œå¾ˆæ·±çš„ä¸€ä¸ªæ„Ÿå—å°±æ˜¯ï¼šä¸€åˆ‡çš†ä¸­é—´ä»¶ã€‚æ¯”å¦‚å¸¸è§çš„è¯·æ±‚å‚æ•°è§£æã€cookieè§£æã€æ—¥å¿—æ‰“å°ç­‰ï¼Œéƒ½å¯ä»¥é€šè¿‡ä¸­é—´ä»¶æ¥å®Œæˆã€‚ åœ¨ Express ä¸­ï¼Œä¸­é—´ä»¶å°±æ˜¯ä¸€ä¸ªå‡½æ•°ï¼š 1234function someMiddleware(req, res, next) &#123; // è‡ªå®šä¹‰é€»è¾‘ next();&#125; ä¸‰ä¸ªå‚æ•°ä¸­ï¼Œreq å’Œ res å°±æ˜¯å‰é¢æåˆ°çš„ Request è¯·æ±‚å¯¹è±¡å’Œ Response å“åº”å¯¹è±¡ï¼›è€Œ next å‡½æ•°åˆ™ç”¨æ¥è§¦å‘ä¸‹ä¸€ä¸ªä¸­é—´ä»¶çš„æ‰§è¡Œã€‚ åœ¨ Express ä½¿ç”¨ä¸­é—´ä»¶æœ‰ä¸¤ç§æ–¹å¼ï¼šå…¨å±€ä¸­é—´ä»¶å’Œè·¯ç”±ä¸­é—´ä»¶ã€‚ å…¨å±€ä¸­é—´ä»¶é€šè¿‡ app.use å‡½æ•°å°±å¯ä»¥æ³¨å†Œä¸­é—´ä»¶ï¼Œå¹¶ä¸”æ­¤ä¸­é—´ä»¶ä¼šåœ¨ç”¨æˆ·å‘èµ·ä»»ä½•è¯·æ±‚éƒ½å¯èƒ½ä¼šæ‰§è¡Œï¼Œä¾‹å¦‚ï¼š 1app.use(someMiddleware) è·¯ç”±ä¸­é—´ä»¶é€šè¿‡åœ¨è·¯ç”±å®šä¹‰æ—¶æ³¨å†Œä¸­é—´ä»¶ï¼Œæ­¤ä¸­é—´ä»¶åªä¼šåœ¨ç”¨æˆ·è®¿é—®è¯¥è·¯ç”±æ—¶æ‰§è¡Œï¼Œä¾‹å¦‚ï¼š 123app.get(&#x27;/middleware&#x27;, someMiddleware, (req, res) =&gt; &#123; res.send(&#x27;Hello World&#x27;);&#125;); ç¼–å†™ä¸€ä¸ªæ—¥å¿—ä¸­é—´ä»¶ æ–°å»ºä¸€ä¸ªlogger.jsï¼Œå¹¶å†™å…¥ä»¥ä¸‹å‡½æ•° 1234567function logger(req, res, next) &#123; const time = new Date(); console.log(`[$&#123;time.toLocaleString()&#125;] $&#123;req.method&#125; $&#123;req.url&#125;`); next();&#125;module.exports = logger; åœ¨server.jså¼•å…¥loggerå‡½æ•°å¹¶ä¸”å…¨å±€æ³¨å†Œ 123456const logger = require(&#x27;./logger&#x27;)......app.use(logger)...... è¿™æ ·æˆ‘ä»¬åœ¨è®¿é—®è·¯ç”±åï¼Œæ¯æ¬¡éƒ½ä¼šåœ¨æ§åˆ¶å°æ‰“å°ä¸€è¡Œæ—¥å¿—ï¼Œå¦‚ä¸‹ï¼š 12[2023/2/27 15:54:29] GET /[2023/2/27 15:54:47] POST /about æ³¨æ„ï¼šå¦‚æœå¿˜è®°åœ¨ä¸­é—´ä»¶ä¸­è°ƒç”¨ next å‡½æ•°ï¼Œå¹¶ä¸”åˆä¸ç›´æ¥è¿”å›å“åº”æ—¶ï¼ŒæœåŠ¡å™¨ä¼šç›´æ¥å¡åœ¨è¿™ä¸ªä¸­é—´ä»¶ä¸ä¼šç»§ç»­æ‰§è¡Œä¸‹å»å“¦ï¼ æ¨¡ç‰ˆå¼•æ“æ¨¡ç‰ˆå¼•æ“å¯ä»¥ç®€å•çš„ç†è§£ä¸ºå‡çº§ç‰ˆçš„htmlæ–‡æ¡£ï¼Œexpresså¯ä»¥ç”¨æ¨¡ç‰ˆå¼•æ“æ¥æ¸²æŸ“å‰ç«¯é¡µé¢ï¼Œæ¨¡ç‰ˆå¼•æ“æœ‰å¾ˆå¤šç§ï¼ŒåŒ…æ‹¬jade, ejs, nunjunks, Handlebarsç­‰ç­‰ï¼Œexpresså¯¹æ¯ä¸€ç§éƒ½æä¾›äº†å¾ˆå¥½çš„æ”¯æŒï¼Œåªéœ€è¦å‡ è¡Œä»£ç å°±å¯ä»¥ä½¿ç”¨ã€‚æˆ‘ä»¬ä»Šå¤©æ¥å­¦ä¹ ä¸‹Handlebarsã€‚ é¦–å…ˆï¼Œç¬¬ä¸€æ­¥æ˜¯å®‰è£…å¯¹åº”çš„æ¨¡ç‰ˆå¼•æ“ï¼š 1npm install hbs ç„¶ååˆ›å»ºviewsæ–‡ä»¶å¤¹ï¼Œå¹¶ä¸”æ–°å»ºä¸€ä¸ªindex.hbsçš„æ–‡ä»¶ï¼Œæ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š 123&lt;h1&gt;expresså…¥é—¨è¯¾ç¨‹&lt;/h1&gt;&lt;p&gt;ä½œä¸ºå‰ç«¯å¼€å‘ï¼ŒNodejså·²ç»æˆäº†å¾ˆå¤šå…¬å¸å¯¹æˆ‘ä»¬è¿™ä¸€å²—ä½çš„ç¡¬æ€§è¦æ±‚ï¼Œè€Œ Express æ¡†æ¶åˆ™æ˜¯å…¶ä¸­çŸ¥ååº¦æœ€é«˜ã€ä¹Ÿæ˜¯æœ€å—æ¬¢è¿çš„Nodejså¼€å‘æ¡†æ¶ã€‚ã€‚ã€‚&lt;/p&gt;&lt;a href=&quot;/about&quot;&gt;å…³äºæˆ‘ä»¬&lt;/a&gt; ç„¶åå†æ·»åŠ ä¸€ä¸ªabout.hbsçš„æ–‡ä»¶ï¼Œå¹¶æ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š 12&lt;h1&gt;é»‘é©¬å‰ç«¯&lt;/h1&gt;&lt;p&gt;å­¦å‰ç«¯ï¼Œæ¥é»‘é©¬&lt;/p&gt; æœ€åä¾¿æ˜¯åœ¨ server.js ä¸­é…ç½®å’Œä½¿ç”¨æ¨¡æ¿ã€‚é…ç½®æ¨¡æ¿çš„ä»£ç éå¸¸ç®€å•ï¼š 12345// æŒ‡å®šæ¨¡æ¿å­˜æ”¾ç›®å½•app.set(&#x27;views&#x27;, &#x27;views&#x27;);// æŒ‡å®šæ¨¡æ¿å¼•æ“ä¸º Handlebarsapp.set(&#x27;view engine&#x27;, &#x27;hbs&#x27;); åœ¨ä½¿ç”¨æ¨¡æ¿æ—¶ï¼Œåªéœ€åœ¨è·¯ç”±å›è°ƒå‡½æ•°ä¸­è°ƒç”¨ res.render æ–¹æ³•å³å¯ï¼š 1234567891011121314151617// ...const app = express();app.set(&#x27;views&#x27;, &#x27;views&#x27;);app.set(&#x27;view engine&#x27;, &#x27;hbs&#x27;);app.get(&#x27;/&#x27;, (req, res) =&gt; &#123; // æ¸²æŸ“index.hbsæ¨¡ç‰ˆ res.render(&#x27;index&#x27;);&#125;);app.get(&#x27;/about&#x27;, (req, res) =&gt; &#123; // æ¸²æŸ“about.hbsæ¨¡ç‰ˆ res.render(&#x27;about&#x27;);&#125;)// ... å½“æˆ‘ä»¬è®¿é—®localhost:3000æ—¶å°±ä¼šåŠ è½½å¯¹åº”çš„index.hbsè¿™ä¸ªæ¨¡ç‰ˆï¼Œå½“æˆ‘ä»¬è®¿é—®localhost:3000/aboutæ—¶å°±ä¼šåŠ è½½å¯¹åº”çš„about.hbsè¿™ä¸ªæ¨¡ç‰ˆ æˆ‘ä»¬è¿˜å¯ä»¥ç»™æ¨¡ç‰ˆå¼•æ“ä¸­ä¼ ä¸€äº›åŠ¨æ€å‚æ•°ï¼Œè¿™æ ·å°±ä¼šæ¸²æŸ“å‡ºæ¥ä¸åŒçš„å†…å®¹ï¼Œå°†about.hbsæ”¹æˆå¦‚ä¸‹å†…å®¹ï¼š 1234&lt;h1&gt;é»‘é©¬å‰ç«¯&lt;/h1&gt;&lt;p&gt;å­¦å‰ç«¯ï¼Œæ¥é»‘é©¬&lt;/p&gt;&lt;p&gt;è®²å¸ˆï¼š&#123;&#123; name &#125;&#125;&lt;/p&gt;&lt;p&gt;å¹´é¾„ï¼š&#123;&#123; age &#125;&#125;&lt;/p&gt; ç„¶ååœ¨æ¸²æŸ“è¯¥æ¨¡ç‰ˆæ—¶åŠ ä¸Šç¬¬äºŒä¸ªå‚æ•°: 1234app.get(&#x27;/about&#x27;, (req, res) =&gt; &#123; // æ¸²æŸ“about.hbsæ¨¡ç‰ˆ res.render(&#x27;about&#x27;, &#123; name: &#x27;jackie&#x27;, age: 18 &#125;);&#125;) è¿™æ ·å½“æ¸²æŸ“å‡ºæ¥çš„æ—¶å€™å°±ä¼šæ ¹æ®æˆ‘ä»¬ä¼ è¿›å»çš„å‚æ•°åŠ¨æ€æ¸²æŸ“å‰ç«¯é¡µé¢äº† é™æ€æ–‡ä»¶æœåŠ¡å®¢æˆ·ç«¯ä¸€èˆ¬éœ€è¦è®¿é—®ä¸€äº›å›¾ç‰‡è§†é¢‘ç­‰é™æ€èµ„æºæ–‡ä»¶ï¼Œé‚£ä¹ˆè¿™äº›æ–‡ä»¶å¦‚ä½•å‘é€ç»™å®¢æˆ·ç«¯å‘¢ï¼Œå°±éœ€è¦ç”¨åˆ°é™æ€æ–‡ä»¶æœåŠ¡äº†ï¼Œè€Œ Express å·²ç»è‡ªå¸¦äº†é™æ€æ–‡ä»¶æœåŠ¡ä¸­é—´ä»¶ express.staticï¼Œä½¿ç”¨èµ·æ¥éå¸¸æ–¹ä¾¿ã€‚ å‡è®¾æˆ‘ä»¬çš„é™æ€èµ„æºåœ¨publicä¸‹é¢ï¼š 12345publicâ”œâ”€â”€ cssâ”‚ â””â”€â”€ style.cssâ””â”€â”€ img â””â”€â”€ logo.png ç„¶åæˆ‘ä»¬åªéœ€è¦åœ¨server.jsä¸­æ·»åŠ ä¸€è¡Œä»£ç ï¼š 1app.use(express.static(&#x27;public&#x27;)); ç„¶åæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ä¸‹é¢çš„è·¯å¾„è®¿é—®åˆ°è¿™äº›èµ„æºäº†ï¼š 12http://localhost:3000/css/style.csshttp://localhost:3000/img/logo.png åœ¨æ¨¡æ¿å¼•æ“ä¸­æ”¾å…¥è¿™äº›èµ„æºçš„å¼•å…¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ¨¡æ¿ä¸­ä½¿ç”¨äº†ï¼š 12345&lt;link rel=&quot;stylesheet&quot; href=&quot;/css/style.css&quot; /&gt;&lt;h1&gt;expresså…¥é—¨è¯¾ç¨‹&lt;/h1&gt;&lt;p&gt;ä½œä¸ºå‰ç«¯å¼€å‘ï¼ŒNodejså·²ç»æˆäº†å¾ˆå¤šå…¬å¸å¯¹æˆ‘ä»¬è¿™ä¸€å²—ä½çš„ç¡¬æ€§è¦æ±‚ï¼Œè€Œ Express æ¡†æ¶åˆ™æ˜¯å…¶ä¸­çŸ¥ååº¦æœ€é«˜ã€ä¹Ÿæ˜¯æœ€å—æ¬¢è¿çš„Nodejså¼€å‘æ¡†æ¶ã€‚ã€‚ã€‚&lt;/p&gt;&lt;a href=&quot;/about&quot;&gt;å…³äºæˆ‘ä»¬&lt;/a&gt; å†æ¬¡è¿è¡ŒæœåŠ¡å™¨ï¼Œå¹¶è®¿é—®æˆ‘ä»¬çš„ç½‘ç«™æ—¶ï¼Œå°±å‘ç°æ ·å¼åŠ åˆ°äº†æˆ‘ä»¬çš„å‰ç«¯é¡µé¢ä¸Šäº†ã€‚ å¤„ç†404å’ŒæœåŠ¡å™¨é”™è¯¯æˆ‘ä»¬åœ¨è®¿é—®ä¸€äº›è·¯ç”±æ—¶æœ‰å¯èƒ½è¿™ä¸ªè·¯ç”±æ²¡æœ‰å®šä¹‰ï¼Œè¿™ä¸ªæ—¶å€™å°±ä¼šè¿”å›404çš„çŠ¶æ€ç ï¼Œæˆ–è€…æœ‰æ—¶å€™æœåŠ¡å™¨å†…éƒ¨ä»£ç å‡ºé”™äº†ï¼Œå°±ä¼šè¿”å›500çš„é”™è¯¯ç ï¼Œè¿™äº›æƒ…å†µæ˜¯åœ¨å¼€å‘ä¸­ç»å¸¸ç¢°åˆ°çš„ï¼Œé‚£ä¹ˆæœåŠ¡ç«¯åº”è¯¥å¦‚ä½•å¤„ç†è¿™äº›å¼‚å¸¸çš„æƒ…å†µå‘¢ï¼Ÿ å¯¹äº 404ï¼Œåªéœ€åœ¨æ‰€æœ‰è·¯ç”±ä¹‹åå†åŠ ä¸€ä¸ªä¸­é—´ä»¶ï¼Œç”¨æ¥æ¥æ”¶æ‰€æœ‰è·¯ç”±å‡åŒ¹é…å¤±è´¥çš„è¯·æ±‚ å¯¹äºé”™è¯¯å¤„ç†ï¼Œå‰é¢æ‰€æœ‰ä¸­é—´ä»¶æŠ›å‡ºå¼‚å¸¸æ—¶éƒ½ä¼šè¿›å…¥é”™è¯¯å¤„ç†å‡½æ•°ï¼Œå¯ä»¥ä½¿ç”¨ Express è‡ªå¸¦çš„ï¼Œä¹Ÿå¯ä»¥è‡ªå®šä¹‰ã€‚ å¤„ç†404åªéœ€åœ¨server.jsä¸­æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š 123app.use(&#x27;*&#x27;, (req, res) =&gt; &#123; res.status(404).render(&#x27;404&#x27;, &#123; url: req.originalUrl &#125;);&#125;); ç„¶ååœ¨viewsä¸‹é¢æ–°å»ºä¸€ä¸ª404.hbsçš„æ¨¡ç‰ˆæ–‡ä»¶ï¼š 12&lt;h1&gt;æ‰¾ä¸åˆ°ä½ è¦çš„é¡µé¢äº†ï¼&lt;/h1&gt;&lt;p&gt;ä½ æ‰€è®¿é—®çš„è·¯å¾„ &#123;&#123; url &#125;&#125; ä¸å­˜åœ¨&lt;/p&gt; * è¡¨ç¤ºåŒ¹é…ä»»ä½•è·¯å¾„ã€‚å°†æ­¤ä¸­é—´ä»¶æ”¾åœ¨æ‰€æœ‰è·¯ç”±åé¢ï¼Œå³å¯æ•è·æ‰€æœ‰è®¿é—®è·¯å¾„å‡åŒ¹é…å¤±è´¥çš„è¯·æ±‚ï¼Œç„¶åæ¸²æŸ“404çš„é‚£ä¸ªæ¨¡ç‰ˆå¼•æ“å°±å¯ä»¥äº†ã€‚ æ³¨æ„ï¼šä¸€å®šæ˜¯æ”¾åœ¨æ‰€æœ‰è·¯ç”±çš„åé¢ï¼Œåªæœ‰å‰é¢çš„è·¯ç”±éƒ½åŒ¹é…ä¸ä¸Šæ‰ä¼šåŒ¹é…åˆ°*çš„è¿™ä¸ªè·¯ç”± å¤„ç†å†…éƒ¨é”™è¯¯åœ¨server.jsä¸­æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š 123app.use((err, req, res, next) =&gt; &#123; res.status(500).render(&#x27;500&#x27;);&#125;); ç„¶ååœ¨viewsä¸‹é¢æ–°å»ºä¸€ä¸ª500.hbsçš„æ¨¡ç‰ˆæ–‡ä»¶ï¼š 12&lt;h1&gt;æœåŠ¡å™¨å¥½åƒå¼€å°å·®äº†&lt;/h1&gt;&lt;p&gt;è¿‡ä¸€ä¼šå„¿å†è¯•è¯•çœ‹å§ï¼See your later~&lt;/p&gt; æ³¨æ„ï¼šåœ¨server.jsä¸­æ·»åŠ çš„ä»£ç ä¹Ÿå¿…é¡»è¦æ·»åŠ åˆ°æ‰€æœ‰è·¯ç”±çš„åé¢ï¼Œä¸ç„¶ä¸èƒ½å¤„ç†å…¨éƒ¨çš„é”™è¯¯ æˆ‘ä»¬åœ¨æŸä¸ªè·¯ç”±ä¸­æ‰‹åŠ¨æŠ›å‡ºä¸€ä¸ªé”™è¯¯åï¼Œå®¢æˆ·ç«¯å°±ä¼šæ¸²æŸ“500.hbsè¿™ä¸ªæ¨¡ç‰ˆæ–‡ä»¶ã€‚ æ€»ç»“è‡³æ­¤expressåŸºç¡€å†…å®¹å°±è®²è§£å®Œäº†ï¼Œè¿™äº›éƒ½æ˜¯expressçš„æ ¸å¿ƒçŸ¥è¯†ç‚¹ï¼Œåç»­è¿˜ä¼šæœ‰expressçš„è¿›é˜¶è¯¾ç¨‹ï¼Œåˆ°æ—¶å€™ä¼šæ¶‰åŠåˆ°ç”¨expressæ“ä½œæ•°æ®åº“å’Œå®æˆ˜çš„å†…å®¹ï¼Œæ„Ÿå…´è¶£çš„è¯å¯ä»¥å…³æ³¨æˆ‘ä»¬çš„bç«™åŠ¨æ€ï¼ŒåŠæ—¶è·Ÿè¿›è¯¾ç¨‹ã€‚","categories":[],"tags":[]},{"title":"å¯’å‡å­¦ä¹ ","slug":"å¯’å‡å­¦ä¹ ","date":"2024-01-12T07:32:34.988Z","updated":"2024-10-07T15:47:20.839Z","comments":true,"path":"2024/01/12/å¯’å‡å­¦ä¹ /","permalink":"http://eastyn7.github.io/2024/01/12/%E5%AF%92%E5%81%87%E5%AD%A6%E4%B9%A0/","excerpt":"","text":"ç¬¬ä¸€å‘¨Vue2ä¼ å‚ æŸ¥è¯¢å‚æ•°ä¼ å‚ï¼ˆæ›´é€‚åˆå¤šä¸ªå‚æ•°ï¼‰ï¼š?å‚æ•°&#x3D;å‚æ•°å€¼ &#x3D;&gt; this.$route.query.å‚æ•°å åŠ¨æ€è·¯ç”±ä¼ å‚ï¼ˆæ›´é€‚åˆå•ä¸ªå‚æ•°ï¼‰ï¼š&#x2F;è·¯å¾„&#x2F;å‚æ•° &#x3D;&gt; this.$route.params.å‚æ•°å ç»„ä»¶ç¼“å­˜keep-aliveå°†ç¼“å­˜æ‰€æœ‰åˆ‡æ¢çš„ç»„ä»¶ ä¸‰ä¸ªå±æ€§ï¼šincludeâ€”â€”ç»„ä»¶åæ•°ç»„ï¼Œåªæœ‰åŒ¹é…çš„ç»„ä»¶ä¼šè¢«ç¼“å­˜ â€‹ excludeâ€”â€”ç»„ä»¶åæ•°ç»„ï¼Œä»»ä½•åŒ¹é…çš„ç»„ä»¶éƒ½ä¸ä¼šè¢«ç¼“å­˜ â€‹ maxâ€”â€”æœ€å¤šå¯ä»¥ç¼“å­˜å¤šå°‘ç»„ä»¶å®ä¾‹ 1234567&lt;template&gt; &lt;div&gt; &lt;keep-alive :include=&quot;[&#x27;LayoutPage&#x27;]&quot;&gt; &lt;router-view&gt;&lt;/router-view&gt; &lt;/keep-alive&gt; &lt;/div&gt;&lt;/template&gt; ç»„ä»¶ç¼“å­˜äº†ä¹‹åå°±ä¸ä¼šå†æ‰§è¡Œcreatedã€mountedã€destroyedç­‰é’©å­ æä¾›äº†ä¸¤ä¸ªå£°æ˜å‘¨æœŸå‡½æ•°ï¼šactivated(){} deactivated(){} åˆ©ç”¨VueXåˆ›å»ºä»“åº“ åˆ©ç”¨mutationsä¿®æ”¹æ•°æ®ï¼Œthis.$store.comit(â€˜æ–¹æ³•åâ€™) mapStateæ˜ å°„åˆ°è®¡ç®—å±æ€§ mapMutationsæ˜ å°„åˆ°æ–¹æ³• mapActonsæ˜ å°„åˆ°æ–¹æ³• mapGettersæ˜ å°„åˆ°è®¡ç®—å±æ€§ actionså¤„ç†å¼‚æ­¥ï¼ŒsetTimeoutæ¨¡æ‹Ÿå‘è¯·æ±‚ 123456789actions:&#123; setAsynCount(context,num)&#123; setTimeout(()=&gt;&#123; context.comit(&#x27;changeCount&#x27;,num) &#125;,1000) &#125;&#125;this.$store.dispatch(&#x27;setAsyncCount&#x27;,200) modulesæ¨¡å—æ‹†åˆ†å­ä»“ï¼Œä¾¿äºç»´æŠ¤ åœ¨å­æ¨¡å—ä¸­å†™namespaced: trueå¯ä»¥ç›´æ¥åˆ©ç”¨mapStateæ˜ å°„å…¶ä¸­çš„å†…å®¹ $store.getters[â€˜æ¨¡å—å&#x2F;xxxâ€™] è¯·æ±‚æ‹¦æˆªå™¨12345678910111213141516171819202122232425262728293031323334353637/* å°è£…axiosç”¨äºå‘é€è¯·æ±‚ */import axios from &#x27;axios&#x27;import &#123; Toast &#125; from &#x27;vant&#x27;// åˆ›å»ºä¸€ä¸ªæ–°çš„axioså®ä¾‹const request = axios.create(&#123; baseURL: &#x27;http://cba.itlike.com/public/index.php?s=/api/&#x27;, timeout: 5000&#125;)// æ·»åŠ è¯·æ±‚æ‹¦æˆªå™¨request.interceptors.request.use(function (config) &#123; // åœ¨å‘é€è¯·æ±‚ä¹‹å‰åšäº›ä»€ä¹ˆ return config&#125;, function (error) &#123; // å¯¹è¯·æ±‚é”™è¯¯åšäº›ä»€ä¹ˆ return Promise.reject(error)&#125;)// æ·»åŠ å“åº”æ‹¦æˆªå™¨request.interceptors.response.use(function (response) &#123; // å¯¹å“åº”æ•°æ®åšç‚¹ä»€ä¹ˆ const res = response.data console.log(res) if (res.status !== 200) &#123; // ç»™æç¤º Toast(res.message) // æŠ›é”™è¯¯promise return Promise.reject(res.message) &#125; return res&#125;, function (error) &#123; // å¯¹å“åº”é”™è¯¯åšç‚¹ä»€ä¹ˆ return Promise.reject(error)&#125;)export default request storageå­˜å‚¨æ¨¡å—é˜²æ­¢vuexåˆ·æ–°ä¸¢å¤±ï¼ŒåŒæ—¶é¿å…æ¯æ¬¡å­˜å–æ“ä½œå¤ªé•¿å¤ªéº»çƒ¦çš„é—®é¢˜ 12345678910111213141516171819// çº¦å®šä¸€ä¸ªé€šç”¨çš„é”®åconst INFO_KEY = &#x27;hm_shopping_info&#x27;// è·å–ä¸ªäººä¿¡æ¯export const getInfo = () =&gt; &#123; const defaultObj = &#123; token: &#x27;&#x27;, userId: &#x27;&#x27; &#125; const result = localStorage.getItem(INFO_KEY) return result ? JSON.parse(result) : defaultObj&#125;// è®¾ç½®ä¸ªäººä¿¡æ¯export const setInfo = (obj) =&gt; &#123; localStorage.setItem(INFO_KEY, JSON.stringify(obj))&#125;// ç§»é™¤ä¸ªäººä¿¡æ¯export const removeInfo = () =&gt; &#123; localStorage.removeItem(INFO_KEY)&#125; ç™»å½•èŠ‚æµæ“ä½œ1234567// å¼€å¯loadingï¼Œç¦æ­¢èƒŒæ™¯ç‚¹å‡»ï¼ˆèŠ‚æµå¤„ç†ï¼Œé˜²æ­¢å¤šæ¬¡æ— æ•ˆè§¦å‘ï¼‰Toast.loading(&#123; message: &#x27;åŠ è½½ä¸­...&#x27;, forbidClick: true, // ç¦æ­¢èƒŒæ™¯ç‚¹å‡» loadingType: &#x27;spinner&#x27;, // é…ç½®å›¾æ ‡ duration: 0 // ä¸ä¼šè‡ªåŠ¨æ¶ˆå¤±ï¼Œå“åº”æ‹¦æˆªå™¨å›æ¥ä¹‹åå…³é—­&#125;) 123456789if (res.status !== 200) &#123; // ç»™æç¤º Toast(res.message) // æŠ›é”™è¯¯promise return Promise.reject(res.message)&#125; else &#123; // æ­£ç¡®æ¸…é™¤loadingæ•ˆæœ Toast.clear()&#125; é¡µé¢è®¿é—®æ‹¦æˆªè®¾ç½®å…¨å±€å‰ç½®è·¯ç”± 123router.beforeEach(to,from,next)=&gt;&#123; // to å¾€å“ªé‡Œå»;from ä»å“ªé‡Œæ¥;next()æ˜¯å¦æ”¾è¡Œ,å¦‚æœnext()è°ƒç”¨åˆ™æ”¾è¡Œ,next(è·¯å¾„)æ‹¦æˆªåˆ°æŸä¸ªè·¯å¾„é¡µé¢&#125; æœ¬å‘¨æ€»ç»“ä¸€ç›´åœ¨è·Ÿç€ç”¨vue2å®ç°å®Œæ•´çš„å•†åŸé¡¹ç›®ï¼Œå¦å¤–ç©ºä½™æ—¶é—´é€æ­¥åœ¨è¿‡æ¸¡vue3çš„åŸºç¡€çŸ¥è¯†ï¼Œæœ€è¿‘å‡ å¤©åœ¨æä¸‰åˆ›èµ›éœ€è¦ç”¨åˆ°çš„ç½‘é¡µè®¾è®¡ ç¬¬äºŒå‘¨Vue31åˆ›å»ºï¼šnpm init vue@latest setupå…è®¸åœ¨scriptä¸­ç›´æ¥ç¼–å†™ç»„åˆæ˜¯APIï¼Œsetup()é’©å­æ‰§è¡Œæ—¶æœŸæ—©äºbeforeCreate()é’©å­ï¼Œå¹¶ä¸”ä¸å†èƒ½ä½¿ç”¨thisï¼Œæ•°æ®å’Œå‡½æ•°éœ€è¦å†setupæœ€åreturnï¼Œè¯­æ³•ç³–å†™æ³•çœç•¥äº†return templateä¸å†è¦æ±‚å”¯ä¸€æ ¹å…ƒç´  reactive()å’Œref()reactive()ä½œç”¨ï¼šæ¥å—å¯¹è±¡ç±»å‹æ•°æ®çš„å‚æ•°ä¼ å…¥å¹¶è¿”å›ä¸€ä¸ªå“åº”å¼çš„å¯¹è±¡ 12345678910111213141516&lt;script setup&gt;import &#123; reactive &#125; from &#x27;vue&#x27;const state = reactive(&#123; count:100&#125;)const setCount = () =&gt; &#123; state.count++&#125;&lt;/script&gt;&lt;template&gt; &lt;div&gt; &lt;div&gt;&#123;&#123; state.count &#125;&#125;&lt;/div&gt; &lt;button @click=&quot;setCount&quot;&gt;+1&lt;/button&gt; &lt;/div&gt;&lt;/template&gt; ref()ä½œç”¨ï¼šæ¥æ”¶ç®€å•ç±»å‹æˆ–å¯¹è±¡ç±»å‹çš„æ•°æ®ä¼ å…¥å¹¶è¿”å›ä¸€ä¸ªå“åº”å¼çš„å¯¹è±¡ â€‹ æœ¬è´¨ï¼šæ˜¯åœ¨åŸæœ‰ä¼ å…¥æ•°æ®çš„åŸºç¡€ä¸Šï¼Œå¤–å±‚åŒ…äº†ä¸€å±‚å¯¹è±¡ â€‹ åœ¨è„šæœ¬ä¸­è®¿é—®æ•°æ®éœ€è¦é€šè¿‡.valueï¼Œåœ¨templateä¸­ä¸éœ€è¦åŠ .value 1234567891011121314&lt;script setup&gt;import &#123; ref &#125; from &#x27;vue&#x27;const count = ref(0)const setCount = () =&gt; &#123; count.value++&#125;&lt;/script&gt;&lt;template&gt; &lt;div&gt; &lt;div&gt;&#123;&#123; state.count &#125;&#125;&lt;/div&gt; &lt;button @click=&quot;setCount&quot;&gt;+1&lt;/button&gt; &lt;/div&gt;&lt;/template&gt; ç»„åˆå¼API-computed123456789101112131415&lt;script setup&gt;import &#123; ref,computed &#125; from &#x27;vue&#x27;const list = ref([1,2,3,4,5,6,7,8])const computedList = computed(()=&#123; return list.value.filter(item =&gt; item &gt; 2)&#125;)&lt;/script&gt;&lt;template&gt; &lt;div&gt; &lt;div&gt;åŸå§‹æ•°æ®ï¼š&#123;&#123; list &#125;&#125;&lt;/div&gt; &lt;div&gt;è®¡ç®—åæ•°æ®:&#123;&#123; computedList &#125;&#125;&lt;/div&gt; &lt;/div&gt;&lt;/template&gt; ç»„åˆå¼API-watchä½œç”¨ï¼šä¾¦å¬ä¸€ä¸ªæˆ–å¤šä¸ªæ•°æ®çš„å˜åŒ–ï¼Œæ•°æ®å˜åŒ–æ—¶æ‰§è¡Œå›è°ƒå‡½æ•° ä¸¤ä¸ªé¢å¤–å‚æ•°ï¼šimmediateï¼ˆç«‹å³æ‰§è¡Œï¼‰ï¼›deepï¼ˆæ·±åº¦ç›‘å¬ï¼‰ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970&lt;script setup&gt;import &#123; ref,watch &#125; from &#x27;vue&#x27;const count = ref(0)const nickname = ref(&#x27;å¼ ä¸‰&#x27;)const changeCount = ()=&gt;&#123; count.value++&#125;const cangeNickname = ()=&gt;&#123; nickname.value = &#x27;æå››&#x27;&#125;// ç›‘è§†å•ä¸ªwatch(count,(newValue,oldValue)=&gt;&#123; console.log(newValue,oldValue)&#125;) // ç›‘è§†å¤šä¸ªwatch([count,nickname],(newValue,oldValue)=&gt;&#123; console.log(newValue,oldValue)&#125;) // ç«‹å³æ‰§è¡Œwatch(count,(newValue,oldValue)=&gt;&#123; console.log(newValue,oldValue)&#125;,&#123; immediate:true&#125;) // æ·±åº¦ç›‘è§†[ref(ç®€å•ç±»å‹)å¯ä»¥ç›‘å¬,ref(å¤æ‚ç±»å‹)å¿…é¡»æ·±åº¦ç›‘å¬]const userInfo = ref(&#123; name:&#x27;zs&#x27;, age:18&#125;)const setUserInfo = ()=&gt;&#123; userInfo.value.age++&#125;watch(userInfo,(newValue,oldValue)=&gt;&#123; console.log(newValue,oldValue)&#125;,&#123; deep:true&#125;) // å¯¹äºå¯¹è±¡ä¸­çš„å±æ€§è¿›è¡Œç›‘è§†const userInfo = ref(&#123; name:&#x27;zs&#x27;, age:18&#125;)const setUserInfo = ()=&gt;&#123; userInfo.value.age++&#125;watch(() =&gt; userInfo.value.age,(newValue,oldValue) =&gt; &#123; console.log(newValue,oldValue)&#125;)&lt;/script&gt;&lt;template&gt; &lt;div&gt; &#123;&#123; count &#125;&#125; &lt;/div&gt; &lt;button @click=&quot;changeCount&quot;&gt; æ”¹æ•°å­— &lt;/button&gt; &lt;div&gt; &#123;&#123; nickname &#125;&#125; &lt;/div&gt; &lt;button @click=&quot;changeNickname&quot;&gt; æ”¹æ˜µç§° &lt;/button&gt;&lt;/template&gt; ç»„åˆå¼API-ç”Ÿå‘½å‘¨æœŸå‡½æ•° é€‰é¡¹å¼API ç»„åˆå¼API beforeCreate&#x2F;created setup beforeMount onBeforeMount mounted onMounted beforeUpdate onBreforeUpdate updated onUpdated beforeUnmount onBeforeUnmount unmounted onUnmounted ç»„åˆå¼API-çˆ¶å­é€šä¿¡çˆ¶ä¼ å­ï¼šçˆ¶ç»„ä»¶ç»™å­ç»„ä»¶ç»‘å®šå±æ€§ï¼Œå­ç»„ä»¶å†…éƒ¨é€šè¿‡propsé€‰é¡¹æ¥æ”¶ï¼Œé€šè¿‡definePropsâ€œç¼–è¯‘å™¨å®â€æ¥æ”¶å­ç»„ä»¶ä¼ é€’çš„æ•°æ® å­ä¼ çˆ¶ï¼šçˆ¶ç»„ä»¶ä¸­ç»„ä»¶æ ‡ç­¾é€šè¿‡@ç»‘å®šäº‹ä»¶ï¼Œå­ç»„ä»¶å†…éƒ¨é€šè¿‡emitæ–¹æ³•è§¦å‘äº‹ä»¶ï¼Œé€šè¿‡defineEmitsç¼–è¯‘å™¨å®ç”Ÿæˆemitæ–¹æ³• ç»„åˆå¼API-æ¨¡æ¿å¼•ç”¨è°ƒç”¨refå‡½æ•°ç”Ÿæˆä¸€ä¸ªrefå¯¹è±¡ï¼Œé€šè¿‡refæ ‡è¯†ç»‘å®šrefå¯¹è±¡åˆ°æ ‡ç­¾ 1234567891011121314151617181920212223242526&lt;scipt setup&gt; import TestCom from &quot;@/components/........&quot; import &#123; ref, onMounted &#125; from &#x27;vue&#x27; const inp = ref(null) // ç”Ÿå‘½é’©å­onMountedç­‰domæ¸²æŸ“å®Œ onMounted(()=&gt;&#123; // console.log(inp.value) // inp.value.focus() &#125;) const clickFn = ()=&gt;&#123; inp.value.focus() &#125;&lt;/scipt&gt;&lt;template&gt; &lt;div&gt; &lt;input ref=&quot;inp&quot; type=&quot;text&quot;&gt; &lt;button @click=&quot;clickFn&quot;&gt; ç‚¹å‡»è®©è¾“å…¥æ¡†èšç„¦ &lt;/button&gt; &lt;/div&gt; &lt;TestCom/&gt;&lt;/template&gt; é»˜è®¤æƒ…å†µä¸‹åœ¨è¯­æ³•ç³–ä¸‹ç»„ä»¶å†…éƒ¨çš„å±æ€§å’Œæ–¹æ³•æ˜¯ä¸å¼€æ”¾ç»™çˆ¶ç»„ä»¶è®¿é—®çš„,å¯ä»¥é€šè¿‡defineExposeç¼–è¯‘å®æŒ‡å®šå“ªäº›å±æ€§å’Œæ–¹æ³•å…è®¸è®¿é—® 1234567&lt;script setup&gt; import &#123; ref &#125; from &#x27;vue&#x27; const testMessage = ref(&#x27;this is test message&#x27;) defineExpose(&#123; testMessage &#125;)&lt;/script&gt; ç»„åˆå¼API-provideå’Œinjecté¡¶å±‚ç»„ä»¶å‘ä»»æ„çš„åº•å±‚ç»„ä»¶ä¼ é€’æ•°æ®å’Œæ–¹æ³•ï¼Œå®ç°è·¨å±‚ç»„ä»¶é€šä¿¡ æ™®é€šæ•°æ® 12// é¡¶å±‚ç»„ä»¶provide(&#x27;key&#x27;,é¡¶å±‚ç»„ä»¶ä¸­çš„æ•°æ®) 12// åº•å±‚ç»„ä»¶const message = inject(&#x27;key&#x27;) å“åº”å¼æ•°æ® 12// é¡¶å±‚ç»„ä»¶provide(&#x27;app-key&#x27;,refå¯¹è±¡) 12// åº•å±‚ç»„ä»¶const message = inject(&#x27;app-key&#x27;) æ–¹æ³• 12345// é¡¶å±‚ç»„ä»¶const setCount = () =&gt; &#123; count,value++&#125;provide(&#x27;setCount-key&#x27;,setCount) 12// åº•å±‚ç»„ä»¶const setCount = inject(&#x27;setCount-key&#x27;) defineOptionsç”¨defineOptionså®šä¹‰ä»»æ„çš„é€‰é¡¹ï¼Œpropsã€emitsã€exposeã€slotsé™¤å¤– 1234567&lt;script setup&gt; defineOptions(&#123; name:&#x27;&#x27;, inheritAttrs:false, ......... &#125;)&lt;/script&gt; PiniaVuexçš„æ›¿ä»£å“ æ‰‹åŠ¨æ·»åŠ pinia 123456789import &#123; createApp &#125; from &#x27;vue&#x27;import &#123; createPinia &#125; from &#x27;pinia&#x27;import App from &#x27;./App.vue&#x27;const pinia = createPinia()const app = createApp(App)app.use(pinia)app.use(&#x27;#app&#x27;) åŸºç¡€ä½¿ç”¨ï¼šå®šä¹‰storeï¼Œç»„ä»¶ä½¿ç”¨store 12345678910111213141516171819202122import &#123; defineStore &#125; from &#x27;pinia&#x27;import &#123; ref,computed &#125; from &#x27;vue&#x27;// å®šä¹‰store// defineStore(ä»“åº“çš„å”¯ä¸€æ ‡è¯†),() =&gt; &#123;....&#125;)export const useCOunterStore = defineStore(&#x27;counter&#x27;,() =&gt; &#123; // å£°æ˜æ•°æ® state const count = ref(0) // å£°æ˜æ“ä½œæ•°æ®çš„æ–¹æ³• actions ï¼ˆæ™®é€šå‡½æ•°ï¼‰ const addCount = () =&gt; count.value++ // å£°æ˜åŸºäºæ•°æ®æ´¾ç”Ÿçš„è®¡ç®—å±æ€§ getters ï¼ˆcomputedï¼‰ const double = computed(() =&gt; count.value * 2) return &#123; count, double, addCount &#125;&#125;) 1234567891011&lt;script setup&gt; import &#123; useCounterStore &#125; from &#x27;@/store/....&#x27; const counterStore = useCounterStore()&lt;/script&gt;&lt;template&gt; &lt;div&gt; æˆ‘æ˜¯Son1.vue - &#123;&#123; counterStore.count &#125;&#125; - &#123;&#123; counterStore.double &#125;&#125; &lt;button @click=&quot;counterStore.addCount&quot;&gt;+&lt;/button&gt; &lt;/div&gt;&lt;/template&gt; stpreTpRefs - å¯ä»¥ä½¿piniaäº§ç”Ÿçš„storeè§£æ„èµ‹å€¼æ•°æ®ä¿æŒå“åº”å¼ PiniaæŒä¹…åŒ–â€”â€”ç™½é›ªlocalStorage ä¸‹è½½ä¾èµ–ï¼Œå¯¼å…¥ï¼Œä½¿ç”¨ import persist from &#39;pinia-plugun-persistedstate&#39; - å¯¼å…¥æŒä¹…åŒ–æ’ä»¶ app.use(pinia.use(persist)) - pianiaæ’ä»¶çš„å®‰è£…é…ç½® persist:true - åœ¨ç»„åˆå¼çš„ç¬¬ä¸‰ä¸ªå‚æ•°ä¸­æ·»åŠ å¼€å¯å½“å‰æ¨¡å—çš„æŒä¹…åŒ–ï¼ˆé»˜è®¤æ˜¯æ•´ä¸ªstateè¢«æŒä¹…åŒ–åˆ°localStorageï¼‰ pnpm ç¬¬ä¸‰å‘¨el-row/el-col/el-formel-row ä¸€è¡Œåˆ†ä¸º24ä»½ el-col :span=&quot;12&quot; è¯¥åˆ—å 12ä»½ el-col :offset:&quot;3&quot; å·¦å¤–è¾¹è·3ä»½ el-form è¡¨å• el-form-item è¡¨å•ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´  è¡¨å•æ ¡éªŒè§„åˆ™ éç©ºæ ¡éªŒâ€”â€”required:true messageæ¶ˆæ¯æç¤º triggerè§¦å‘æ ¡éªŒçš„æ—¶æœº blur(å¤±ç„¦æ—¶)\\change(æ”¹å˜æ—¶) é•¿åº¦æ ¡éªŒâ€”â€”min:xx max:xx æ­£åˆ™æ ¡éªŒâ€”â€”pattern:æ­£åˆ™è§„åˆ™(ä¾‹å¦‚: \\^\\S{6,15}$\\ è¡¨ç¤º6-25ä½çš„éç©ºå­—ç¬¦) è‡ªå®šä¹‰æ ¡éªŒâ€”â€”validator:(rule,value,callback) rule å½“å‰æ ¡éªŒè§„åˆ™ç›¸å…³çš„ä¿¡æ¯ value æ‰€æ ¡éªŒçš„è¡¨å•å…ƒç´ ç›®å‰çš„è¡¨å•å€¼ callback æ— è®ºæˆåŠŸè¿˜æ˜¯å¤±è´¥éƒ½éœ€è¦callback callback() æ ¡éªŒæˆåŠŸ callback(new Errir(é”™è¯¯ä¿¡æ¯)) æ ¡éªŒå¤±è´¥ ç¬¬å››å‘¨nodeçš„httpæ¨¡å—æ­å»ºçš„åç«¯æœåŠ¡1234567891011const http = require(&#x27;http&#x27;)const server = http.createServer(function(req,res)&#123; res.statusCode = 200 res.setHeader(&#x27;Content-Type&#x27;,&#x27;Content-Type&#x27;,&#x27;text/html&#x27;) res.send(&#x27;...&#x27;)&#125;)server.listen(3000,functon()&#123; console.log(&#x27;æœåŠ¡å·²å¯åŠ¨&#x27;) &#125;) è¿è¡Œï¼šnode server.js expressæ­å»ºåç«¯æœåŠ¡å®‰è£…ï¼šnpm install express 123456789101112const express = require(&#x27;express&#x27;)const app = express()app.get(&#x27;/&#x27;,function(req,res)&#123; // ç›¸åº”å†…å®¹ res.send(&#x27;...&#x27;)&#125;)app.listen(3000,functon()&#123; console.log(&#x27;æœåŠ¡å·²å¯åŠ¨&#x27;) &#125;) åœ¨ Express ä¸­ï¼Œä¸­é—´ä»¶å°±æ˜¯ä¸€ä¸ªå‡½æ•°ï¼š1234function someMiddleware(req, res, next) &#123; // è‡ªå®šä¹‰é€»è¾‘ next();&#125; ä¸‰ä¸ªå‚æ•°ä¸­ï¼Œreq å’Œ res å°±æ˜¯å‰é¢æåˆ°çš„ Request è¯·æ±‚å¯¹è±¡å’Œ Response å“åº”å¯¹è±¡ï¼›è€Œ next å‡½æ•°åˆ™ç”¨æ¥è§¦å‘ä¸‹ä¸€ä¸ªä¸­é—´ä»¶çš„æ‰§è¡Œã€‚ å…¨å±€ä¸­é—´ä»¶é€šè¿‡ app.use å‡½æ•°å°±å¯ä»¥æ³¨å†Œä¸­é—´ä»¶ï¼Œå¹¶ä¸”æ­¤ä¸­é—´ä»¶ä¼šåœ¨ç”¨æˆ·å‘èµ·ä»»ä½•è¯·æ±‚éƒ½å¯èƒ½ä¼šæ‰§è¡Œï¼Œä¾‹å¦‚ï¼š 1app.use(someMiddleware) è·¯ç”±ä¸­é—´ä»¶é€šè¿‡åœ¨è·¯ç”±å®šä¹‰æ—¶æ³¨å†Œä¸­é—´ä»¶ï¼Œæ­¤ä¸­é—´ä»¶åªä¼šåœ¨ç”¨æˆ·è®¿é—®è¯¥è·¯ç”±æ—¶æ‰§è¡Œï¼Œä¾‹å¦‚ï¼š 123app.get(&#x27;/middleware&#x27;, someMiddleware, (req, res) =&gt; &#123; res.send(&#x27;Hello World&#x27;);&#125;); ç¼–å†™ä¸€ä¸ªæ—¥å¿—ä¸­é—´ä»¶ æ–°å»ºä¸€ä¸ªlogger.jsï¼Œå¹¶å†™å…¥ä»¥ä¸‹å‡½æ•° 1234567function logger(req, res, next) &#123; const time = new Date(); console.log(`[$&#123;time.toLocaleString()&#125;] $&#123;req.method&#125; $&#123;req.url&#125;`); next();&#125;module.exports = logger; åœ¨server.jså¼•å…¥loggerå‡½æ•°å¹¶ä¸”å…¨å±€æ³¨å†Œ 123456const logger = require(&#x27;./logger&#x27;)......app.use(logger)...... è¿™æ ·æˆ‘ä»¬åœ¨è®¿é—®è·¯ç”±åï¼Œæ¯æ¬¡éƒ½ä¼šåœ¨æ§åˆ¶å°æ‰“å°ä¸€è¡Œæ—¥å¿—ï¼Œå¦‚ä¸‹ï¼š 12[2023/2/27 15:54:29] GET /[2023/2/27 15:54:47] POST /about æ³¨æ„ï¼šå¦‚æœå¿˜è®°åœ¨ä¸­é—´ä»¶ä¸­è°ƒç”¨ next å‡½æ•°ï¼Œå¹¶ä¸”åˆä¸ç›´æ¥è¿”å›å“åº”æ—¶ï¼ŒæœåŠ¡å™¨ä¼šç›´æ¥å¡åœ¨è¿™ä¸ªä¸­é—´ä»¶ä¸ä¼šç»§ç»­æ‰§è¡Œä¸‹å»å“¦ï¼","categories":[],"tags":[]}],"categories":[],"tags":[]}